var res={HelloWorld_png:"res/HelloWorld.png",loginui_loginpngpjson:"res/ui/LoginMenu.json",agreementjson:"res/ui/Agreement.json",halluijson:"res/ui/MainWindow.json",mailjson:"res/ui/Mail.json",createroomjson:"res/ui/CreateRoomWindow.json",exitroom:"res/ui/ExitRoom.json",msgbox:"res/ui/MessageBox.json",setting:"res/ui/SettingWindow.json",fightSetJson:"res/ui/fightSet.json",resultoneui:"res/ui/EndPlayWindow.json",jionroomui:"res/ui/JoinRoomWindow.json",resultui:"res/ui/EndWindow.json",buycardui:"res/ui/IOSPayWindow.json",userInfoPanelJson:"res/ui/useInfoPanel.json",assertui:"res/ui/AssetMgr.json",chatui:"res/ui/ChatMenu.json",RecordReplayList:"res/ui/RecordReplayList.json",RecordBureau:"res/ui/RecordBureau.json",recommendUi:"res/ui/tuijian.json",recordListCell:"res/ui/recordListCell.json",recordCell:"res/ui/recordCell.json",gameRuleJson:"res/ui/gameRulePanel.json",rechargeJson:"res/ui/rechargeWindow.json",rechargeHisJson:"res/ui/rechargeHistory.json",rechargeHisItemJson:"res/ui/rechargeHistoryItem.json",sourceScene:"res/ui/sourceScene.json",advertiseJson:"res/ui/advertiseLayer.json",couponLayer:"res/ui/CouponLayer.json",ddzhutable:"res/ui/DdzhuTable.json",ddzhuresultoneui:"res/ui/DdzEndPlayWindow.json",ddzhuresultui:"res/ui/DdzEndWindow.json",ddzRecordjson:"res/ui/DdzRecord.json",ddzLostBg:"res/ui/common/fight/shibai.png",btn_nongmin:"res/niuniuRes/btn_nongmin@2x.png",bombplist:"res/niuniuRes/anim/bomb.plist",bombpng:"res/niuniuRes/anim/bomb.png",feijiplist:"res/niuniuRes/anim/feiji.plist",feijipng:"res/niuniuRes/anim/feiji.png",shunzplist:"res/niuniuRes/anim/shunz.plist",shunzpng:"res/niuniuRes/anim/shunz.png",lianduilist:"res/niuniuRes/anim/liandui.plist",lianduipng:"res/niuniuRes/anim/liandui.png",wangzhaplist:"res/niuniuRes/anim/wang_zha.plist",wangzhappng:"res/niuniuRes/anim/wang_zha.png",spring0plist:"res/niuniuRes/anim/spring0.plist",spring0png:"res/niuniuRes/anim/spring0.png",alarmplist:"res/niuniuRes/anim/alarm.plist",alarmpng:"res/niuniuRes/anim/alarm.png",spr_double2:"res/niuniuRes/bei@2x.png",spr_double1:"res/niuniuRes/bei@1x.png",img_input:"res/niuniuRes/img_input@2x.png",img_laizi_bg:"res/niuniuRes/img_laiz2i@2x.png",rogue:"res/niuniuRes/roguetag.png",zhanji_bg:"res/niuniuRes/zhanji_bg3@2x.png",bureau_bg:"res/niuniuRes/bg5@2x.png",img_jiaobiao:"res/niuniuRes/img_jiaobiao@2x.png",ddzCall0:"res/niuniuRes/call0.png",ddzCall1:"res/niuniuRes/call1.png",ddzCall2:"res/niuniuRes/call2.png",ddzCall3:"res/niuniuRes/call3.png",btn_dizhu:"res/niuniuRes/btn_dizhu@2x.png",soundopen0:"res/ui/commonCells/commonPic/inRoomSamePic/yypk_img_horn1@2x@2x.png",soundopen1:"res/ui/commonCells/commonPic/inRoomSamePic/yypk_img_horn2@2x@2x.png",soundopen2:"res/ui/commonCells/commonPic/inRoomSamePic/yypk_img_horn3@2x@2x.png",pokerBei:"res/ui/niuniuPic/yypk_img_pokerBack2@2x.png",btn_zanting:"res/ui/commonCells/commonPic/recordPic/hf_btn_stop@2x.png",btn_bofang:"res/ui/commonCells/commonPic/recordPic/hf_btn_play@2x.png",voiceJson:"res/ui/commonCells/commonPic/inRoomSamePic/voice.json",voiceAtlas:"res/ui/commonCells/commonPic/inRoomSamePic/voice.atlas",voicePng:"res/ui/commonCells/commonPic/inRoomSamePic/voice.png",chatsl:"res/ui/ChatSaoLei.json",msexitroom:"res/ui/MineSweepingExit.json",minesweeping:"res/ui/SaoLeiTable.json",minesweepingbg:"res/ui/SaoLeiBg.json",minesweepingresult2:"res/ui/SaoLeiResult2.json",minesweepingresult:"res/ui/SaoLeiResult.json",minesweepingmsg:"res/ui/MessageBoxP.json",minesweepingdialog:"res/ui/SaoLeiDialog.json",minesweepingmenu:"res/ui/MineSweeping_Menu.json",minesweepingrule:"res/ui/MineSweepingRule.json",text_saolei:"res/ui/MineSweeping/sl_img_saolei@2x.png",progress_saolei:"res/ui/MineSweepingNew/ptj_img_jishi@2x.png",coin_saolei:"res/ui/MineSweepingNew/yyl_img_gold@2x.png",btn_ready:"res/ui/commonCells/commonPic/inRoomSamePic/yypk_btn_ready@2x.png",dileiJ:"res/roomAnimate/dilei.json",dileiA:"res/roomAnimate/dilei.atlas",dileiP:"res/roomAnimate/dilei.png",dileiP1:"res/roomAnimate/dilei2.png",dilei2J:"res/roomAnimate/dilei22.json",dilei2A:"res/roomAnimate/dilei22.atlas",dilei2P:"res/roomAnimate/dilei22.png",ptj_losebg:"res/ui/pingtianjiu/ptj_bg_lose@2x.png",btn_quitExit:"res/ui/commonCells/commonPic/inRoomSamePic/btn_quitExit@2x.png",btn_quqian:"res/ui/commonCells/commonPic/inRoomSamePic/btn_quqian@2x.png",btn_layerJson:"res/ui/btn_Layer.json",safeLayerJson:"res/ui/safeLayer.json",blueSafe:"res/ui/safeLayer/yypk_img_bluews@2x.png",redSafe:"res/ui/safeLayer/yypk_img_redws@2x.png",cardsplist:"res/cards.plist",cardspng:"res/cards.png",ani1list:"res/ani1.plist",ani1png:"res/ani1.png",img_buqiang:"res/ui/niuniunew/img_buqiang@2x.png",img_qiangzhuang:"res/ui/niuniunew/img_qiangzhuang@2x.png",btn_meiniu:"res/ui/niuniunew/331_btn_meiniu@2x.png",btn_youniu:"res/ui/niuniunew/331_btn_youniu@2x.png",fenxiang_zi:"res/ui/niuniunew/fenxiang_zi.png",progressBar:"res/ui/niuniunew/im_headbg1.png",chatbg_ld:"res/other/chatbg_ld.png",chatbg_lt:"res/other/chatbg_lt.png",chatbg_rd:"res/other/chatbg_rd.png",julebu_infolist:"res/ui/Clubinfomyself.json",julebu_clubmanger:"res/ui/Clubmanger.json",julebu_clubpersons:"res/ui/ClubPersons.json",julebu_clubcells:"res/ui/Clubcells.json",julebu_rankItem:"res/ui/clubRankItem.json",julebu_recordUser:"res/ui/clubRecordUser.json",julebu_recordItem:"res/ui/clubRecordItem.json",julebu_roomListItem:"res/ui/clubRoomListItem.json",julebu_roomSetItem:"res/ui/clubRoomSetItem.json",julebu_applyListItem:"res/ui/clubApplyListItem.json",julebu_dynamic:"res/ui/clubDynamic.json",julebu_statistics:"res/ui/clubStatistics.json",julebu_memberItem:"res/ui/clubMemberItem.json",clubIcon0:"res/ui/clubres/clubinfo/club_icon1@2x.png",clubIcon1:"res/ui/clubres/clubinfo/club_icon2@2x.png",clubIcon2:"res/ui/clubres/clubinfo/club_icon3@2x.png",clubIcon3:"res/ui/clubres/clubinfo/club_icon4@2x.png",jublebu_setkfbtn:"res/ui/clubres/clubinfo/club_btn_shezhi@2x.png",jublebu_90:"res/ui/clubres/clubinfo/gameicon/gxddz.png",jublebu_6:"res/ui/clubres/clubinfo/gameicon/jy_ddz.png",jublebu_36:"res/ui/clubres/clubinfo/gameicon/jy_saolei.png",jublebu_130:"res/ui/clubres/clubinfo/gameicon/wolong.png",hlgcTable:"res/ui/hlgcTable.json",hlgcResultOne:"res/ui/EndRoundWindow.json",hlgcResultAll:"res/ui/AllEnd.json",hlgcReplayUI:"res/ui/hlgcReplayWindow.json",hlgcCheatJson:"res/ui/cheatLayer.json",mah_bg_plist:"res/ui/newMah/mah_Bg.plist",mah_text_plist:"res/ui/newMah/mah_Text.plist",mah_bg_png:"res/ui/newMah/mah_Bg.png",mah_text_png:"res/ui/newMah/mah_Text.png",mah_down_plist:"res/ui/newMah/gxDdz/down.plist",mah_down_png:"res/ui/newMah/gxDdz/down.png",mah_out_left_plist:"res/ui/newMah/gxDdz/out_left.plist",mah_out_left_png:"res/ui/newMah/gxDdz/out_left.png",mah_out_ver_plist:"res/ui/newMah/gxDdz/out_ver.plist",mah_out_ver_png:"res/ui/newMah/gxDdz/out_ver.png",mah_out_right_plist:"res/ui/newMah/gxDdz/out_right.plist",mah_out_right_png:"res/ui/newMah/gxDdz/out_right.png",mah_back_plist:"res/ui/newMah/gxDdz/mah_back.plist",mah_back_png:"res/ui/newMah/gxDdz/mah_back.png",pointToSelf:"res/ui/hlgc/direction_down.png",pointToNext:"res/ui/hlgc/direction_left.png",pointToPrev:"res/ui/hlgc/direction_right.png",pointToOpposite:"res/ui/hlgc/direction_up.png",dengdai_json:"res/ui/hlgc/skeleton.json",dengdai_atlas:"res/ui/hlgc/skeleton.atlas",dengdai_png:"res/ui/hlgc/skeleton.png",talkBg:"res/ui/common/chat/wenzi_bg@2x.png",img_peng:"res/ui/hlgc/Z_peng.png",img_gang:"res/ui/hlgc/Z_gang.png",img_guo:"res/ui/hlgc/Z_guo.png",img_hu:"res/ui/hlgc/Z_hu.png",img_tiao:"res/ui/hlgc/img_tao@2x.png",img_tong:"res/ui/hlgc/img_tong@2x.png",img_wan:"res/ui/hlgc/img_wan@2x.png",img_oneHu:"res/ui/hlgc/img_yihu@2x.png",img_twoHu:"res/ui/hlgc/img_erhu@2x.png",img_threeHu:"res/ui/hlgc/img_sanhu@2x.png",img_ting:"res/ui/hlgc/img_ting@2x.png",tishiBg:"res/ui/hlgc/bg_hpts@2x.png",tishiSpBg:"res/ui/hlgc/img_hu_mjback@2x.png",tishiBgAlpha:"res/ui/hlgc/xinxi_bg@2x.png",woLongTxtBlack:"res/wolong/txt_wl2@2x.png",woLongTxtWhite:"res/wolong/txt_wl1@2x.png",cardsPng:"res/big.png",cardsPlistBig:"res/big.plist",yishuLabel:"res/ui/winGold.json",lostGold:"res/ui/lostGold.json",toushuLabel:"res/ui/touShuNode.json",wolongRecordCell:"res/ui/wolongRecordCell.json",wlReCordSceneJson:"res/ui/wlReCordScene.json",wolongTableJson:"res/ui/wlScene.json",wlEndPlayWindowJson:"res/ui/wlEndPlayWindow.json",wlAllEndPlayWindowJson:"res/ui/wlAllEndPlayWindow.json",jiangFontPng:"res/wolong/jiangFont.png",jiangFont:"res/wolong/jiangFont.fnt",yaobuqi:"res/wolong/ddz_img_buchu@2x.png",jiaLogo:"res/wolong/ptj_jia@2x.png",jianLogo:"res/wolong/ptj_jian@2x.png",lookZhanJi:"res/wolong/sr_btn_check@2x.png",you1:"res/wolong/you1.png",you2:"res/wolong/you2.png",you3:"res/wolong/you3.png",you4:"res/wolong/you4.png",you5:"res/wolong/you5.png",reCordPlayerBtnImg1:"res/wolong/btn_stop.png",reCordPlayerBtnImg2:"res/wolong/btn_on.png",reCordSpeed1:"res/wolong/X1@2x.png",reCordSpeed2:"res/wolong/X2@2x.png",reCordSpeed4:"res/wolong/X4@2x.png",allAutoPic:"res/wolong/btn_qzdtg.png",shopLayerJson:"res/ui/shopLayer.json",shopLayerItemJson:"res/ui/shopLayerItem.json",};var g_resources=[];for(var i in res){g_resources.push(res[i])}var g_face=[];for(var i=0;i<48;i++){g_face.push("res/ui/res/chat/EE"+i+"@2x.png")}for(var i=0;i<g_face.length;i++){g_resources.push(g_face[i])}var g_music={bmg:"res/sound/bgplay.mp3",selectItemMp3:"res/sound/selectItem.mp3",mjClick:"res/sound/dapai.mp3",fix_msg_1:"res/sound/fix_msg_1.mp3",fix_msg_2:"res/sound/fix_msg_2.mp3",fix_msg_3:"res/sound/fix_msg_3.mp3",fix_msg_4:"res/sound/fix_msg_4.mp3",fix_msg_5:"res/sound/fix_msg_5.mp3",fix_msg_6:"res/sound/fix_msg_6.mp3",fix_msg_7:"res/sound/fix_msg_7.mp3",fix_msg_8:"res/sound/fix_msg_8.mp3",fix_msg_9:"res/sound/fix_msg_9.mp3",Man_zhadan:"res/sound/ddz_effect/man/Man_zhadan.mp3",Man_sandaiyi:"res/sound/ddz_effect/man/Man_sandaiyi.mp3",Man_sandaiyidui:"res/sound/ddz_effect/man/Man_sandaiyidui.mp3",Man_shunzi:"res/sound/ddz_effect/man/Man_shunzi.mp3",Man_liandui:"res/sound/ddz_effect/man/Man_liandui.mp3",Man_sidaier:"res/sound/ddz_effect/man/Man_sidaier.mp3",Man_sidailiangdui:"res/sound/ddz_effect/man/Man_sidailiangdui.mp3",Man_feiji:"res/sound/ddz_effect/man/Man_feiji.mp3",Man_wangzha:"res/sound/ddz_effect/man/Man_wangzha.mp3",Man_NoOrder:"res/sound/ddz_effect/man/Man_NoOrder.mp3",Man_Order:"res/sound/ddz_effect/man/Man_Order.mp3",Man_bujiabei:"res/sound/ddz_effect/man/Man_bujiabei.mp3",Man_jiabei:"res/sound/ddz_effect/man/Man_jiabei.mp3",Man_one_card:"res/sound/ddz_effect/man/Man_one_card.mp3",Man_two_card:"res/sound/ddz_effect/man/Man_two_card.mp3",Woman_zhadan:"res/sound/ddz_effect/woman/Woman_zhadan.mp3",Woman_sandaiyi:"res/sound/ddz_effect/woman/Woman_sandaiyi.mp3",Woman_sandaiyidui:"res/sound/ddz_effect/woman/Woman_sandaiyidui.mp3",Woman_shunzi:"res/sound/ddz_effect/woman/Woman_shunzi.mp3",Woman_liandui:"res/sound/ddz_effect/woman/Woman_liandui.mp3",Woman_sidaier:"res/sound/ddz_effect/woman/Woman_sidaier.mp3",Woman_sidailiangdui:"res/sound/ddz_effect/woman/Woman_sidailiangdui.mp3",Woman_feiji:"res/sound/ddz_effect/woman/Woman_feiji.mp3",Woman_wangzha:"res/sound/ddz_effect/woman/Woman_wangzha.mp3",Woman_NoOrder:"res/sound/ddz_effect/woman/Woman_NoOrder.mp3",Woman_Order:"res/sound/ddz_effect/woman/Woman_Order.mp3",Woman_one_card:"res/sound/ddz_effect/woman/Woman_one_card.mp3",Woman_two_card:"res/sound/ddz_effect/woman/Woman_two_card.mp3",gold_ring:"res/sound/bet.mp3",sl_suc:"res/sound/sl_suc.mp3",sl_msg_m1:"res/sound/sl_effect/sl_msg_m1.mp3",sl_msg_m2:"res/sound/sl_effect/sl_msg_m2.mp3",sl_msg_m3:"res/sound/sl_effect/sl_msg_m3.mp3",sl_msg_m4:"res/sound/sl_effect/sl_msg_m4.mp3",sl_msg_m5:"res/sound/sl_effect/sl_msg_m5.mp3",sl_msg_m6:"res/sound/sl_effect/sl_msg_m6.mp3",sl_msg_m7:"res/sound/sl_effect/sl_msg_m7.mp3",sl_msg_m8:"res/sound/sl_effect/sl_msg_m8.mp3",sl_msg_m9:"res/sound/sl_effect/sl_msg_m9.mp3",sl_msg_w1:"res/sound/sl_effect/sl_msg_w1.mp3",sl_msg_w2:"res/sound/sl_effect/sl_msg_w2.mp3",sl_msg_w3:"res/sound/sl_effect/sl_msg_w3.mp3",sl_msg_w4:"res/sound/sl_effect/sl_msg_w4.mp3",sl_msg_w5:"res/sound/sl_effect/sl_msg_w5.mp3",sl_msg_w6:"res/sound/sl_effect/sl_msg_w6.mp3",sl_msg_w7:"res/sound/sl_effect/sl_msg_w7.mp3",sl_msg_w8:"res/sound/sl_effect/sl_msg_w8.mp3",sl_msg_w9:"res/sound/sl_effect/sl_msg_w9.mp3",fire:"res/sound/zjh_effect/fire.mp3",magic0:"res/sound/magic_effect/maginc0.mp3",magic1:"res/sound/magic_effect/maginc1.mp3",magic2:"res/sound/magic_effect/maginc2.mp3",magic3:"res/sound/magic_effect/maginc3.mp3",magic4:"res/sound/magic_effect/maginc4.mp3",Man_Rob_1:"res/sound/ddz_effect/man/Man_Rob_0.mp3",Man_Rob_2:"res/sound/ddz_effect/man/Man_Rob_1.mp3",Man_Rob_3:"res/sound/ddz_effect/man/Man_Rob_2.mp3",Woman_Rob_1:"res/sound/ddz_effect/woman/Woman_Rob_0.mp3",Woman_Rob_2:"res/sound/ddz_effect/woman/Woman_Rob_1.mp3",Woman_Rob_3:"res/sound/ddz_effect/woman/Woman_Rob_2.mp3","135":"res/sound/gxDdz/nv/PT_W_F_5_0.mp3","136":"res/sound/gxDdz/nv/PT_W_F_6_0.mp3","137":"res/sound/gxDdz/nv/PT_W_F_7_0.mp3","131":"res/sound/gxDdz/nv/PT_W_F_1_0.mp3","132":"res/sound/gxDdz/nv/PT_W_F_2_0.mp3","133":"res/sound/gxDdz/nv/PT_W_F_3_0.mp3","134":"res/sound/gxDdz/nv/PT_W_F_4_0.mp3","101":"res/sound/gxDdz/nv/PT_W_S_1_0.mp3","102":"res/sound/gxDdz/nv/PT_W_S_2_0.mp3","103":"res/sound/gxDdz/nv/PT_W_S_3_0.mp3","104":"res/sound/gxDdz/nv/PT_W_S_4_0.mp3","105":"res/sound/gxDdz/nv/PT_W_S_5_0.mp3","106":"res/sound/gxDdz/nv/PT_W_S_6_0.mp3","107":"res/sound/gxDdz/nv/PT_W_S_7_0.mp3","108":"res/sound/gxDdz/nv/PT_W_S_8_0.mp3","109":"res/sound/gxDdz/nv/PT_W_S_9_0.mp3","111":"res/sound/gxDdz/nv/PT_W_T_1_0.mp3","112":"res/sound/gxDdz/nv/PT_W_T_2_0.mp3","113":"res/sound/gxDdz/nv/PT_W_T_3_0.mp3","114":"res/sound/gxDdz/nv/PT_W_T_4_0.mp3","115":"res/sound/gxDdz/nv/PT_W_T_5_0.mp3","116":"res/sound/gxDdz/nv/PT_W_T_6_0.mp3","117":"res/sound/gxDdz/nv/PT_W_T_7_0.mp3","118":"res/sound/gxDdz/nv/PT_W_T_8_0.mp3","119":"res/sound/gxDdz/nv/PT_W_T_9_0.mp3","121":"res/sound/gxDdz/nv/PT_W_W_1_0.mp3","122":"res/sound/gxDdz/nv/PT_W_W_2_0.mp3","123":"res/sound/gxDdz/nv/PT_W_W_3_0.mp3","124":"res/sound/gxDdz/nv/PT_W_W_4_0.mp3","125":"res/sound/gxDdz/nv/PT_W_W_5_0.mp3","126":"res/sound/gxDdz/nv/PT_W_W_6_0.mp3","127":"res/sound/gxDdz/nv/PT_W_W_7_0.mp3","128":"res/sound/gxDdz/nv/PT_W_W_8_0.mp3","129":"res/sound/gxDdz/nv/PT_W_W_9_0.mp3",fchi:"res/sound/gxDdz/nv/PT_W_mingci_0.mp3",fgang:"res/sound/gxDdz/nv/PT_W_gang.mp3",fangang:"res/sound/gxDdz/nv/PT_W_angang.mp3",fzimo:"res/sound/gxDdz/nv/PT_W_zimo_1.mp3",fhu:"res/sound/gxDdz/nv/PT_W_hu.mp3",fpeng:"res/sound/gxDdz/nv/PT_W_peng_0.mp3",fbu:"res/sound/gxDdz/nv/W_buhua.mp3",fdianpao:"res/sound/gxDdz/nv/PT_W_dianpao_1.mp3",fgskh:"res/sound/gxDdz/nv/PT_W_gskh_0.mp3",fhdly:"res/sound/gxDdz/nv/PT_W_hdly.mp3","031":"res/sound/gxDdz/nan/PT_M_F_1_0.mp3","032":"res/sound/gxDdz/nan/PT_M_F_2_0.mp3","033":"res/sound/gxDdz/nan/PT_M_F_3_0.mp3","034":"res/sound/gxDdz/nan/PT_M_F_4_0.mp3","035":"res/sound/gxDdz/nan/PT_M_F_5_0.mp3","036":"res/sound/gxDdz/nan/PT_M_F_6_0.mp3","037":"res/sound/gxDdz/nan/PT_M_F_7_0.mp3","001":"res/sound/gxDdz/nan/PT_M_S_1_0.mp3","002":"res/sound/gxDdz/nan/PT_M_S_2_0.mp3","003":"res/sound/gxDdz/nan/PT_M_S_3_0.mp3","004":"res/sound/gxDdz/nan/PT_M_S_4_0.mp3","005":"res/sound/gxDdz/nan/PT_M_S_5_0.mp3","006":"res/sound/gxDdz/nan/PT_M_S_6_0.mp3","007":"res/sound/gxDdz/nan/PT_M_S_7_0.mp3","008":"res/sound/gxDdz/nan/PT_M_S_8_0.mp3","009":"res/sound/gxDdz/nan/PT_M_S_9_0.mp3","011":"res/sound/gxDdz/nan/PT_M_T_1_0.mp3","012":"res/sound/gxDdz/nan/PT_M_T_2_0.mp3","013":"res/sound/gxDdz/nan/PT_M_T_3_0.mp3","014":"res/sound/gxDdz/nan/PT_M_T_4_0.mp3","015":"res/sound/gxDdz/nan/PT_M_T_5_0.mp3","016":"res/sound/gxDdz/nan/PT_M_T_6_0.mp3","017":"res/sound/gxDdz/nan/PT_M_T_7_0.mp3","018":"res/sound/gxDdz/nan/PT_M_T_8_0.mp3","019":"res/sound/gxDdz/nan/PT_M_T_9_0.mp3","021":"res/sound/gxDdz/nan/PT_M_W_1_0.mp3","022":"res/sound/gxDdz/nan/PT_M_W_2_0.mp3","023":"res/sound/gxDdz/nan/PT_M_W_3_0.mp3","024":"res/sound/gxDdz/nan/PT_M_W_4_0.mp3","025":"res/sound/gxDdz/nan/PT_M_W_5_0.mp3","026":"res/sound/gxDdz/nan/PT_M_W_6_0.mp3","027":"res/sound/gxDdz/nan/PT_M_W_7_0.mp3","028":"res/sound/gxDdz/nan/PT_M_W_8_0.mp3","029":"res/sound/gxDdz/nan/PT_M_W_9_0.mp3",mchi:"res/sound/gxDdz/nan/PT_M_mingci_0.mp3",mgang:"res/sound/gxDdz/nan/PT_M_gang.mp3",mangang:"res/sound/gxDdz/nan/PT_M_angang.mp3",mzimo:"res/sound/gxDdz/nan/PT_M_zimo_1.mp3",mhu:"res/sound/gxDdz/nan/PT_M_hu.mp3",mpeng:"res/sound/gxDdz/nan/PT_M_peng_0.mp3",mbu:"res/sound/gxDdz/nan/M_buhua.mp3",fdianpao:"res/sound/gxDdz/nan/PT_M_dianpao_1.mp3",fgskh:"res/sound/gxDdz/nan/PT_M_gskh_0.mp3",fhdly:"res/sound/gxDdz/nan/PT_M_hdly.mp3",fqgh:"res/sound/gxDdz/nan/PT_M_qiangganghu_1.mp3",};for(var i=0;i<13;i++){g_music["Man_"+i]="res/sound/ddz_effect/man/Man_"+i+".mp3";g_music["Man_dui"+i]="res/sound/ddz_effect/man/Man_dui"+i+".mp3";g_music["Man_tuple"+i]="res/sound/ddz_effect/man/Man_tuple"+i+".mp3";g_music["Woman_"+i]="res/sound/ddz_effect/woman/Woman_"+i+".mp3";g_music["Woman_dui"+i]="res/sound/ddz_effect/woman/Woman_dui"+i+".mp3";g_music["Woman_tuple"+i]="res/sound/ddz_effect/woman/Woman_tuple"+i+".mp3"}for(var i=13;i<15;i++){g_music["Man_"+i]="res/sound/ddz_effect/man/Man_"+i+".mp3";g_music["Woman_"+i]="res/sound/ddz_effect/woman/Woman_"+i+".mp3"}for(var i=0;i<9;i++){g_music["tell"+i+"_M"]="res/sound/ddz_effect/man/Man_tell_"+(i+1)+".mp3";g_music["tell"+i+"_W"]="res/sound/ddz_effect/woman/Woman_tell_"+(i+1)+".mp3"}for(var i=0;i<9;i++){if(i==0){}else{g_music["m"+(i+1)]="res/sound/gxDdz/woman/m"+(i+1)+".mp3"}}for(var i=0;i<9;i++){g_music["m"+(20+i+1)]="res/sound/gxDdz/woman/m"+(20+i+1)+".mp3";g_music["m"+(10+i+1)]="res/sound/gxDdz/woman/m"+(10+i+1)+".mp3"}for(var i=0;i<7;i++){g_music["m"+(30+i+1)]="res/sound/gxDdz/woman/m"+(30+i+1)+".mp3"}for(var i in g_music){g_resources.push(g_music[i])}var musicMul={peng:"res/sound/gxDdz/woman/peng,4",gang:"res/sound/gxDdz/woman/gang,2",dianpao:"res/sound/gxDdz/woman/dianpao,3",zimo:"res/sound/gxDdz/woman/zimo,2",m1:"res/sound/gxDdz/woman/m1,2",Man_buyao:"res/sound/ddz_effect/man/Man_buyao,4",Woman_buyao:"res/sound/ddz_effect/woman/Woman_buyao,4",};for(var key in musicMul){var url=musicMul[key];g_music[key]=url;var strArr=url.split(",");var len=parseInt(strArr[1]);for(var j=0;j<len;j++){var realUrl=strArr[0]+"_"+j+".mp3";g_resources.push(realUrl)}}var g_chatstr_sl=["666，获得了手气王，不要太羡慕！","哎~运气好，没办法！","常在河边走，哪有不中雷！","大伙继续啊，扫雷到底！","哥们快点啊，准备开始啦！","今天这是要发啊，哈哈!","居然断线了，关键时刻掉链子","扫雷不可怕，谁踩谁尴尬！","哟嚯，你怎么又踩雷了！"];var g_chatstr=["你太牛了!","哈，手气真好!","快点出牌哦！","今天真高兴!","这个吃得好!","你放炮，我不胡","你家里是开银行的吧?","不好意思，我有事要先走一步了!","你的牌打得太好了!","大家好，很高兴见到各位!","怎么又断线了，网络怎么这么差呀"];var g_chatstrNew=["快点啊，都等的我的花儿都谢了","又断线啦？网络怎么这么差","不要走,决战到天亮","你的牌打得太好了","你是妹妹还是哥哥啊","和你合作真实太愉快了","大家好，很高兴见到各位","各位不好意思，我得离开一下","不要吵了，不要吵了，吵啥嘛吵，专心玩游戏",];var g_chatstrDdz=["不好意思先走一步。","大家好，很高兴见到各位。","哈哈，手气真好！","今天真高兴！","快点出牌哟。","你的牌打得太好了！","你家里是开银行的吧！","你太牛了！","怎么又断线了，网络真差。",];var g_womanTalk=[];for(var i=0;i<g_chatstr.length;i++){g_womanTalk.push("res/sound/gxDdz/woman/fix_msg_"+(i+1)+".mp3")}for(var i in g_womanTalk){g_resources.push(g_womanTalk[i])}var woLongMusic={pauseMusic_Man:["res/sound/woLongMusic/man/Man_buyao1.mp3","res/sound/woLongMusic/man/Man_buyao2.mp3","res/sound/woLongMusic/man/Man_buyao3.mp3","res/sound/woLongMusic/man/Man_buyao4.mp3"],pauseMusic_Woman:["res/sound/woLongMusic/woman/Woman_buyao1.mp3","res/sound/woLongMusic/woman/Woman_buyao2.mp3","res/sound/woLongMusic/woman/Woman_buyao3.mp3","res/sound/woLongMusic/woman/Woman_buyao4.mp3"],yasiMusic_Man:["res/sound/woLongMusic/man/Man_dani1.mp3","res/sound/woLongMusic/man/Man_dani2.mp3","res/sound/woLongMusic/man/Man_dani3.mp3"],yasiMusic_Woman:["res/sound/woLongMusic/woman/Woman_dani1.mp3","res/sound/woLongMusic/woman/Woman_dani2.mp3","res/sound/woLongMusic/woman/Woman_dani3.mp3"]};for(var i in woLongMusic){for(var j=0;j<woLongMusic[i].length;j++){g_resources.push(woLongMusic[i][j])}}var woLongMusics={bmg_wl:"res/sound/woLongMusic/bgFight.mp3",wl_faPai:"res/sound/woLongMusic/fapai1.mp3",wl_chuPai:"res/sound/woLongMusic/fapai3.mp3",wl_lost:"res/sound/woLongMusic/loseSound.mp3",wl_win:"res/sound/woLongMusic/winSound.mp3",wl_wait:"res/sound/woLongMusic/wait_time_tip.mp3",};for(var i=0;i<13;i++){woLongMusics["Man_"+(i+1)]="res/sound/woLongMusic/man/Man_"+(i+1)+".mp3";woLongMusics["Man_dui"+(i+1)]="res/sound/woLongMusic/man/Man_dui"+(i+1)+".mp3";woLongMusics["Man_tuple"+(i+1)]="res/sound/woLongMusic/man/Man_tuple"+(i+1)+".mp3";woLongMusics["Woman_"+(i+1)]="res/sound/woLongMusic/woman/Woman_"+(i+1)+".mp3";woLongMusics["Woman_dui"+(i+1)]="res/sound/woLongMusic/woman/Woman_dui"+(i+1)+".mp3";woLongMusics["Woman_tuple"+(i+1)]="res/sound/woLongMusic/woman/Woman_tuple"+(i+1)+".mp3"}for(var i=13;i<15;i++){woLongMusics["Man_"+(i+1)]="res/sound/woLongMusic/man/Man_"+(i+1)+".mp3";woLongMusics["Woman_"+(i+1)]="res/sound/woLongMusic/woman/Woman_"+(i+1)+".mp3"}for(var i in woLongMusics){g_resources.push(woLongMusics[i])}if(!g_will_room){var g_will_room=0}if(!g_islogin){var g_islogin=false}if(!g_isgame){var g_isgame=false}var gameclass=gameclass||{};gameclass.game=cc.Class.extend({modmgr:null,uimgr:null,ctor:function(){this.init()}});gameclass.game.prototype.init=function(){this.modmgr=new gameclass.modmgr;this.uimgr=new gameclass.uimgr;this.modmgr.setgame(this);this.uimgr.setgame(this);gameclass.mod_platform.game=this};gameclass.showText=function(d){var c=new cc.Sprite(res.tips_bg);c.setPosition(cc.winSize.width*0.5,cc.winSize.height*0.5);cc.director.getRunningScene().addChild(c,100000);var b=new cc.LabelTTF(d,"res/Font/FZY4JW_0569.TTF",30);b.setPosition(c.width*0.5,c.height*0.55);c.addChild(b);var a=cc.sequence(cc.scaleTo(0.1,1.2,1.2),cc.scaleTo(0.05,1,1),cc.delayTime(0.6),cc.moveBy(0.6,0,150),cc.callFunc(function(e){c.removeFromParent(true)}));c.runAction(a)};gameclass.getGameMainType=function(b){var a=b;if(b==gameclass.gamelzddz){a=gameclass.gameddz}return a};gameclass.getGameMainName=function(a){a=gameclass.getGameMainType(a);return StaticData.getRoomSetFromType(a).name};gameclass.createbtnpress=function(f,c,b,e,h,g){var d=ccui.helper.seekWidgetByName(f,c);var a=function(k,l){switch(l){case ccui.Widget.TOUCH_ENDED:if(b!=null){b(k,l,g)}var m=d.getChildByTag(1231);if(m!=null){m.setScale(1)}break;case ccui.Widget.TOUCH_BEGAN:if(e!=null){e(k,l,g)}var m=d.getChildByTag(1231);if(m!=null){m.setScale(1.1)}break;case ccui.Widget.TOUCH_CANCELED:if(h!=null){h(k,l,g)}var m=d.getChildByTag(1231);if(m!=null){m.setScale(1)}break}};if(d==null){cc.log("createbtnpress btn not found, btnName==="+c)}else{d.addTouchEventListener(a)}return d};(function(){var c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];var d=function(g){var h=new Array();while(g>0){var f=g%2;g=Math.floor(g/2);h.push(f)}h.reverse();return h};var b=function(l){var k=0;var h=0;for(var g=l.length-1;g>=0;--g){var f=l[g];if(f==1){k+=Math.pow(2,h)}++h}return k};var e=function(q,f){var h=(8-(q+1))+((q-1)*6);var g=f.length;var r=h-g;while(--r>=0){f.unshift(0)}var l=[];var p=q;while(--p>=0){l.push(1)}l.push(0);var m=0,o=8-(q+1);for(;m<o;++m){l.push(f[m])}for(var k=0;k<q-1;++k){l.push(1);l.push(0);var n=6;while(--n>=0){l.push(f[m++])}}return l};var a={encoder:function(p){var h=[];var f=[];for(var m=0,o=p.length;m<o;++m){var g=p.charCodeAt(m);var s=d(g);if(g<128){var k=8-s.length;while(--k>=0){s.unshift(0)}f=f.concat(s)}else{if(g>=128&&g<=2047){f=f.concat(e(2,s))}else{if(g>=2048&&g<=65535){f=f.concat(e(3,s))}else{if(g>=65536&&g<=2097151){f=f.concat(e(4,s))}else{if(g>=2097152&&g<=67108863){f=f.concat(e(5,s))}else{if(g>=4000000&&g<=2147483647){f=f.concat(e(6,s))}}}}}}}var r=0;for(var m=0,o=f.length;m<o;m+=6){var q=(m+6)-o;if(q==2){r=2}else{if(q==4){r=4}}var l=r;while(--l>=0){f.push(0)}h.push(b(f.slice(m,m+6)))}var n="";for(var m=0,o=h.length;m<o;++m){n+=c[h[m]]}for(var m=0,o=r/2;m<o;++m){n+="="}return n},decoder:function(t){var r=t.length;var u=0;if(t.charAt(r-1)=="="){if(t.charAt(r-2)=="="){u=4;t=t.substring(0,r-2)}else{u=2;t=t.substring(0,r-1)}}var f=[];for(var m=0,o=t.length;m<o;++m){var q=t.charAt(m);for(var l=0,w=c.length;l<w;++l){if(q==c[l]){var p=d(l);var v=p.length;if(6-v>0){for(var h=6-v;h>0;--h){p.unshift(0)}}f=f.concat(p);break}}}if(u>0){f=f.slice(0,f.length-u)}var g=[];var s=[];for(var m=0,o=f.length;m<o;){if(f[m]==0){g=g.concat(b(f.slice(m,m+8)));m+=8}else{var n=0;while(m<o){if(f[m]==1){++n}else{break}++m}s=s.concat(f.slice(m+1,m+8-n));m+=8-n;while(n>1){s=s.concat(f.slice(m+2,m+8));m+=8;--n}g=g.concat(b(s));s=[]}}return g}};gameclass.base64=a})();gameclass.title="秦皇棋牌";gameclass.download="https://fir.im/2beq";gameclass.endpoint="oss-cn-shanghai.aliyuncs.com";gameclass.keyid="LTAIXdTH2TL5dREA";gameclass.secretid="F1CwnUS45SgwxxKkPXEu71jnMpgQGy";gameclass.bucket="dfvoice";gameclass.test="false";gameclass.isCheat=true;gameclass.isAgent=false;gameclass.phpAddressPrev="http://qp2.77309477.gaofangh.com";gameclass.agentPostAdd="/gxddz/Admin/Api/";gameclass.advertiseAdd="/gxddz/Admin/Api/getImgUrl";gameclass.isShowAdvertised=false;var HelloWorldLayer=cc.Layer.extend({sprite:null,ctor:function(){this._super();cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(c,b){var a=b.getCurrentTarget();if(cc.KEY.back==c){if(!cc.sys.isNative){}else{if(cc.sys.os==sys.OS_IOS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","exit","(Ljava/lang/String;)V","")}else{}}}}},onKeyReleased:function(b,a){}},this);return true}});var game=null;var HelloWorldScene=cc.Scene.extend({onEnter:function(){this._super();var a=new HelloWorldLayer();this.addChild(a);var b=this;game=new gameclass.game;getcsvmgr.init();game.uimgr.showui("gameclass.loginui");gameclass.mod_platform.setbaseinfo(JSON.stringify({title:gameclass.title,download:gameclass.download,endpoint:gameclass.endpoint,keyid:gameclass.keyid,secretid:gameclass.secretid,bucket:gameclass.bucket,test:gameclass.test}));cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(d){cc.log("game.EVENT_HIDE!"+g_isgame);if(g_isgame){var c=game.modmgr.mod_login.mod_game.mywebsocket;var e={line:false};c.send("gameline",e)}});cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(d){cc.log("game.EVENT_SHOW");if(g_isgame){var c=game.modmgr.mod_login.mod_game.mywebsocket;var e={line:true};c.send("gameline",e)}})}});window.onerror=function(e,c,a,b,d){};Date.prototype.Format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a};!function(b){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function"==typeof define&&define.amd){define([],b)}else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,a.pako=b()}}}(function(){return function a(d,c,g){function b(p,k){if(!c[p]){if(!d[p]){var m="function"==typeof require&&require;if(!k&&m){return m(p,!0)}if(e){return e(p,!0)}var h=new Error("Cannot find module '"+p+"'");throw h.code="MODULE_NOT_FOUND",h}var n=c[p]={exports:{}};d[p][0].call(n.exports,function(o){var l=d[p][1][o];return b(l?l:o)},n,n.exports,a,d,c,g)}return c[p].exports}for(var e="function"==typeof require&&require,f=0;f<g.length;f++){b(g[f])}return b}({1:[function(g,d,c){var h="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;c.assign=function(m){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var k=l.shift();if(k){if("object"!=typeof k){throw new TypeError(k+"must be non-object")}for(var o in k){k.hasOwnProperty(o)&&(m[o]=k[o])}}}return m},c.shrinkBuf=function(l,k){return l.length===k?l:l.subarray?l.subarray(0,k):(l.length=k,l)};var b={arraySet:function(p,m,l,q,k){if(m.subarray&&p.subarray){return void p.set(m.subarray(l,l+q),k)}for(var o=0;o<q;o++){p[k+o]=m[l+o]}},flattenChunks:function(q){var m,l,u,k,p,s;for(u=0,m=0,l=q.length;m<l;m++){u+=q[m].length}for(s=new Uint8Array(u),k=0,m=0,l=q.length;m<l;m++){p=q[m],s.set(p,k),k+=p.length}return s}},f={arraySet:function(p,m,l,q,k){for(var o=0;o<q;o++){p[k+o]=m[l+o]}},flattenChunks:function(k){return[].concat.apply([],k)}};c.setTyped=function(k){k?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,b)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,f))},c.setTyped(h)},{}],2:[function(k,m,g){function d(q,o){if(o<65537&&(q.subarray&&c||!q.subarray&&b)){return String.fromCharCode.apply(null,l.shrinkBuf(q,o))}for(var f="",r=0;r<o;r++){f+=String.fromCharCode(q[r])}return f}var l=k("./common"),b=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch(k){b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(k){c=!1}for(var p=new l.Buf8(256),h=0;h<256;h++){p[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1}p[254]=p[254]=1,g.string2buf=function(y){var u,q,A,w,z,v=y.length,x=0;for(w=0;w<v;w++){q=y.charCodeAt(w),55296===(64512&q)&&w+1<v&&(A=y.charCodeAt(w+1),56320===(64512&A)&&(q=65536+(q-55296<<10)+(A-56320),w++)),x+=q<128?1:q<2048?2:q<65536?3:4}for(u=new l.Buf8(x),z=0,w=0;z<x;w++){q=y.charCodeAt(w),55296===(64512&q)&&w+1<v&&(A=y.charCodeAt(w+1),56320===(64512&A)&&(q=65536+(q-55296<<10)+(A-56320),w++)),q<128?u[z++]=q:q<2048?(u[z++]=192|q>>>6,u[z++]=128|63&q):q<65536?(u[z++]=224|q>>>12,u[z++]=128|q>>>6&63,u[z++]=128|63&q):(u[z++]=240|q>>>18,u[z++]=128|q>>>12&63,u[z++]=128|q>>>6&63,u[z++]=128|63&q)}return u},g.buf2binstring=function(f){return d(f,f.length)},g.binstring2buf=function(q){for(var o=new l.Buf8(q.length),f=0,r=o.length;f<r;f++){o[f]=q.charCodeAt(f)}return o},g.buf2string=function(x,u){var s,q,v,y,w=u||x.length,n=new Array(2*w);for(q=0,s=0;s<w;){if(v=x[s++],v<128){n[q++]=v}else{if(y=p[v],y>4){n[q++]=65533,s+=y-1}else{for(v&=2===y?31:3===y?15:7;y>1&&s<w;){v=v<<6|63&x[s++],y--}y>1?n[q++]=65533:v<65536?n[q++]=v:(v-=65536,n[q++]=55296|v>>10&1023,n[q++]=56320|1023&v)}}}return d(n,q)},g.utf8border=function(o,n){var f;for(n=n||o.length,n>o.length&&(n=o.length),f=n-1;f>=0&&128===(192&o[f]);){f--}return f<0?n:0===f?n:f+p[o[f]]>n?f:n}},{"./common":1}],3:[function(d,c,b){function f(m,k,h,q){for(var g=65535&m|0,l=m>>>16&65535|0,p=0;0!==h;){p=h>2000?2000:h,h-=p;do{g=g+k[q++]|0,l=l+g|0}while(--p);g%=65521,l%=65521}return g|l<<16|0}c.exports=f},{}],4:[function(d,c,b){c.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(g,d,c){function h(){for(var m,l=[],k=0;k<256;k++){m=k;for(var o=0;o<8;o++){m=1&m?3988292384^m>>>1:m>>>1}l[k]=m}return l}function b(q,m,l,u){var k=f,r=u+l;q^=-1;for(var p=u;p<r;p++){q=q>>>8^k[255&(q^m[p])]}return q^-1}var f=h();d.exports=b},{}],6:[function(d,c,b){function f(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}c.exports=f},{}],7:[function(f,d,c){var g=30,b=12;d.exports=function(X,I){var T,K,O,J,W,Q,Y,G,aa,U,ab,D,P,R,ac,V,F,N,C,z,q,H,L,n,M;T=X.state,K=X.next_in,n=X.input,O=K+(X.avail_in-5),J=X.next_out,M=X.output,W=J-(I-X.avail_out),Q=J+(X.avail_out-257),Y=T.dmax,G=T.wsize,aa=T.whave,U=T.wnext,ab=T.window,D=T.hold,P=T.bits,R=T.lencode,ac=T.distcode,V=(1<<T.lenbits)-1,F=(1<<T.distbits)-1;X:do{P<15&&(D+=n[K++]<<P,P+=8,D+=n[K++]<<P,P+=8),N=R[D&V];I:for(;;){if(C=N>>>24,D>>>=C,P-=C,C=N>>>16&255,0===C){M[J++]=65535&N}else{if(!(16&C)){if(0===(64&C)){N=R[(65535&N)+(D&(1<<C)-1)];continue I}if(32&C){T.mode=b;break X}X.msg="invalid literal/length code",T.mode=g;break X}z=65535&N,C&=15,C&&(P<C&&(D+=n[K++]<<P,P+=8),z+=D&(1<<C)-1,D>>>=C,P-=C),P<15&&(D+=n[K++]<<P,P+=8,D+=n[K++]<<P,P+=8),N=ac[D&F];T:for(;;){if(C=N>>>24,D>>>=C,P-=C,C=N>>>16&255,!(16&C)){if(0===(64&C)){N=ac[(65535&N)+(D&(1<<C)-1)];continue T}X.msg="invalid distance code",T.mode=g;break X}if(q=65535&N,C&=15,P<C&&(D+=n[K++]<<P,P+=8,P<C&&(D+=n[K++]<<P,P+=8)),q+=D&(1<<C)-1,q>Y){X.msg="invalid distance too far back",T.mode=g;break X}if(D>>>=C,P-=C,C=J-W,q>C){if(C=q-C,C>aa&&T.sane){X.msg="invalid distance too far back",T.mode=g;break X}if(H=0,L=ab,0===U){if(H+=G-C,C<z){z-=C;do{M[J++]=ab[H++]}while(--C);H=J-q,L=M}}else{if(U<C){if(H+=G+U-C,C-=U,C<z){z-=C;do{M[J++]=ab[H++]}while(--C);if(H=0,U<z){C=U,z-=C;do{M[J++]=ab[H++]}while(--C);H=J-q,L=M}}}else{if(H+=U-C,C<z){z-=C;do{M[J++]=ab[H++]}while(--C);H=J-q,L=M}}}for(;z>2;){M[J++]=L[H++],M[J++]=L[H++],M[J++]=L[H++],z-=3}z&&(M[J++]=L[H++],z>1&&(M[J++]=L[H++]))}else{H=J-q;do{M[J++]=M[H++],M[J++]=M[H++],M[J++]=M[H++],z-=3}while(z>2);z&&(M[J++]=M[H++],z>1&&(M[J++]=M[H++]))}break}}break}}while(K<O&&J<Q);z=P>>3,K-=z,P-=z<<3,D&=(1<<P)-1,X.next_in=K,X.next_out=J,X.avail_in=K<O?5+(O-K):5-(K-O),X.avail_out=J<Q?257+(Q-J):257-(J-Q),T.hold=D,T.bits=P}},{}],8:[function(aF,am,aA){function au(b){return(b>>>24&255)+(b>>>8&65280)+((65280&b)<<8)+((255&b)<<24)}function aK(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new aL.Buf16(320),this.work=new aL.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ao(c){var b;return c&&c.state?(b=c.state,c.total_in=c.total_out=b.total=0,c.msg="",b.wrap&&(c.adler=1&b.wrap),b.mode=bb,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new aL.Buf32(ad),b.distcode=b.distdyn=new aL.Buf32(bj),b.sane=1,b.back=-1,ag):bd}function at(c){var b;return c&&c.state?(b=c.state,b.wsize=0,b.whave=0,b.wnext=0,ao(c)):bd}function an(d,c){var b,f;return d&&d.state?(f=d.state,c<0?(b=0,c=-c):(b=(c>>4)+1,c<48&&(c&=15)),c&&(c<8||c>15)?bd:(null!==f.window&&f.wbits!==c&&(f.window=null),f.wrap=b,f.wbits=c,at(d))):bd}function aE(d,c){var b,f;return d?(f=new aK,d.state=f,f.window=null,b=an(d,c),b!==ag&&(d.state=null),b):bd}function ax(b){return aE(b,aa)}function aG(c){if(bi){var b;for(av=new aL.Buf32(512),ay=new aL.Buf32(32),b=0;b<144;){c.lens[b++]=8}for(;b<256;){c.lens[b++]=9}for(;b<280;){c.lens[b++]=7}for(;b<288;){c.lens[b++]=8}for(ai(aU,c.lens,0,288,av,0,c.work,{bits:9}),b=0;b<32;){c.lens[b++]=5}ai(ba,c.lens,0,32,ay,0,c.work,{bits:5}),bi=!1}c.lencode=av,c.lenbits=9,c.distcode=ay,c.distbits=5}function al(g,d,c,h){var b,f=g.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new aL.Buf8(f.wsize)),h>=f.wsize?(aL.arraySet(f.window,d,c-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(b=f.wsize-f.wnext,b>h&&(b=h),aL.arraySet(f.window,d,c-h,b,f.wnext),h-=b,h?(aL.arraySet(f.window,d,c-h,h,0),f.wnext=h,f.whave=f.wsize):(f.wnext+=b,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=b))),0}function aH(L,A){var I,P,C,D,B,K,G,M,J,O,y,E,H,x,Q,q,p,N,d,S,F,g,n,v,u=0,z=new aL.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&0!==L.avail_in){return bd}I=L.state,I.mode===aO&&(I.mode=aP),B=L.next_out,C=L.output,G=L.avail_out,D=L.next_in,P=L.input,K=L.avail_in,M=I.hold,J=I.bits,O=K,y=G,g=ag;L:for(;;){switch(I.mode){case bb:if(0===I.wrap){I.mode=aP;break}for(;J<16;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(2&I.wrap&&35615===M){I.check=0,z[0]=255&M,z[1]=M>>>8&255,I.check=ak(I.check,z,2,0),M=0,J=0,I.mode=a9;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&M)<<8)+(M>>8))%31){L.msg="incorrect header check",I.mode=ap;break}if((15&M)!==aR){L.msg="unknown compression method",I.mode=ap;break}if(M>>>=4,J-=4,F=(15&M)+8,0===I.wbits){I.wbits=F}else{if(F>I.wbits){L.msg="invalid window size",I.mode=ap;break}}I.dmax=1<<F,L.adler=I.check=1,I.mode=512&M?aq:aO,M=0,J=0;break;case a9:for(;J<16;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(I.flags=M,(255&I.flags)!==aR){L.msg="unknown compression method",I.mode=ap;break}if(57344&I.flags){L.msg="unknown header flags set",I.mode=ap;break}I.head&&(I.head.text=M>>8&1),512&I.flags&&(z[0]=255&M,z[1]=M>>>8&255,I.check=ak(I.check,z,2,0)),M=0,J=0,I.mode=a2;case a2:for(;J<32;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}I.head&&(I.head.time=M),512&I.flags&&(z[0]=255&M,z[1]=M>>>8&255,z[2]=M>>>16&255,z[3]=M>>>24&255,I.check=ak(I.check,z,4,0)),M=0,J=0,I.mode=a7;case a7:for(;J<16;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}I.head&&(I.head.xflags=255&M,I.head.os=M>>8),512&I.flags&&(z[0]=255&M,z[1]=M>>>8&255,I.check=ak(I.check,z,2,0)),M=0,J=0,I.mode=a1;case a1:if(1024&I.flags){for(;J<16;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}I.length=M,I.head&&(I.head.extra_len=M),512&I.flags&&(z[0]=255&M,z[1]=M>>>8&255,I.check=ak(I.check,z,2,0)),M=0,J=0}else{I.head&&(I.head.extra=null)}I.mode=az;case az:if(1024&I.flags&&(E=I.length,E>K&&(E=K),E&&(I.head&&(F=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),aL.arraySet(I.head.extra,P,D,E,F)),512&I.flags&&(I.check=ak(I.check,P,E,D)),K-=E,D+=E,I.length-=E),I.length)){break L}I.length=0,I.mode=a3;case a3:if(2048&I.flags){if(0===K){break L}E=0;do{F=P[D+E++],I.head&&F&&I.length<65536&&(I.head.name+=String.fromCharCode(F))}while(F&&E<K);if(512&I.flags&&(I.check=ak(I.check,P,E,D)),K-=E,D+=E,F){break L}}else{I.head&&(I.head.name=null)}I.length=0,I.mode=aX;case aX:if(4096&I.flags){if(0===K){break L}E=0;do{F=P[D+E++],I.head&&F&&I.length<65536&&(I.head.comment+=String.fromCharCode(F))}while(F&&E<K);if(512&I.flags&&(I.check=ak(I.check,P,E,D)),K-=E,D+=E,F){break L}}else{I.head&&(I.head.comment=null)}I.mode=aN;case aN:if(512&I.flags){for(;J<16;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(M!==(65535&I.check)){L.msg="header crc mismatch",I.mode=ap;break}M=0,J=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),L.adler=I.check=0,I.mode=aO;break;case aq:for(;J<32;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}L.adler=I.check=au(M),M=0,J=0,I.mode=a8;case a8:if(0===I.havedict){return L.next_out=B,L.avail_out=G,L.next_in=D,L.avail_in=K,I.hold=M,I.bits=J,a0}L.adler=I.check=1,I.mode=aO;case aO:if(A===aM||A===bg){break L}case aP:if(I.last){M>>>=7&J,J-=7&J,I.mode=bn;break}for(;J<3;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}switch(I.last=1&M,M>>>=1,J-=1,3&M){case 0:I.mode=a4;break;case 1:if(aG(I),I.mode=aw,A===bg){M>>>=2,J-=2;break L}break;case 2:I.mode=bl;break;case 3:L.msg="invalid block type",I.mode=ap}M>>>=2,J-=2;break;case a4:for(M>>>=7&J,J-=7&J;J<32;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if((65535&M)!==(M>>>16^65535)){L.msg="invalid stored block lengths",I.mode=ap;break}if(I.length=65535&M,M=0,J=0,I.mode=aW,A===bg){break L}case aW:I.mode=aQ;case aQ:if(E=I.length){if(E>K&&(E=K),E>G&&(E=G),0===E){break L}aL.arraySet(C,P,D,E,B),K-=E,D+=E,G-=E,B+=E,I.length-=E;break}I.mode=aO;break;case bl:for(;J<14;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(I.nlen=(31&M)+257,M>>>=5,J-=5,I.ndist=(31&M)+1,M>>>=5,J-=5,I.ncode=(15&M)+4,M>>>=4,J-=4,I.nlen>286||I.ndist>30){L.msg="too many length or distance symbols",I.mode=ap;break}I.have=0,I.mode=ab;case ab:for(;I.have<I.ncode;){for(;J<3;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}I.lens[R[I.have++]]=7&M,M>>>=3,J-=3}for(;I.have<19;){I.lens[R[I.have++]]=0}if(I.lencode=I.lendyn,I.lenbits=7,n={bits:I.lenbits},g=ai(ah,I.lens,0,19,I.lencode,0,I.work,n),I.lenbits=n.bits,g){L.msg="invalid code lengths set",I.mode=ap;break}I.have=0,I.mode=bc;case bc:for(;I.have<I.nlen+I.ndist;){for(;u=I.lencode[M&(1<<I.lenbits)-1],Q=u>>>24,q=u>>>16&255,p=65535&u,!(Q<=J);){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(p<16){M>>>=Q,J-=Q,I.lens[I.have++]=p}else{if(16===p){for(v=Q+2;J<v;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(M>>>=Q,J-=Q,0===I.have){L.msg="invalid bit length repeat",I.mode=ap;break}F=I.lens[I.have-1],E=3+(3&M),M>>>=2,J-=2}else{if(17===p){for(v=Q+3;J<v;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}M>>>=Q,J-=Q,F=0,E=3+(7&M),M>>>=3,J-=3}else{for(v=Q+7;J<v;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}M>>>=Q,J-=Q,F=0,E=11+(127&M),M>>>=7,J-=7}}if(I.have+E>I.nlen+I.ndist){L.msg="invalid bit length repeat",I.mode=ap;break}for(;E--;){I.lens[I.have++]=F}}}if(I.mode===ap){break}if(0===I.lens[256]){L.msg="invalid code -- missing end-of-block",I.mode=ap;break}if(I.lenbits=9,n={bits:I.lenbits},g=ai(aU,I.lens,0,I.nlen,I.lencode,0,I.work,n),I.lenbits=n.bits,g){L.msg="invalid literal/lengths set",I.mode=ap;break}if(I.distbits=6,I.distcode=I.distdyn,n={bits:I.distbits},g=ai(ba,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,n),I.distbits=n.bits,g){L.msg="invalid distances set",I.mode=ap;break}if(I.mode=aw,A===bg){break L}case aw:I.mode=a6;case a6:if(K>=6&&G>=258){L.next_out=B,L.avail_out=G,L.next_in=D,L.avail_in=K,I.hold=M,I.bits=J,ar(L,y),B=L.next_out,C=L.output,G=L.avail_out,D=L.next_in,P=L.input,K=L.avail_in,M=I.hold,J=I.bits,I.mode===aO&&(I.back=-1);break}for(I.back=0;u=I.lencode[M&(1<<I.lenbits)-1],Q=u>>>24,q=u>>>16&255,p=65535&u,!(Q<=J);){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(q&&0===(240&q)){for(N=Q,d=q,S=p;u=I.lencode[S+((M&(1<<N+d)-1)>>N)],Q=u>>>24,q=u>>>16&255,p=65535&u,!(N+Q<=J);){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}M>>>=N,J-=N,I.back+=N}if(M>>>=Q,J-=Q,I.back+=Q,I.length=p,0===q){I.mode=bm;break}if(32&q){I.back=-1,I.mode=aO;break}if(64&q){L.msg="invalid literal/length code",I.mode=ap;break}I.extra=15&q,I.mode=bh;case bh:if(I.extra){for(v=I.extra;J<v;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}I.length+=M&(1<<I.extra)-1,M>>>=I.extra,J-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=bo;case bo:for(;u=I.distcode[M&(1<<I.distbits)-1],Q=u>>>24,q=u>>>16&255,p=65535&u,!(Q<=J);){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(0===(240&q)){for(N=Q,d=q,S=p;u=I.distcode[S+((M&(1<<N+d)-1)>>N)],Q=u>>>24,q=u>>>16&255,p=65535&u,!(N+Q<=J);){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}M>>>=N,J-=N,I.back+=N}if(M>>>=Q,J-=Q,I.back+=Q,64&q){L.msg="invalid distance code",I.mode=ap;break}I.offset=p,I.extra=15&q,I.mode=aC;case aC:if(I.extra){for(v=I.extra;J<v;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}I.offset+=M&(1<<I.extra)-1,M>>>=I.extra,J-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){L.msg="invalid distance too far back",I.mode=ap;break}I.mode=bk;case bk:if(0===G){break L}if(E=y-G,I.offset>E){if(E=I.offset-E,E>I.whave&&I.sane){L.msg="invalid distance too far back",I.mode=ap;break}E>I.wnext?(E-=I.wnext,H=I.wsize-E):H=I.wnext-E,E>I.length&&(E=I.length),x=I.window}else{x=C,H=B-I.offset,E=I.length}E>G&&(E=G),G-=E,I.length-=E;do{C[B++]=x[H++]}while(--E);0===I.length&&(I.mode=a6);break;case bm:if(0===G){break L}C[B++]=I.length,G--,I.mode=a6;break;case bn:if(I.wrap){for(;J<32;){if(0===K){break L}K--,M|=P[D++]<<J,J+=8}if(y-=G,L.total_out+=y,I.total+=y,y&&(L.adler=I.check=I.flags?ak(I.check,C,y,B-y):aD(I.check,C,y,B-y)),y=G,(I.flags?M:au(M))!==I.check){L.msg="incorrect data check",I.mode=ap;break}M=0,J=0}I.mode=af;case af:if(I.wrap&&I.flags){for(;J<32;){if(0===K){break L}K--,M+=P[D++]<<J,J+=8}if(M!==(4294967295&I.total)){L.msg="incorrect length check",I.mode=ap;break}M=0,J=0}I.mode=aI;case aI:g=aV;break L;case ap:g=aY;break L;case aZ:return a5;case aT:default:return bd}}return L.next_out=B,L.avail_out=G,L.next_in=D,L.avail_in=K,I.hold=M,I.bits=J,(I.wsize||y!==L.avail_out&&I.mode<ap&&(I.mode<bn||A!==bf))&&al(L,L.output,L.next_out,y-L.avail_out)?(I.mode=aZ,a5):(O-=L.avail_in,y-=L.avail_out,L.total_in+=O,L.total_out+=y,I.total+=y,I.wrap&&y&&(L.adler=I.check=I.flags?ak(I.check,C,y,L.next_out-y):aD(I.check,C,y,L.next_out-y)),L.data_type=I.bits+(I.last?64:0)+(I.mode===aO?128:0)+(I.mode===aw||I.mode===aW?256:0),(0===O&&0===y||A===bf)&&g===ag&&(g=aS),g)}function aB(c){if(!c||!c.state){return bd}var b=c.state;return b.window&&(b.window=null),c.state=null,ag}function aJ(d,c){var b;return d&&d.state?(b=d.state,0===(2&b.wrap)?bd:(b.head=c,c.done=!1,ag)):bd}function aj(g,d){var c,h,b,f=d.length;return g&&g.state?(c=g.state,0!==c.wrap&&c.mode!==a8?bd:c.mode===a8&&(h=1,h=aD(h,d,f,0),h!==c.check)?aY:(b=al(g,d,f,f))?(c.mode=aZ,a5):(c.havedict=1,ag)):bd}var av,ay,aL=aF("../utils/common"),aD=aF("./adler32"),ak=aF("./crc32"),ar=aF("./inffast"),ai=aF("./inftrees"),ah=0,aU=1,ba=2,bf=4,aM=5,bg=6,ag=0,aV=1,a0=2,bd=-2,aY=-3,a5=-4,aS=-5,aR=8,bb=1,a9=2,a2=3,a7=4,a1=5,az=6,a3=7,aX=8,aN=9,aq=10,a8=11,aO=12,aP=13,a4=14,aW=15,aQ=16,bl=17,ab=18,bc=19,aw=20,a6=21,bh=22,bo=23,aC=24,bk=25,bm=26,bn=27,af=28,aI=29,ap=30,aZ=31,aT=32,ad=852,bj=592,ac=15,aa=ac,bi=!0;aA.inflateReset=at,aA.inflateReset2=an,aA.inflateResetKeep=ao,aA.inflateInit=ax,aA.inflateInit2=aE,aA.inflate=aH,aA.inflateEnd=aB,aA.inflateGetHeader=aJ,aA.inflateSetDictionary=aj,aA.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(w,B,p){var k=w("../utils/common"),z=15,b=852,g=592,C=0,v=1,m=2,x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],A=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],q=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];B.exports=function(ao,ad,am,ap,Y,aj,ak,aq){var an,aa,ai,W,Q,h,ac,ag,c,ah=aq.bits,J=0,l=0,r=0,af=0,o=0,V=0,f=0,d=0,ae=0,ab=0,u=null,X=0,s=new k.Buf16(z+1),al=new k.Buf16(z+1),G=null,n=0;for(J=0;J<=z;J++){s[J]=0}for(l=0;l<ap;l++){s[ad[am+l]]++}for(o=ah,af=z;af>=1&&0===s[af];af--){}if(o>af&&(o=af),0===af){return Y[aj++]=20971520,Y[aj++]=20971520,aq.bits=1,0}for(r=1;r<af&&0===s[r];r++){}for(o<r&&(o=r),d=1,J=1;J<=z;J++){if(d<<=1,d-=s[J],d<0){return -1}}if(d>0&&(ao===C||1!==af)){return -1}for(al[1]=0,J=1;J<z;J++){al[J+1]=al[J]+s[J]}for(l=0;l<ap;l++){0!==ad[am+l]&&(ak[al[ad[am+l]]++]=l)}if(ao===C?(u=G=ak,h=19):ao===v?(u=x,X-=257,G=A,n-=257,h=256):(u=y,G=q,h=-1),ab=0,l=0,J=r,Q=aj,V=o,f=0,ai=-1,ae=1<<o,W=ae-1,ao===v&&ae>b||ao===m&&ae>g){return 1}for(;;){ac=J-f,ak[l]<h?(ag=0,c=ak[l]):ak[l]>h?(ag=G[n+ak[l]],c=u[X+ak[l]]):(ag=96,c=0),an=1<<J-f,aa=1<<V,r=aa;do{aa-=an,Y[Q+(ab>>f)+aa]=ac<<24|ag<<16|c|0}while(0!==aa);for(an=1<<J-1;ab&an;){an>>=1}if(0!==an?(ab&=an-1,ab+=an):ab=0,l++,0===--s[J]){if(J===af){break}J=ad[am+ak[l]]}if(J>o&&(ab&W)!==ai){for(0===f&&(f=o),Q+=r,V=J-f,d=1<<V;V+f<af&&(d-=s[V+f],!(d<=0));){V++,d<<=1}if(ae+=1<<V,ao===v&&ae>b||ao===m&&ae>g){return 1}ai=ab&W,Y[ai]=o<<24|V<<16|Q-aj|0}}return 0!==ab&&(Y[Q+ab]=J-f<<24|64<<16|0),aq.bits=o,0}},{"../utils/common":1}],10:[function(d,c,b){c.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(d,c,b){function f(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}c.exports=f},{}],"/lib/inflate.js":[function(w,B,p){function k(f){if(!(this instanceof k)){return new k(f)}this.options=C.assign({chunkSize:16384,windowBits:0,to:""},f||{});var d=this.options;d.raw&&d.windowBits>=0&&d.windowBits<16&&(d.windowBits=-d.windowBits,0===d.windowBits&&(d.windowBits=-15)),!(d.windowBits>=0&&d.windowBits<16)||f&&f.windowBits||(d.windowBits+=32),d.windowBits>15&&d.windowBits<48&&0===(15&d.windowBits)&&(d.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A,this.strm.avail_out=0;var c=g.inflateInit2(this.strm,d.windowBits);if(c!==m.Z_OK){throw new Error(x[c])}this.header=new y,g.inflateGetHeader(this.strm,this.header)}function z(f,d){var c=new k(d);if(c.push(f,!0),c.err){throw c.msg||x[c.err]}return c.result}function b(d,c){return c=c||{},c.raw=!0,z(d,c)}var g=w("./zlib/inflate"),C=w("./utils/common"),v=w("./utils/strings"),m=w("./zlib/constants"),x=w("./zlib/messages"),A=w("./zlib/zstream"),y=w("./zlib/gzheader"),q=Object.prototype.toString;k.prototype.push=function(s,J){var o,h,G,f,D,I,E=this.strm,F=this.options.chunkSize,H=this.options.dictionary,l=!1;if(this.ended){return !1}h=J===~~J?J:J===!0?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof s?E.input=v.binstring2buf(s):"[object ArrayBuffer]"===q.call(s)?E.input=new Uint8Array(s):E.input=s,E.next_in=0,E.avail_in=E.input.length;do{if(0===E.avail_out&&(E.output=new C.Buf8(F),E.next_out=0,E.avail_out=F),o=g.inflate(E,m.Z_NO_FLUSH),o===m.Z_NEED_DICT&&H&&(I="string"==typeof H?v.string2buf(H):"[object ArrayBuffer]"===q.call(H)?new Uint8Array(H):H,o=g.inflateSetDictionary(this.strm,I)),o===m.Z_BUF_ERROR&&l===!0&&(o=m.Z_OK,l=!1),o!==m.Z_STREAM_END&&o!==m.Z_OK){return this.onEnd(o),this.ended=!0,!1}E.next_out&&(0!==E.avail_out&&o!==m.Z_STREAM_END&&(0!==E.avail_in||h!==m.Z_FINISH&&h!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(G=v.utf8border(E.output,E.next_out),f=E.next_out-G,D=v.buf2string(E.output,G),E.next_out=f,E.avail_out=F-f,f&&C.arraySet(E.output,E.output,G,f,0),this.onData(D)):this.onData(C.shrinkBuf(E.output,E.next_out)))),0===E.avail_in&&0===E.avail_out&&(l=!0)}while((E.avail_in>0||0===E.avail_out)&&o!==m.Z_STREAM_END);return o===m.Z_STREAM_END&&(h=m.Z_FINISH),h===m.Z_FINISH?(o=g.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===m.Z_OK):h!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),E.avail_out=0,!0)},k.prototype.onData=function(c){this.chunks.push(c)},k.prototype.onEnd=function(c){c===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=C.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},p.Inflate=k,p.inflate=z,p.inflateRaw=b,p.ungzip=z},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")});!function(a){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=a()}else{if("function"==typeof define&&define.amd){define([],a)}else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.pako=a()}}}(function(){return function a(g,b,c){function h(m,p){if(!b[m]){if(!g[m]){var e="function"==typeof require&&require;if(!p&&e){return e(m,!0)}if(f){return f(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var n=b[m]={exports:{}};g[m][0].call(n.exports,function(o){var l=g[m][1][o];return h(l?l:o)},n,n.exports,a,g,b,c)}return b[m].exports}for(var f="function"==typeof require&&require,d=0;d<c.length;d++){h(c[d])}return h}({1:[function(y,K,O){function G(c){if(!(this instanceof G)){return new G(c)}this.options=F.assign({level:k,method:q,chunkSize:16384,windowBits:15,memLevel:8,strategy:B,to:""},c||{});var d=this.options;d.raw&&d.windowBits>0?d.windowBits=-d.windowBits:d.gzip&&d.windowBits>0&&d.windowBits<16&&(d.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new J,this.strm.avail_out=0;var b=C.deflateInit2(this.strm,d.level,d.method,d.windowBits,d.memLevel,d.strategy);if(b!==N){throw new Error(L[b])}if(d.header&&C.deflateSetHeader(this.strm,d.header),d.dictionary){var f;if(f="string"==typeof d.dictionary?H.string2buf(d.dictionary):"[object ArrayBuffer]"===P.call(d.dictionary)?new Uint8Array(d.dictionary):d.dictionary,b=C.deflateSetDictionary(this.strm,f),b!==N){throw new Error(L[b])}this._dict_set=!0}}function D(c,d){var b=new G(d);if(b.push(c,!0),b.err){throw b.msg||L[b.err]}return b.result}function A(b,c){return c=c||{},c.raw=!0,D(b,c)}function z(b,c){return c=c||{},c.gzip=!0,D(b,c)}var C=y("./zlib/deflate"),F=y("./utils/common"),H=y("./utils/strings"),L=y("./zlib/messages"),J=y("./zlib/zstream"),P=Object.prototype.toString,x=0,M=4,N=0,I=1,E=2,k=-1,B=0,q=8;G.prototype.push=function(d,g){var b,c,h=this.strm,f=this.options.chunkSize;if(this.ended){return !1}c=g===~~g?g:g===!0?M:x,"string"==typeof d?h.input=H.string2buf(d):"[object ArrayBuffer]"===P.call(d)?h.input=new Uint8Array(d):h.input=d,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new F.Buf8(f),h.next_out=0,h.avail_out=f),b=C.deflate(h,c),b!==I&&b!==N){return this.onEnd(b),this.ended=!0,!1}0!==h.avail_out&&(0!==h.avail_in||c!==M&&c!==E)||("string"===this.options.to?this.onData(H.buf2binstring(F.shrinkBuf(h.output,h.next_out))):this.onData(F.shrinkBuf(h.output,h.next_out)))}while((h.avail_in>0||0===h.avail_out)&&b!==I);return c===M?(b=C.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===N):c!==E||(this.onEnd(N),h.avail_out=0,!0)},G.prototype.onData=function(b){this.chunks.push(b)},G.prototype.onEnd=function(b){b===N&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=F.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},O.Deflate=G,O.deflate=D,O.deflateRaw=A,O.gzip=z},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(A,v,x){function m(f){if(!(this instanceof m)){return new m(f)}this.options=c.assign({chunkSize:16384,windowBits:0,to:""},f||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,0===h.windowBits&&(h.windowBits=-15)),!(h.windowBits>=0&&h.windowBits<16)||f&&f.windowBits||(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&0===(15&h.windowBits)&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new q,this.strm.avail_out=0;var d=B.inflateInit2(this.strm,h.windowBits);if(d!==p.Z_OK){throw new Error(w[d])}this.header=new y,B.inflateGetHeader(this.strm,this.header)}function g(f,h){var d=new m(h);if(d.push(f,!0),d.err){throw d.msg||w[d.err]}return d.result}function b(d,f){return f=f||{},f.raw=!0,g(d,f)}var B=A("./zlib/inflate"),c=A("./utils/common"),k=A("./utils/strings"),p=A("./zlib/constants"),w=A("./zlib/messages"),q=A("./zlib/zstream"),y=A("./zlib/gzheader"),z=Object.prototype.toString;m.prototype.push=function(I,C){var G,o,l,h,D,u,H=this.strm,E=this.options.chunkSize,F=this.options.dictionary,s=!1;if(this.ended){return !1}o=C===~~C?C:C===!0?p.Z_FINISH:p.Z_NO_FLUSH,"string"==typeof I?H.input=k.binstring2buf(I):"[object ArrayBuffer]"===z.call(I)?H.input=new Uint8Array(I):H.input=I,H.next_in=0,H.avail_in=H.input.length;do{if(0===H.avail_out&&(H.output=new c.Buf8(E),H.next_out=0,H.avail_out=E),G=B.inflate(H,p.Z_NO_FLUSH),G===p.Z_NEED_DICT&&F&&(u="string"==typeof F?k.string2buf(F):"[object ArrayBuffer]"===z.call(F)?new Uint8Array(F):F,G=B.inflateSetDictionary(this.strm,u)),G===p.Z_BUF_ERROR&&s===!0&&(G=p.Z_OK,s=!1),G!==p.Z_STREAM_END&&G!==p.Z_OK){return this.onEnd(G),this.ended=!0,!1}H.next_out&&(0!==H.avail_out&&G!==p.Z_STREAM_END&&(0!==H.avail_in||o!==p.Z_FINISH&&o!==p.Z_SYNC_FLUSH)||("string"===this.options.to?(l=k.utf8border(H.output,H.next_out),h=H.next_out-l,D=k.buf2string(H.output,l),H.next_out=h,H.avail_out=E-h,h&&c.arraySet(H.output,H.output,l,h,0),this.onData(D)):this.onData(c.shrinkBuf(H.output,H.next_out)))),0===H.avail_in&&0===H.avail_out&&(s=!0)}while((H.avail_in>0||0===H.avail_out)&&G!==p.Z_STREAM_END);return G===p.Z_STREAM_END&&(o=p.Z_FINISH),o===p.Z_FINISH?(G=B.inflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===p.Z_OK):o!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),H.avail_out=0,!0)},m.prototype.onData=function(d){this.chunks.push(d)},m.prototype.onEnd=function(d){d===p.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},x.Inflate=m,x.inflate=g,x.inflateRaw=b,x.ungzip=g},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(d,g,b){var c="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;b.assign=function(m){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var k=n.shift();if(k){if("object"!=typeof k){throw new TypeError(k+"must be non-object")}for(var l in k){k.hasOwnProperty(l)&&(m[l]=k[l])}}}return m},b.shrinkBuf=function(k,l){return k.length===l?k:k.subarray?k.subarray(0,l):(k.length=l,k)};var h={arraySet:function(m,p,k,l,q){if(p.subarray&&m.subarray){return void m.set(p.subarray(k,k+l),q)}for(var o=0;o<l;o++){m[q+o]=p[k+o]}},flattenChunks:function(m){var q,k,l,u,p,o;for(l=0,q=0,k=m.length;q<k;q++){l+=m[q].length}for(o=new Uint8Array(l),u=0,q=0,k=m.length;q<k;q++){p=m[q],o.set(p,u),u+=p.length}return o}},f={arraySet:function(m,p,k,l,q){for(var o=0;o<l;o++){m[q+o]=p[k+o]}},flattenChunks:function(e){return[].concat.apply([],e)}};b.setTyped=function(e){e?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,h)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,f))},b.setTyped(c)},{}],4:[function(m,h,k){function g(o,q){if(q<65537&&(o.subarray&&p||!o.subarray&&b)){return String.fromCharCode.apply(null,d.shrinkBuf(o,q))}for(var l="",n=0;n<q;n++){l+=String.fromCharCode(o[n])}return l}var d=m("./common"),b=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(m){b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(m){p=!1}for(var c=new d.Buf8(256),f=0;f<256;f++){c[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1}c[254]=c[254]=1,k.string2buf=function(v){var y,q,u,x,w,z=v.length,n=0;for(x=0;x<z;x++){q=v.charCodeAt(x),55296===(64512&q)&&x+1<z&&(u=v.charCodeAt(x+1),56320===(64512&u)&&(q=65536+(q-55296<<10)+(u-56320),x++)),n+=q<128?1:q<2048?2:q<65536?3:4}for(y=new d.Buf8(n),w=0,x=0;w<n;x++){q=v.charCodeAt(x),55296===(64512&q)&&x+1<z&&(u=v.charCodeAt(x+1),56320===(64512&u)&&(q=65536+(q-55296<<10)+(u-56320),x++)),q<128?y[w++]=q:q<2048?(y[w++]=192|q>>>6,y[w++]=128|63&q):q<65536?(y[w++]=224|q>>>12,y[w++]=128|q>>>6&63,y[w++]=128|63&q):(y[w++]=240|q>>>18,y[w++]=128|q>>>12&63,y[w++]=128|q>>>6&63,y[w++]=128|63&q)}return y},k.buf2binstring=function(e){return g(e,e.length)},k.binstring2buf=function(o){for(var q=new d.Buf8(o.length),l=0,n=q.length;l<n;l++){q[l]=o.charCodeAt(l)}return q},k.buf2string=function(u,y){var q,z,x,w,o=y||u.length,v=new Array(2*o);for(z=0,q=0;q<o;){if(x=u[q++],x<128){v[z++]=x}else{if(w=c[x],w>4){v[z++]=65533,q+=w-1}else{for(x&=2===w?31:3===w?15:7;w>1&&q<o;){x=x<<6|63&u[q++],w--}w>1?v[z++]=65533:x<65536?v[z++]=x:(x-=65536,v[z++]=55296|x>>10&1023,v[z++]=56320|1023&x)}}}return g(v,z)},k.utf8border=function(n,o){var l;for(o=o||n.length,o>n.length&&(o=n.length),l=o-1;l>=0&&128===(192&n[l]);){l--}return l<0?o:0===l?o:l+c[n[l]]>o?l:o}},{"./common":3}],5:[function(d,f,b){function c(k,o,g,h){for(var p=65535&k|0,m=k>>>16&65535|0,l=0;0!==g;){l=g>2000?2000:g,g-=l;do{p=p+o[h++]|0,m=m+p|0}while(--l);p%=65521,m%=65521}return p|m<<16|0}f.exports=c},{}],6:[function(c,d,b){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(d,g,b){function c(){for(var m,n=[],k=0;k<256;k++){m=k;for(var l=0;l<8;l++){m=1&m?3988292384^m>>>1:m>>>1}n[k]=m}return n}function h(m,q,k,l){var u=f,p=l+k;m^=-1;for(var r=l;r<p;r++){m=m>>>8^u[255&(m^q[r])]}return m^-1}var f=c();g.exports=h},{}],8:[function(ao,aG,aL){function aC(b,c){return b.msg=bd[c],c}function ax(b){return(b<<1)-(b>4?9:0)}function aq(b){for(var c=b.length;--c>=0;){b[c]=0}}function ap(c){var d=c.state,b=d.pending;b>c.avail_out&&(b=c.avail_out),0!==b&&(aY.arraySet(c.output,d.pending_buf,d.pending_out,b,c.next_out),c.next_out+=b,d.pending_out+=b,c.total_out+=b,c.avail_out-=b,d.pending-=b,0===d.pending&&(d.pending_out=0))}function aw(b,c){be._tr_flush_block(b,b.block_start>=0?b.block_start:-1,b.strstart-b.block_start,c),b.block_start=b.strstart,ap(b.strm)}function az(b,c){b.pending_buf[b.pending++]=c}function aD(b,c){b.pending_buf[b.pending++]=c>>>8&255,b.pending_buf[b.pending++]=255&c}function aH(d,f,b,c){var g=d.avail_in;return g>c&&(g=c),0===g?0:(d.avail_in-=g,aY.arraySet(f,d.input,d.next_in,g,b),1===d.state.wrap?d.adler=a3(d.adler,f,g,b):2===d.state.wrap&&(d.adler=a1(d.adler,f,g,b)),d.next_in+=g,d.total_in+=g,g)}function aF(C,w){var z,p,k=C.max_chain_length,b=C.strstart,D=C.prev_length,g=C.nice_match,m=C.strstart>C.w_size-bn?C.strstart-(C.w_size-bn):0,q=C.window,x=C.w_mask,v=C.prev,A=C.strstart+ac,B=q[b+D-1],y=q[b+D];C.prev_length>=C.good_match&&(k>>=2),g>C.lookahead&&(g=C.lookahead);do{if(z=w,q[z+D]===y&&q[z+D-1]===B&&q[z]===q[b]&&q[++z]===q[b+1]){b+=2,z++;do{}while(q[++b]===q[++z]&&q[++b]===q[++z]&&q[++b]===q[++z]&&q[++b]===q[++z]&&q[++b]===q[++z]&&q[++b]===q[++z]&&q[++b]===q[++z]&&q[++b]===q[++z]&&b<A);if(p=ac-(A-b),b=A-ac,p>D){if(C.match_start=w,D=p,p>=g){break}B=q[b+D-1],y=q[b+D]}}}while((w=v[w&x])>m&&0!==--k);return D<=C.lookahead?D:C.lookahead}function aM(d){var h,b,c,k,g,f=d.w_size;do{if(k=d.window_size-d.lookahead-d.strstart,d.strstart>=f+(f-bn)){aY.arraySet(d.window,d.window,f,f,0),d.match_start-=f,d.strstart-=f,d.block_start-=f,b=d.hash_size,h=b;do{c=d.head[--h],d.head[h]=c>=f?c-f:0}while(--b);b=f,h=b;do{c=d.prev[--h],d.prev[h]=c>=f?c-f:0}while(--b);k+=f}if(0===d.strm.avail_in){break}if(b=aH(d.strm,d.window,d.strstart+d.lookahead,k),d.lookahead+=b,d.lookahead+d.insert>=aN){for(g=d.strstart-d.insert,d.ins_h=d.window[g],d.ins_h=(d.ins_h<<d.hash_shift^d.window[g+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[g+aN-1])&d.hash_mask,d.prev[g&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=g,g++,d.insert--,!(d.lookahead+d.insert<aN));){}}}while(d.lookahead<bn&&0!==d.strm.avail_in)}function an(d,f){var b=65535;for(b>d.pending_buf_size-5&&(b=d.pending_buf_size-5);;){if(d.lookahead<=1){if(aM(d),0===d.lookahead&&f===a8){return ae}if(0===d.lookahead){break}}d.strstart+=d.lookahead,d.lookahead=0;var c=d.block_start+b;if((0===d.strstart||d.strstart>=c)&&(d.lookahead=d.strstart-c,d.strstart=c,aw(d,!1),0===d.strm.avail_out)){return ae}if(d.strstart-d.block_start>=d.w_size-bn&&(aw(d,!1),0===d.strm.avail_out)){return ae}}return d.insert=0,f===bb?(aw(d,!0),0===d.strm.avail_out?bl:bq):d.strstart>d.block_start&&(aw(d,!1),0===d.strm.avail_out)?ae:ae}function aI(d,f){for(var b,c;;){if(d.lookahead<bn){if(aM(d),d.lookahead<bn&&f===a8){return ae}if(0===d.lookahead){break}}if(b=0,d.lookahead>=aN&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+aN-1])&d.hash_mask,b=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),0!==b&&d.strstart-b<=d.w_size-bn&&(d.match_length=aF(d,b)),d.match_length>=aN){if(c=be._tr_tally(d,d.strstart-d.match_start,d.match_length-aN),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=aN){d.match_length--;do{d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+aN-1])&d.hash_mask,b=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart}while(0!==--d.match_length);d.strstart++}else{d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask}}else{c=be._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++}if(c&&(aw(d,!1),0===d.strm.avail_out)){return ae}}return d.insert=d.strstart<aN-1?d.strstart:aN-1,f===bb?(aw(d,!0),0===d.strm.avail_out?bl:bq):d.last_lit&&(aw(d,!1),0===d.strm.avail_out)?ae:aa}function aJ(d,f){for(var b,c,g;;){if(d.lookahead<bn){if(aM(d),d.lookahead<bn&&f===a8){return ae}if(0===d.lookahead){break}}if(b=0,d.lookahead>=aN&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+aN-1])&d.hash_mask,b=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=aN-1,0!==b&&d.prev_length<d.max_lazy_match&&d.strstart-b<=d.w_size-bn&&(d.match_length=aF(d,b),d.match_length<=5&&(d.strategy===au||d.match_length===aN&&d.strstart-d.match_start>4096)&&(d.match_length=aN-1)),d.prev_length>=aN&&d.match_length<=d.prev_length){g=d.strstart+d.lookahead-aN,c=be._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-aN),d.lookahead-=d.prev_length-1,d.prev_length-=2;do{++d.strstart<=g&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+aN-1])&d.hash_mask,b=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart)}while(0!==--d.prev_length);if(d.match_available=0,d.match_length=aN-1,d.strstart++,c&&(aw(d,!1),0===d.strm.avail_out)){return ae}}else{if(d.match_available){if(c=be._tr_tally(d,0,d.window[d.strstart-1]),c&&aw(d,!1),d.strstart++,d.lookahead--,0===d.strm.avail_out){return ae}}else{d.match_available=1,d.strstart++,d.lookahead--}}}return d.match_available&&(c=be._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<aN-1?d.strstart:aN-1,f===bb?(aw(d,!0),0===d.strm.avail_out?bl:bq):d.last_lit&&(aw(d,!1),0===d.strm.avail_out)?ae:aa}function aE(d,h){for(var b,c,k,g,f=d.window;;){if(d.lookahead<=ac){if(aM(d),d.lookahead<=ac&&h===a8){return ae}if(0===d.lookahead){break}}if(d.match_length=0,d.lookahead>=aN&&d.strstart>0&&(k=d.strstart-1,c=f[k],c===f[++k]&&c===f[++k]&&c===f[++k])){g=d.strstart+ac;do{}while(c===f[++k]&&c===f[++k]&&c===f[++k]&&c===f[++k]&&c===f[++k]&&c===f[++k]&&c===f[++k]&&c===f[++k]&&k<g);d.match_length=ac-(g-k),d.match_length>d.lookahead&&(d.match_length=d.lookahead)}if(d.match_length>=aN?(b=be._tr_tally(d,1,d.match_length-aN),d.lookahead-=d.match_length,d.strstart+=d.match_length,d.match_length=0):(b=be._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++),b&&(aw(d,!1),0===d.strm.avail_out)){return ae}}return d.insert=0,h===bb?(aw(d,!0),0===d.strm.avail_out?bl:bq):d.last_lit&&(aw(d,!1),0===d.strm.avail_out)?ae:aa}function ay(c,d){for(var b;;){if(0===c.lookahead&&(aM(c),0===c.lookahead)){if(d===a8){return ae}break}if(c.match_length=0,b=be._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++,b&&(aw(c,!1),0===c.strm.avail_out)){return ae}}return c.insert=0,d===bb?(aw(c,!0),0===c.strm.avail_out?bl:bq):c.last_lit&&(aw(c,!1),0===c.strm.avail_out)?ae:aa}function ak(d,f,b,c,g){this.good_length=d,this.max_lazy=f,this.nice_length=b,this.max_chain=c,this.func=g}function av(b){b.window_size=2*b.w_size,aq(b.head),b.max_lazy_match=aO[b.level].max_lazy,b.good_match=aO[b.level].good_length,b.nice_match=aO[b.level].nice_length,b.max_chain_length=aO[b.level].max_chain,b.strstart=0,b.block_start=0,b.lookahead=0,b.insert=0,b.match_length=b.prev_length=aN-1,b.match_available=0,b.ins_h=0}function am(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=aT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new aY.Buf16(2*al),this.dyn_dtree=new aY.Buf16(2*(2*bp+1)),this.bl_tree=new aY.Buf16(2*(2*bk+1)),aq(this.dyn_ltree),aq(this.dyn_dtree),aq(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new aY.Buf16(bo+1),this.heap=new aY.Buf16(2*aQ+1),aq(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new aY.Buf16(2*aQ+1),aq(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function aA(b){var c;return b&&b.state?(b.total_in=b.total_out=0,b.data_type=aZ,c=b.state,c.pending=0,c.pending_out=0,c.wrap<0&&(c.wrap=-c.wrap),c.status=c.wrap?ar:ab,b.adler=2===c.wrap?0:1,c.last_flush=a8,be._tr_init(c),a9):aC(b,a6)}function ai(b){var c=aA(b);return c===a9&&av(b.state),c}function aj(b,c){return b&&b.state?2!==b.state.wrap?a6:(b.state.gzhead=c,a9):a6}function ah(d,h,c,m,g,f){if(!d){return a6}var k=1;if(h===aP&&(h=6),m<0?(k=0,m=-m):m>15&&(k=2,m-=16),g<1||g>bm||c!==aT||m<8||m>15||h<0||h>9||f<0||f>aS){return aC(d,a6)}8===m&&(m=9);var b=new am;return d.state=b,b.strm=d,b.wrap=k,b.gzhead=null,b.w_bits=m,b.w_size=1<<b.w_bits,b.w_mask=b.w_size-1,b.hash_bits=g+7,b.hash_size=1<<b.hash_bits,b.hash_mask=b.hash_size-1,b.hash_shift=~~((b.hash_bits+aN-1)/aN),b.window=new aY.Buf8(2*b.w_size),b.head=new aY.Buf16(b.hash_size),b.prev=new aY.Buf16(b.w_size),b.lit_bufsize=1<<g+6,b.pending_buf_size=4*b.lit_bufsize,b.pending_buf=new aY.Buf8(b.pending_buf_size),b.d_buf=1*b.lit_bufsize,b.l_buf=3*b.lit_bufsize,b.level=h,b.strategy=f,b.method=c,ai(d)}function bg(b,c){return ah(b,c,aT,aW,bs,a7)}function aX(q,h){var m,b,k,g;if(!q||!q.state||h>a5||h<0){return q?aC(q,a6):a6}if(b=q.state,!q.output||!q.input&&0!==q.avail_in||b.status===ad&&h!==bb){return aC(q,0===q.avail_out?a0:a6)}if(b.strm=q,m=b.last_flush,b.last_flush=h,b.status===ar){if(2===b.wrap){q.adler=0,az(b,31),az(b,139),az(b,8),b.gzhead?(az(b,(b.gzhead.text?1:0)+(b.gzhead.hcrc?2:0)+(b.gzhead.extra?4:0)+(b.gzhead.name?8:0)+(b.gzhead.comment?16:0)),az(b,255&b.gzhead.time),az(b,b.gzhead.time>>8&255),az(b,b.gzhead.time>>16&255),az(b,b.gzhead.time>>24&255),az(b,9===b.level?2:b.strategy>=ba||b.level<2?4:0),az(b,255&b.gzhead.os),b.gzhead.extra&&b.gzhead.extra.length&&(az(b,255&b.gzhead.extra.length),az(b,b.gzhead.extra.length>>8&255)),b.gzhead.hcrc&&(q.adler=a1(q.adler,b.pending_buf,b.pending,0)),b.gzindex=0,b.status=af):(az(b,0),az(b,0),az(b,0),az(b,0),az(b,0),az(b,9===b.level?2:b.strategy>=ba||b.level<2?4:0),az(b,a2),b.status=ab)}else{var n=aT+(b.w_bits-8<<4)<<8,p=-1;p=b.strategy>=ba||b.level<2?0:b.level<6?1:6===b.level?2:3,n|=p<<6,0!==b.strstart&&(n|=br),n+=31-n%31,b.status=ab,aD(b,n),0!==b.strstart&&(aD(b,q.adler>>>16),aD(b,65535&q.adler)),q.adler=1}}if(b.status===af){if(b.gzhead.extra){for(k=b.pending;b.gzindex<(65535&b.gzhead.extra.length)&&(b.pending!==b.pending_buf_size||(b.gzhead.hcrc&&b.pending>k&&(q.adler=a1(q.adler,b.pending_buf,b.pending-k,k)),ap(q),k=b.pending,b.pending!==b.pending_buf_size));){az(b,255&b.gzhead.extra[b.gzindex]),b.gzindex++}b.gzhead.hcrc&&b.pending>k&&(q.adler=a1(q.adler,b.pending_buf,b.pending-k,k)),b.gzindex===b.gzhead.extra.length&&(b.gzindex=0,b.status=aK)}else{b.status=aK}}if(b.status===aK){if(b.gzhead.name){k=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>k&&(q.adler=a1(q.adler,b.pending_buf,b.pending-k,k)),ap(q),k=b.pending,b.pending===b.pending_buf_size)){g=1;break}g=b.gzindex<b.gzhead.name.length?255&b.gzhead.name.charCodeAt(b.gzindex++):0,az(b,g)}while(0!==g);b.gzhead.hcrc&&b.pending>k&&(q.adler=a1(q.adler,b.pending_buf,b.pending-k,k)),0===g&&(b.gzindex=0,b.status=bi)}else{b.status=bi}}if(b.status===bi){if(b.gzhead.comment){k=b.pending;do{if(b.pending===b.pending_buf_size&&(b.gzhead.hcrc&&b.pending>k&&(q.adler=a1(q.adler,b.pending_buf,b.pending-k,k)),ap(q),k=b.pending,b.pending===b.pending_buf_size)){g=1;break}g=b.gzindex<b.gzhead.comment.length?255&b.gzhead.comment.charCodeAt(b.gzindex++):0,az(b,g)}while(0!==g);b.gzhead.hcrc&&b.pending>k&&(q.adler=a1(q.adler,b.pending_buf,b.pending-k,k)),0===g&&(b.status=bj)}else{b.status=bj}}if(b.status===bj&&(b.gzhead.hcrc?(b.pending+2>b.pending_buf_size&&ap(q),b.pending+2<=b.pending_buf_size&&(az(b,255&q.adler),az(b,q.adler>>8&255),q.adler=0,b.status=ab)):b.status=ab),0!==b.pending){if(ap(q),0===q.avail_out){return b.last_flush=-1,a9}}else{if(0===q.avail_in&&ax(h)<=ax(m)&&h!==bb){return aC(q,a0)}}if(b.status===ad&&0!==q.avail_in){return aC(q,a0)}if(0!==q.avail_in||0!==b.lookahead||h!==a8&&b.status!==ad){var l=b.strategy===ba?ay(b,h):b.strategy===aR?aE(b,h):aO[b.level].func(b,h);if(l!==bl&&l!==bq||(b.status=ad),l===ae||l===bl){return 0===q.avail_out&&(b.last_flush=-1),a9}if(l===aa&&(h===aU?be._tr_align(b):h!==a5&&(be._tr_stored_block(b,0,0,!1),h===aV&&(aq(b.head),0===b.lookahead&&(b.strstart=0,b.block_start=0,b.insert=0))),ap(q),0===q.avail_out)){return b.last_flush=-1,a9}}return h!==bb?a9:b.wrap<=0?aB:(2===b.wrap?(az(b,255&q.adler),az(b,q.adler>>8&255),az(b,q.adler>>16&255),az(b,q.adler>>24&255),az(b,255&q.total_in),az(b,q.total_in>>8&255),az(b,q.total_in>>16&255),az(b,q.total_in>>24&255)):(aD(b,q.adler>>>16),aD(b,65535&q.adler)),ap(q),b.wrap>0&&(b.wrap=-b.wrap),0!==b.pending?a9:aB)}function bc(b){var c;return b&&b.state?(c=b.state.status,c!==ar&&c!==af&&c!==aK&&c!==bi&&c!==bj&&c!==ab&&c!==ad?aC(b,a6):(b.state=null,c===ab?aC(b,a4):a9)):a6}function bh(v,q){var u,k,c,w,b,g,m,r,p=q.length;if(!v||!v.state){return a6}if(u=v.state,w=u.wrap,2===w||1===w&&u.status!==ar||u.lookahead){return a6}for(1===w&&(v.adler=a3(v.adler,q,p,0)),u.wrap=0,p>=u.w_size&&(0===w&&(aq(u.head),u.strstart=0,u.block_start=0,u.insert=0),r=new aY.Buf8(u.w_size),aY.arraySet(r,q,p-u.w_size,u.w_size,0),q=r,p=u.w_size),b=v.avail_in,g=v.next_in,m=v.input,v.avail_in=p,v.next_in=0,v.input=q,aM(u);u.lookahead>=aN;){k=u.strstart,c=u.lookahead-(aN-1);do{u.ins_h=(u.ins_h<<u.hash_shift^u.window[k+aN-1])&u.hash_mask,u.prev[k&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=k,k++}while(--c);u.strstart=k,u.lookahead=aN-1,aM(u)}return u.strstart+=u.lookahead,u.block_start=u.strstart,u.insert=u.lookahead,u.lookahead=0,u.match_length=u.prev_length=aN-1,u.match_available=0,v.next_in=g,v.input=m,v.avail_in=b,u.wrap=w,a9}var aO,aY=ao("../utils/common"),be=ao("./trees"),a3=ao("./adler32"),a1=ao("./crc32"),bd=ao("./messages"),a8=0,aU=1,aV=3,bb=4,a5=5,a9=0,aB=1,a6=-2,a4=-3,a0=-5,aP=-1,au=1,ba=2,aR=3,aS=4,a7=0,aZ=2,aT=8,bm=9,aW=15,bs=8,bf=29,ag=256,aQ=ag+1+bf,bp=30,bk=19,al=2*aQ+1,bo=15,aN=3,ac=258,bn=ac+aN+1,br=32,ar=42,af=69,aK=73,bi=91,bj=103,ab=113,ad=666,ae=1,aa=2,bl=3,bq=4,a2=3;aO=[new ak(0,0,0,0,an),new ak(4,4,8,4,aI),new ak(4,5,16,8,aI),new ak(4,6,32,32,aI),new ak(4,4,16,16,aJ),new ak(8,16,32,32,aJ),new ak(8,16,128,128,aJ),new ak(8,32,128,256,aJ),new ak(32,128,258,1024,aJ),new ak(32,258,258,4096,aJ)],aL.deflateInit=bg,aL.deflateInit2=ah,aL.deflateReset=ai,aL.deflateResetKeep=aA,aL.deflateSetHeader=aj,aL.deflate=aX,aL.deflateEnd=bc,aL.deflateSetDictionary=bh,aL.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(d,f,b){function c(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}f.exports=c},{}],10:[function(d,f,b){var c=30,g=12;f.exports=function(J,X){var ab,L,K,P,R,U,Y,W,ac,H,Z,aa,V,Q,F,O,G,T,C,D,q,M,n,I,N;ab=J.state,L=J.next_in,I=J.input,K=L+(J.avail_in-5),P=J.next_out,N=J.output,R=P-(X-J.avail_out),U=P+(J.avail_out-257),Y=ab.dmax,W=ab.wsize,ac=ab.whave,H=ab.wnext,Z=ab.window,aa=ab.hold,V=ab.bits,Q=ab.lencode,F=ab.distcode,O=(1<<ab.lenbits)-1,G=(1<<ab.distbits)-1;J:do{V<15&&(aa+=I[L++]<<V,V+=8,aa+=I[L++]<<V,V+=8),T=Q[aa&O];X:for(;;){if(C=T>>>24,aa>>>=C,V-=C,C=T>>>16&255,0===C){N[P++]=65535&T}else{if(!(16&C)){if(0===(64&C)){T=Q[(65535&T)+(aa&(1<<C)-1)];continue X}if(32&C){ab.mode=g;break J}J.msg="invalid literal/length code",ab.mode=c;break J}D=65535&T,C&=15,C&&(V<C&&(aa+=I[L++]<<V,V+=8),D+=aa&(1<<C)-1,aa>>>=C,V-=C),V<15&&(aa+=I[L++]<<V,V+=8,aa+=I[L++]<<V,V+=8),T=F[aa&G];ab:for(;;){if(C=T>>>24,aa>>>=C,V-=C,C=T>>>16&255,!(16&C)){if(0===(64&C)){T=F[(65535&T)+(aa&(1<<C)-1)];continue ab}J.msg="invalid distance code",ab.mode=c;break J}if(q=65535&T,C&=15,V<C&&(aa+=I[L++]<<V,V+=8,V<C&&(aa+=I[L++]<<V,V+=8)),q+=aa&(1<<C)-1,q>Y){J.msg="invalid distance too far back",ab.mode=c;break J}if(aa>>>=C,V-=C,C=P-R,q>C){if(C=q-C,C>ac&&ab.sane){J.msg="invalid distance too far back",ab.mode=c;break J}if(M=0,n=Z,0===H){if(M+=W-C,C<D){D-=C;do{N[P++]=Z[M++]}while(--C);M=P-q,n=N}}else{if(H<C){if(M+=W+H-C,C-=H,C<D){D-=C;do{N[P++]=Z[M++]}while(--C);if(M=0,H<D){C=H,D-=C;do{N[P++]=Z[M++]}while(--C);M=P-q,n=N}}}else{if(M+=H-C,C<D){D-=C;do{N[P++]=Z[M++]}while(--C);M=P-q,n=N}}}for(;D>2;){N[P++]=n[M++],N[P++]=n[M++],N[P++]=n[M++],D-=3}D&&(N[P++]=n[M++],D>1&&(N[P++]=n[M++]))}else{M=P-q;do{N[P++]=N[M++],N[P++]=N[M++],N[P++]=N[M++],D-=3}while(D>2);D&&(N[P++]=N[M++],D>1&&(N[P++]=N[M++]))}break}}break}}while(L<K&&P<U);D=V>>3,L-=D,V-=D<<3,aa&=(1<<V)-1,J.next_in=L,J.next_out=P,J.avail_in=L<K?5+(K-L):5-(L-K),J.avail_out=P<U?257+(U-P):257-(P-U),ab.hold=aa,ab.bits=V}},{}],11:[function(am,aE,aJ){function aA(b){return(b>>>24&255)+(b>>>8&65280)+((65280&b)<<8)+((255&b)<<24)}function av(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ai.Buf16(320),this.work=new ai.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ao(b){var c;return b&&b.state?(c=b.state,b.total_in=b.total_out=c.total=0,b.msg="",c.wrap&&(b.adler=1&c.wrap),c.mode=aT,c.last=0,c.havedict=0,c.dmax=32768,c.head=null,c.hold=0,c.bits=0,c.lencode=c.lendyn=new ai.Buf32(aI),c.distcode=c.distdyn=new ai.Buf32(bf),c.sane=1,c.back=-1,aM):a0}function an(b){var c;return b&&b.state?(c=b.state,c.wsize=0,c.whave=0,c.wnext=0,ao(b)):a0}function au(d,f){var b,c;return d&&d.state?(c=d.state,f<0?(b=0,f=-f):(b=(f>>4)+1,f<48&&(f&=15)),f&&(f<8||f>15)?a0:(null!==c.window&&c.wbits!==f&&(c.window=null),c.wrap=b,c.wbits=f,an(d))):a0}function ax(d,f){var b,c;return d?(c=new av,d.state=c,c.window=null,b=au(d,f),b!==aM&&(d.state=null),b):a0}function aB(b){return ax(b,aa)}function aF(b){if(ac){var c;for(aC=new ai.Buf32(512),aw=new ai.Buf32(32),c=0;c<144;){b.lens[c++]=8}for(;c<256;){b.lens[c++]=9}for(;c<280;){b.lens[c++]=7}for(;c<288;){b.lens[c++]=8}for(ag(af,b.lens,0,288,aC,0,b.work,{bits:9}),c=0;c<32;){b.lens[c++]=5}ag(bd,b.lens,0,32,aw,0,b.work,{bits:5}),ac=!1}b.lencode=aC,b.lenbits=9,b.distcode=aw,b.distbits=5}function aD(d,g,b,c){var h,f=d.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new ai.Buf8(f.wsize)),c>=f.wsize?(ai.arraySet(f.window,g,b-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(h=f.wsize-f.wnext,h>c&&(h=c),ai.arraySet(f.window,g,b-c,h,f.wnext),c-=h,c?(ai.arraySet(f.window,g,b-c,c,0),f.wnext=c,f.whave=f.wsize):(f.wnext+=h,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=h))),0}function aK(v,L){var P,D,x,w,A,G,J,R,q,N,O,K,E,M,y,z,f,C,F,Q,H,p,k,S,I=0,d=new ai.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!v||!v.state||!v.output||!v.input&&0!==v.avail_in){return a0}P=v.state,P.mode===aP&&(P.mode=aQ),A=v.next_out,x=v.output,J=v.avail_out,w=v.next_in,D=v.input,G=v.avail_in,R=P.hold,q=P.bits,N=G,O=J,p=aM;v:for(;;){switch(P.mode){case aT:if(0===P.wrap){P.mode=aQ;break}for(;q<16;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(2&P.wrap&&35615===R){P.check=0,d[0]=255&R,d[1]=R>>>8&255,P.check=ak(P.check,d,2,0),R=0,q=0,P.mode=a8;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&R)<<8)+(R>>8))%31){v.msg="incorrect header check",P.mode=bm;break}if((15&R)!==aS){v.msg="unknown compression method",P.mode=bm;break}if(R>>>=4,q-=4,H=(15&R)+8,0===P.wbits){P.wbits=H}else{if(H>P.wbits){v.msg="invalid window size",P.mode=bm;break}}P.dmax=1<<H,v.adler=P.check=1,P.mode=512&R?aq:aP,R=0,q=0;break;case a8:for(;q<16;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(P.flags=R,(255&P.flags)!==aS){v.msg="unknown compression method",P.mode=bm;break}if(57344&P.flags){v.msg="unknown header flags set",P.mode=bm;break}P.head&&(P.head.text=R>>8&1),512&P.flags&&(d[0]=255&R,d[1]=R>>>8&255,P.check=ak(P.check,d,2,0)),R=0,q=0,P.mode=a2;case a2:for(;q<32;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}P.head&&(P.head.time=R),512&P.flags&&(d[0]=255&R,d[1]=R>>>8&255,d[2]=R>>>16&255,d[3]=R>>>24&255,P.check=ak(P.check,d,4,0)),R=0,q=0,P.mode=a6;case a6:for(;q<16;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}P.head&&(P.head.xflags=255&R,P.head.os=R>>8),512&P.flags&&(d[0]=255&R,d[1]=R>>>8&255,P.check=ak(P.check,d,2,0)),R=0,q=0,P.mode=az;case az:if(1024&P.flags){for(;q<16;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}P.length=R,P.head&&(P.head.extra_len=R),512&P.flags&&(d[0]=255&R,d[1]=R>>>8&255,P.check=ak(P.check,d,2,0)),R=0,q=0}else{P.head&&(P.head.extra=null)}P.mode=a3;case a3:if(1024&P.flags&&(K=P.length,K>G&&(K=G),K&&(P.head&&(H=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),ai.arraySet(P.head.extra,D,w,K,H)),512&P.flags&&(P.check=ak(P.check,D,K,w)),G-=K,w+=K,P.length-=K),P.length)){break v}P.length=0,P.mode=a1;case a1:if(2048&P.flags){if(0===G){break v}K=0;do{H=D[w+K++],P.head&&H&&P.length<65536&&(P.head.name+=String.fromCharCode(H))}while(H&&K<G);if(512&P.flags&&(P.check=ak(P.check,D,K,w)),G-=K,w+=K,H){break v}}else{P.head&&(P.head.name=null)}P.length=0,P.mode=aY;case aY:if(4096&P.flags){if(0===G){break v}K=0;do{H=D[w+K++],P.head&&H&&P.length<65536&&(P.head.comment+=String.fromCharCode(H))}while(H&&K<G);if(512&P.flags&&(P.check=ak(P.check,D,K,w)),G-=K,w+=K,H){break v}}else{P.head&&(P.head.comment=null)}P.mode=aN;case aN:if(512&P.flags){for(;q<16;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(R!==(65535&P.check)){v.msg="header crc mismatch",P.mode=bm;break}R=0,q=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),v.adler=P.check=0,P.mode=aP;break;case aq:for(;q<32;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}v.adler=P.check=aA(R),R=0,q=0,P.mode=a7;case a7:if(0===P.havedict){return v.next_out=A,v.avail_out=J,v.next_in=w,v.avail_in=G,P.hold=R,P.bits=q,bb}v.adler=P.check=1,P.mode=aP;case aP:if(L===a9||L===be){break v}case aQ:if(P.last){R>>>=7&q,q-=7&q,P.mode=aL;break}for(;q<3;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}switch(P.last=1&R,R>>>=1,q-=1,3&R){case 0:P.mode=a4;break;case 1:if(aF(P),P.mode=bc,L===be){R>>>=2,q-=2;break v}break;case 2:P.mode=bi;break;case 3:v.msg="invalid block type",P.mode=bm}R>>>=2,q-=2;break;case a4:for(R>>>=7&q,q-=7&q;q<32;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if((65535&R)!==(R>>>16^65535)){v.msg="invalid stored block lengths",P.mode=bm;break}if(P.length=65535&R,R=0,q=0,P.mode=aX,L===be){break v}case aX:P.mode=aR;case aR:if(K=P.length){if(K>G&&(K=G),K>J&&(K=J),0===K){break v}ai.arraySet(x,D,w,K,A),G-=K,w+=K,J-=K,A+=K,P.length-=K;break}P.mode=aP;break;case bi:for(;q<14;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(P.nlen=(31&R)+257,R>>>=5,q-=5,P.ndist=(31&R)+1,R>>>=5,q-=5,P.ncode=(15&R)+4,R>>>=4,q-=4,P.nlen>286||P.ndist>30){v.msg="too many length or distance symbols",P.mode=bm;break}P.have=0,P.mode=aU;case aU:for(;P.have<P.ncode;){for(;q<3;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}P.lens[B[P.have++]]=7&R,R>>>=3,q-=3}for(;P.have<19;){P.lens[B[P.have++]]=0}if(P.lencode=P.lendyn,P.lenbits=7,k={bits:P.lenbits},p=ag(ah,P.lens,0,19,P.lencode,0,P.work,k),P.lenbits=k.bits,p){v.msg="invalid code lengths set",P.mode=bm;break}P.have=0,P.mode=bn;case bn:for(;P.have<P.nlen+P.ndist;){for(;I=P.lencode[R&(1<<P.lenbits)-1],y=I>>>24,z=I>>>16&255,f=65535&I,!(y<=q);){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(f<16){R>>>=y,q-=y,P.lens[P.have++]=f}else{if(16===f){for(S=y+2;q<S;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(R>>>=y,q-=y,0===P.have){v.msg="invalid bit length repeat",P.mode=bm;break}H=P.lens[P.have-1],K=3+(3&R),R>>>=2,q-=2}else{if(17===f){for(S=y+3;q<S;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}R>>>=y,q-=y,H=0,K=3+(7&R),R>>>=3,q-=3}else{for(S=y+7;q<S;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}R>>>=y,q-=y,H=0,K=11+(127&R),R>>>=7,q-=7}}if(P.have+K>P.nlen+P.ndist){v.msg="invalid bit length repeat",P.mode=bm;break}for(;K--;){P.lens[P.have++]=H}}}if(P.mode===bm){break}if(0===P.lens[256]){v.msg="invalid code -- missing end-of-block",P.mode=bm;break}if(P.lenbits=9,k={bits:P.lenbits},p=ag(af,P.lens,0,P.nlen,P.lencode,0,P.work,k),P.lenbits=k.bits,p){v.msg="invalid literal/lengths set",P.mode=bm;break}if(P.distbits=6,P.distcode=P.distdyn,k={bits:P.distbits},p=ag(bd,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,k),P.distbits=k.bits,p){v.msg="invalid distances set",P.mode=bm;break}if(P.mode=bc,L===be){break v}case bc:P.mode=ae;case ae:if(G>=6&&J>=258){v.next_out=A,v.avail_out=J,v.next_in=w,v.avail_in=G,P.hold=R,P.bits=q,ay(v,O),A=v.next_out,x=v.output,J=v.avail_out,w=v.next_in,D=v.input,G=v.avail_in,R=P.hold,q=P.bits,P.mode===aP&&(P.back=-1);break}for(P.back=0;I=P.lencode[R&(1<<P.lenbits)-1],y=I>>>24,z=I>>>16&255,f=65535&I,!(y<=q);){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(z&&0===(240&z)){for(C=y,F=z,Q=f;I=P.lencode[Q+((R&(1<<C+F)-1)>>C)],y=I>>>24,z=I>>>16&255,f=65535&I,!(C+y<=q);){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}R>>>=C,q-=C,P.back+=C}if(R>>>=y,q-=y,P.back+=y,P.length=f,0===z){P.mode=bk;break}if(32&z){P.back=-1,P.mode=aP;break}if(64&z){v.msg="invalid literal/length code",P.mode=bm;break}P.extra=15&z,P.mode=aO;case aO:if(P.extra){for(S=P.extra;q<S;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}P.length+=R&(1<<P.extra)-1,R>>>=P.extra,q-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=bl;case bl:for(;I=P.distcode[R&(1<<P.distbits)-1],y=I>>>24,z=I>>>16&255,f=65535&I,!(y<=q);){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(0===(240&z)){for(C=y,F=z,Q=f;I=P.distcode[Q+((R&(1<<C+F)-1)>>C)],y=I>>>24,z=I>>>16&255,f=65535&I,!(C+y<=q);){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}R>>>=C,q-=C,P.back+=C}if(R>>>=y,q-=y,P.back+=y,64&z){v.msg="invalid distance code",P.mode=bm;break}P.offset=f,P.extra=15&z,P.mode=bh;case bh:if(P.extra){for(S=P.extra;q<S;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}P.offset+=R&(1<<P.extra)-1,R>>>=P.extra,q-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){v.msg="invalid distance too far back",P.mode=bm;break}P.mode=aj;case aj:if(0===J){break v}if(K=O-J,P.offset>K){if(K=P.offset-K,K>P.whave&&P.sane){v.msg="invalid distance too far back",P.mode=bm;break}K>P.wnext?(K-=P.wnext,E=P.wsize-K):E=P.wnext-K,K>P.length&&(K=P.length),M=P.window}else{M=x,E=A-P.offset,K=P.length}K>J&&(K=J),J-=K,P.length-=K;do{x[A++]=M[E++]}while(--K);0===P.length&&(P.mode=ae);break;case bk:if(0===J){break v}x[A++]=P.length,J--,P.mode=ae;break;case aL:if(P.wrap){for(;q<32;){if(0===G){break v}G--,R|=D[w++]<<q,q+=8}if(O-=J,v.total_out+=O,P.total+=O,O&&(v.adler=P.check=P.flags?ak(P.check,x,O,A-O):ar(P.check,x,O,A-O)),O=J,(P.flags?R:aA(R))!==P.check){v.msg="incorrect data check",P.mode=bm;break}R=0,q=0}P.mode=ab;case ab:if(P.wrap&&P.flags){for(;q<32;){if(0===G){break v}G--,R+=D[w++]<<q,q+=8}if(R!==(4294967295&P.total)){v.msg="incorrect length check",P.mode=bm;break}R=0,q=0}P.mode=bj;case bj:p=aW;break v;case bm:p=aZ;break v;case ap:return ba;case ad:default:return a0}}return v.next_out=A,v.avail_out=J,v.next_in=w,v.avail_in=G,P.hold=R,P.bits=q,(P.wsize||O!==v.avail_out&&P.mode<bm&&(P.mode<aL||L!==aV))&&aD(v,v.output,v.next_out,O-v.avail_out)?(P.mode=ap,ba):(N-=v.avail_in,O-=v.avail_out,v.total_in+=N,v.total_out+=O,P.total+=O,P.wrap&&O&&(v.adler=P.check=P.flags?ak(P.check,x,O,v.next_out-O):ar(P.check,x,O,v.next_out-O)),v.data_type=P.bits+(P.last?64:0)+(P.mode===aP?128:0)+(P.mode===bc||P.mode===aX?256:0),(0===N&&0===O||L===aV)&&p===aM&&(p=a5),p)}function al(b){if(!b||!b.state){return a0}var c=b.state;return c.window&&(c.window=null),b.state=null,aM}function aG(c,d){var b;return c&&c.state?(b=c.state,0===(2&b.wrap)?a0:(b.head=d,d.done=!1,aM)):a0}function aH(d,g){var b,c,h,f=g.length;return d&&d.state?(b=d.state,0!==b.wrap&&b.mode!==a7?a0:b.mode===a7&&(c=1,c=ar(c,g,f,0),c!==b.check)?aZ:(h=aD(d,g,f,f))?(b.mode=ap,ba):(b.havedict=1,aM)):a0}var aC,aw,ai=am("../utils/common"),ar=am("./adler32"),ak=am("./crc32"),ay=am("./inffast"),ag=am("./inftrees"),ah=0,af=1,bd=2,aV=4,a9=5,be=6,aM=0,aW=1,bb=2,a0=-2,aZ=-3,ba=-4,a5=-5,aS=8,aT=1,a8=2,a2=3,a6=4,az=5,a3=6,a1=7,aY=8,aN=9,aq=10,a7=11,aP=12,aQ=13,a4=14,aX=15,aR=16,bi=17,aU=18,bn=19,bc=20,ae=21,aO=22,bl=23,bh=24,aj=25,bk=26,aL=27,ab=28,bj=29,bm=30,ap=31,ad=32,aI=852,bf=592,bg=15,aa=bg,ac=!0;aJ.inflateReset=an,aJ.inflateReset2=au,aJ.inflateResetKeep=ao,aJ.inflateInit=aB,aJ.inflateInit2=ax,aJ.inflate=aK,aJ.inflateEnd=al,aJ.inflateGetHeader=aG,aJ.inflateSetDictionary=aH,aJ.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(A,v,x){var m=A("../utils/common"),g=15,b=852,B=592,c=0,k=1,p=2,w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],q=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],z=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(ae,ao,ar,ap,aq,an,ak,aa){var aj,ab,al,V,X,Q,ah,l,ad,ai=aa.bits,d=0,n=0,ag=0,s=0,r=0,af=0,W=0,f=0,h=0,ac=0,G=null,Y=0,am=new m.Buf16(g+1),J=new m.Buf16(g+1),u=null,o=0;for(d=0;d<=g;d++){am[d]=0}for(n=0;n<ap;n++){am[ao[ar+n]]++}for(r=ai,s=g;s>=1&&0===am[s];s--){}if(r>s&&(r=s),0===s){return aq[an++]=20971520,aq[an++]=20971520,aa.bits=1,0}for(ag=1;ag<s&&0===am[ag];ag++){}for(r<ag&&(r=ag),f=1,d=1;d<=g;d++){if(f<<=1,f-=am[d],f<0){return -1}}if(f>0&&(ae===c||1!==s)){return -1}for(J[1]=0,d=1;d<g;d++){J[d+1]=J[d]+am[d]}for(n=0;n<ap;n++){0!==ao[ar+n]&&(ak[J[ao[ar+n]]++]=n)}if(ae===c?(G=u=ak,Q=19):ae===k?(G=w,Y-=257,u=q,o-=257,Q=256):(G=y,u=z,Q=-1),ac=0,n=0,d=ag,X=an,af=r,W=0,al=-1,h=1<<r,V=h-1,ae===k&&h>b||ae===p&&h>B){return 1}for(;;){ah=d-W,ak[n]<Q?(l=0,ad=ak[n]):ak[n]>Q?(l=u[o+ak[n]],ad=G[Y+ak[n]]):(l=96,ad=0),aj=1<<d-W,ab=1<<af,ag=ab;do{ab-=aj,aq[X+(ac>>W)+ab]=ah<<24|l<<16|ad|0}while(0!==ab);for(aj=1<<d-1;ac&aj;){aj>>=1}if(0!==aj?(ac&=aj-1,ac+=aj):ac=0,n++,0===--am[d]){if(d===s){break}d=ao[ar+ak[n]]}if(d>r&&(ac&V)!==al){for(0===W&&(W=r),X+=ag,af=d-W,f=1<<af;af+W<s&&(f-=am[af+W],!(f<=0));){af++,f<<=1}if(h+=1<<af,ae===k&&h>b||ae===p&&h>B){return 1}al=ac&V,aq[al]=r<<24|af<<16|X-an|0}}return 0!==ac&&(aq[X+ac]=d-W<<24|64<<16|0),aa.bits=r,0}},{"../utils/common":3}],13:[function(c,d,b){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(aU,be,bi){function a9(b){for(var c=b.length;--c>=0;){b[c]=0}}function a3(d,f,b,c,g){this.static_tree=d,this.extra_bits=f,this.extra_base=b,this.elems=c,this.max_length=g,this.has_stree=d&&d.length}function aX(b,c){this.dyn_tree=b,this.max_code=0,this.stat_desc=c}function aV(b){return b<256?aI[b]:aI[256+(b>>>7)]}function a1(b,c){b.pending_buf[b.pending++]=255&c,b.pending_buf[b.pending++]=c>>>8&255}function a5(c,d,b){c.bi_valid>ad-b?(c.bi_buf|=d<<c.bi_valid&65535,a1(c,c.bi_buf),c.bi_buf=d>>ad-c.bi_valid,c.bi_valid+=b-ad):(c.bi_buf|=d<<c.bi_valid&65535,c.bi_valid+=b)}function ba(c,d,b){a5(c,b[2*d],b[2*d+1])}function bf(c,d){var b=0;do{b|=1&c,c>>>=1,b<<=1}while(--d>0);return b>>>1}function bd(b){16===b.bi_valid?(a1(b,b.bi_buf),b.bi_buf=0,b.bi_valid=0):b.bi_valid>=8&&(b.pending_buf[b.pending++]=255&b.bi_buf,b.bi_buf>>=8,b.bi_valid-=8)}function bj(E,x){var B,q,m,g,F,k,p=x.dyn_tree,v=x.max_code,y=x.stat_desc.static_tree,w=x.stat_desc.has_stree,C=x.stat_desc.extra_bits,D=x.stat_desc.extra_base,z=x.stat_desc.max_length,A=0;for(g=0;g<=ac;g++){E.bl_count[g]=0}for(p[2*E.heap[E.heap_max]+1]=0,B=E.heap_max+1;B<ay;B++){q=E.heap[B],g=p[2*p[2*q+1]+1]+1,g>z&&(g=z,A++),p[2*q+1]=g,q>v||(E.bl_count[g]++,F=0,q>=D&&(F=C[q-D]),k=p[2*q],E.opt_len+=k*(g+F),w&&(E.static_len+=k*(y[2*q+1]+F)))}if(0!==A){do{for(g=z-1;0===E.bl_count[g];){g--}E.bl_count[g]--,E.bl_count[g+1]+=2,E.bl_count[z]--,A-=2}while(A>0);for(g=z;0!==g;g--){for(q=E.bl_count[g];0!==q;){m=E.heap[--B],m>v||(p[2*m+1]!==g&&(E.opt_len+=(g-p[2*m+1])*p[2*m],p[2*m+1]=g),q--)}}}}function aS(d,h,b){var c,l,g=new Array(ac+1),f=0;for(c=1;c<=ac;c++){g[c]=f=f+b[c-1]<<1}for(l=0;l<=h;l++){var k=d[2*l+1];0!==k&&(d[2*l]=bf(g[k]++,k))}}function bg(){var d,h,b,c,g,f=new Array(ac+1);for(b=0,c=0;c<ar-1;c++){for(ak[c]=b,d=0;d<1<<aZ[c];d++){a2[b++]=c}}for(a2[b-1]=c,g=0,c=0;c<16;c++){for(aG[c]=g,d=0;d<1<<ah[c];d++){aI[g++]=c}}for(g>>=7;c<ab;c++){for(aG[c]=g<<7,d=0;d<1<<ah[c]-7;d++){aI[256+g++]=c}}for(h=0;h<=ac;h++){f[h]=0}for(d=0;d<=143;){ax[2*d+1]=8,d++,f[8]++}for(;d<=255;){ax[2*d+1]=9,d++,f[9]++}for(;d<=279;){ax[2*d+1]=7,d++,f[7]++}for(;d<=287;){ax[2*d+1]=8,d++,f[8]++}for(aS(ax,am+1,f),d=0;d<ab;d++){aJ[2*d+1]=5,aJ[2*d]=bf(d,5)}aT=new a3(ax,aZ,ap+1,am,ac),aL=new a3(aJ,ah,0,ab,ac),aF=new a3(new Array(0),aH,0,aY,au)}function bh(b){var c;for(c=0;c<am;c++){b.dyn_ltree[2*c]=0}for(c=0;c<ab;c++){b.dyn_dtree[2*c]=0}for(c=0;c<aY;c++){b.bl_tree[2*c]=0}b.dyn_ltree[2*al]=1,b.opt_len=b.static_len=0,b.last_lit=b.matches=0}function bb(b){b.bi_valid>8?a1(b,b.bi_buf):b.bi_valid>0&&(b.pending_buf[b.pending++]=b.bi_buf),b.bi_buf=0,b.bi_valid=0}function a4(d,f,b,c){bb(d),c&&(a1(d,b),a1(d,~b)),ao.arraySet(d.pending_buf,d.window,f,b,d.pending),d.pending+=b}function aQ(d,g,b,c){var h=2*g,f=2*b;return d[h]<d[f]||d[h]===d[f]&&c[g]<=c[b]}function a0(d,f,b){for(var c=d.heap[b],g=b<<1;g<=d.heap_len&&(g<d.heap_len&&aQ(f,d.heap[g+1],d.heap[g],d.depth)&&g++,!aQ(f,c,d.heap[g],d.depth));){d.heap[b]=d.heap[g],b=g,g<<=1}d.heap[b]=c}function aR(f,h,b){var c,m,g,l,k=0;if(0!==f.last_lit){do{c=f.pending_buf[f.d_buf+2*k]<<8|f.pending_buf[f.d_buf+2*k+1],m=f.pending_buf[f.l_buf+k],k++,0===c?ba(f,m,h):(g=a2[m],ba(f,g+ap+1,h),l=aZ[g],0!==l&&(m-=ak[g],a5(f,m,l)),c--,g=aV(c),ba(f,g,b),l=ah[g],0!==l&&(c-=aG[g],a5(f,c,l)))}while(k<f.last_lit)}ba(f,al,h)}function a6(q,m){var p,g,d,b=m.dyn_tree,u=m.stat_desc.static_tree,c=m.stat_desc.has_stree,f=m.stat_desc.elems,k=-1;for(q.heap_len=0,q.heap_max=ay,p=0;p<f;p++){0!==b[2*p]?(q.heap[++q.heap_len]=k=p,q.depth[p]=0):b[2*p+1]=0}for(;q.heap_len<2;){d=q.heap[++q.heap_len]=k<2?++k:0,b[2*d]=1,q.depth[d]=0,q.opt_len--,c&&(q.static_len-=u[2*d+1])}for(m.max_code=k,p=q.heap_len>>1;p>=1;p--){a0(q,b,p)}d=f;do{p=q.heap[1],q.heap[1]=q.heap[q.heap_len--],a0(q,b,1),g=q.heap[1],q.heap[--q.heap_max]=p,q.heap[--q.heap_max]=g,b[2*d]=b[2*p]+b[2*g],q.depth[d]=(q.depth[p]>=q.depth[g]?q.depth[p]:q.depth[g])+1,b[2*p+1]=b[2*g+1]=d,q.heap[1]=d++,a0(q,b,1)}while(q.heap_len>=2);q.heap[--q.heap_max]=q.heap[1],bj(q,m),aS(b,k,q.bl_count)}function aO(q,m,p){var g,d,b=-1,u=m[1],c=0,f=7,k=4;for(0===u&&(f=138,k=3),m[2*(p+1)+1]=65535,g=0;g<=p;g++){d=u,u=m[2*(g+1)+1],++c<f&&d===u||(c<k?q.bl_tree[2*d]+=c:0!==d?(d!==b&&q.bl_tree[2*d]++,q.bl_tree[2*ae]++):c<=10?q.bl_tree[2*aM]++:q.bl_tree[2*bc]++,c=0,b=d,0===u?(f=138,k=3):d===u?(f=6,k=3):(f=7,k=4))}}function aP(q,l,p){var h,g,b=-1,u=l[1],c=0,m=7,k=4;for(0===u&&(m=138,k=3),h=0;h<=p;h++){if(g=u,u=l[2*(h+1)+1],!(++c<m&&g===u)){if(c<k){do{ba(q,g,q.bl_tree)}while(0!==--c)}else{0!==g?(g!==b&&(ba(q,g,q.bl_tree),c--),ba(q,ae,q.bl_tree),a5(q,c-3,2)):c<=10?(ba(q,aM,q.bl_tree),a5(q,c-3,3)):(ba(q,bc,q.bl_tree),a5(q,c-11,7))}c=0,b=g,0===u?(m=138,k=3):g===u?(m=6,k=3):(m=7,k=4)}}}function aN(b){var c;for(aO(b,b.dyn_ltree,b.l_desc.max_code),aO(b,b.dyn_dtree,b.d_desc.max_code),a6(b,b.bl_desc),c=aY-1;c>=3&&0===b.bl_tree[2*a7[c]+1];c--){}return b.opt_len+=3*(c+1)+5+5+4,c}function aD(d,f,b,c){var g;for(a5(d,f-257,5),a5(d,b-1,5),a5(d,c-4,4),g=0;g<c;g++){a5(d,d.bl_tree[2*a7[g]+1],3)}aP(d,d.dyn_ltree,f-1),aP(d,d.dyn_dtree,b-1)}function ai(c){var d,b=4093624447;for(d=0;d<=31;d++,b>>>=1){if(1&b&&0!==c.dyn_ltree[2*d]){return aB}}if(0!==c.dyn_ltree[18]||0!==c.dyn_ltree[20]||0!==c.dyn_ltree[26]){return av}for(d=32;d<ap;d++){if(0!==c.dyn_ltree[2*d]){return av}}return aB}function aA(b){aW||(bg(),aW=!0),b.l_desc=new aX(b.dyn_ltree,aT),b.d_desc=new aX(b.dyn_dtree,aL),b.bl_desc=new aX(b.bl_tree,aF),b.bi_buf=0,b.bi_valid=0,bh(b)}function aE(d,f,b,c){a5(d,(ag<<1)+(c?1:0),3),a4(d,f,b,!0)}function aa(b){a5(b,az<<1,3),ba(b,al,ax),bd(b)}function aj(d,h,b,c){var k,g,f=0;d.level>0?(d.strm.data_type===af&&(d.strm.data_type=ai(d)),a6(d,d.l_desc),a6(d,d.d_desc),f=aN(d),k=d.opt_len+3+7>>>3,g=d.static_len+3+7>>>3,g<=k&&(k=g)):k=g=b+5,b+4<=k&&h!==-1?aE(d,h,b,c):d.strategy===an||g===k?(a5(d,(az<<1)+(c?1:0),3),aR(d,ax,aJ)):(a5(d,(aq<<1)+(c?1:0),3),aD(d,d.l_desc.max_code+1,d.d_desc.max_code+1,f+1),aR(d,d.dyn_ltree,d.dyn_dtree)),bh(d),c&&bb(d)}function aC(c,d,b){return c.pending_buf[c.d_buf+2*c.last_lit]=d>>>8&255,c.pending_buf[c.d_buf+2*c.last_lit+1]=255&d,c.pending_buf[c.l_buf+c.last_lit]=255&b,c.last_lit++,0===d?c.dyn_ltree[2*b]++:(c.matches++,d--,c.dyn_ltree[2*(a2[b]+ap+1)]++,c.dyn_dtree[2*aV(d)]++),c.last_lit===c.lit_bufsize-1}var ao=aU("../utils/common"),an=4,aB=0,av=1,af=2,ag=0,az=1,aq=2,aw=3,a8=258,ar=29,ap=256,am=ap+1+ar,ab=30,aY=19,ay=2*am+1,ac=15,ad=16,au=7,al=256,ae=16,aM=17,bc=18,aZ=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ah=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],aH=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],a7=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],aK=512,ax=new Array(2*(am+2));a9(ax);var aJ=new Array(2*ab);a9(aJ);var aI=new Array(aK);a9(aI);var a2=new Array(a8-aw+1);a9(a2);var ak=new Array(ar);a9(ak);var aG=new Array(ab);a9(aG);var aT,aL,aF,aW=!1;bi._tr_init=aA,bi._tr_stored_block=aE,bi._tr_flush_block=aj,bi._tr_tally=aC,bi._tr_align=aa},{"../utils/common":3}],15:[function(d,f,b){function c(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}f.exports=c},{}],"/":[function(d,h,b){var c=d("./lib/utils/common").assign,l=d("./lib/deflate"),g=d("./lib/inflate"),f=d("./lib/zlib/constants"),k={};c(k,l,g,f),h.exports=k},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});gameclass.csvmgr=cc.Class.extend({csv_item:[],ctor:function(){},init:function(){this.initCsv("res/csv/item.csv",this.csv_item)},CSVToArray:function(e,g){g=(g||",");var f=new RegExp(("(\\"+g+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+g+"\\r\\n]*))"),"gi");var b=[[]];var d=null;while(d=f.exec(e)){var a=d[1];if(a.length&&(a!=g)){b.push([])}if(d[2]){var c=d[2].replace(new RegExp('""',"g"),'"')}else{var c=d[3]}b[b.length-1].push(c)}return b},initCsv:function(b,a){var c=this;cc.loader.loadTxt(b,function(g,k){if(g){cc.log(g);return}var d=c.CSVToArray(k,",");for(var f=1;f<d.length;f++){var h=d[f];for(var e=0;e<h.length;e++){a[d[f][0]+"_"+d[0][e]]=d[f][e]}}cc.log(a)})}});var getcsvmgr=new gameclass.csvmgr();(function(){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";var d=new Uint8Array(256);for(var b=0;b<c.length;b++){d[c.charCodeAt(b)]=b}var a={decoder:function(n){var f=n.length*0.75,o=n.length,m,h=0,k,g,e,r;if(n[n.length-1]==="="){f--;if(n[n.length-2]==="="){f--}}var l=new ArrayBuffer(f),q=new Uint8Array(l);for(m=0;m<o;m+=4){k=d[n.charCodeAt(m)];g=d[n.charCodeAt(m+1)];e=d[n.charCodeAt(m+2)];r=d[n.charCodeAt(m+3)];q[h++]=(k<<2)|(g>>4);q[h++]=((g&15)<<4)|(e>>2);q[h++]=((e&3)<<6)|(r&63)}return l},encoder:function(k){var g=new Uint8Array(k),h,e=g.length,f="";for(h=0;h<e;h+=3){f+=c[g[h]>>2];f+=c[((g[h]&3)<<4)|(g[h+1]>>4)];f+=c[((g[h+1]&15)<<2)|(g[h+2]>>6)];f+=c[g[h+2]&63]}if((e%3)===2){f=f.substring(0,f.length-1)+"="}else{if(e%3===1){f=f.substring(0,f.length-2)+"=="}}return f}};window.BASE64=a})();var Bytes2Str=function(c){if(typeof c==="string"){return c}var d="",e=c;for(var a=0;a<e.length;a++){var b=e[a].toString(2),h=b.match(/^1+?(?=0)/);if(h&&b.length==8){var f=h[0].length;var g=e[a].toString(2).slice(7-f);for(var k=1;k<f;k++){g+=e[k+a].toString(2).slice(2)}d+=String.fromCharCode(parseInt(g,2));a+=f-1}else{d+=String.fromCharCode(e[a])}}return d};var shareKey="e32c36ea311bff152efc73508b6fd8f8";var RequestURL=function(a,b){var c=cc.loader.getXMLHttpRequest();c.open("GET",a);c.onreadystatechange=function(){if(c.readyState==4&&(c.status>=200&&c.status<=207)){var d=c.statusText;b(c.responseText)}};c.send()};var PostURL=function(b,d,c,e,a){var f=cc.loader.getXMLHttpRequest();f.open("POST",b);f.setRequestHeader("Content-Type","text/plain;charset=UTF-8");f.otherdata=e;f.onreadystatechange=function(){if(f.readyState==4&&(f.status>=200&&f.status<=207)){var l=f.statusText;var h=f.response;cc.log("解析sssssssssss",h);var k=JSON.parse(h);var g=JSON.parse(k.msgsign);if(g.encode&&g.encode==1){var n=new Uint8Array(BASE64.decoder(k.msgdata));k.msgdata=Bytes2Str(pako.inflate(n))}var m=JSON.parse(k.msgdata);cc.log("hpptPosResponse----->msgHead:"+k.msghead+"||msgData="+k.msgdata);c(h,f.otherdata)}else{if(a!=null){a(f.otherdata)}}};f.send(d)};var GetURLPHP=function(b,c,a){var d=cc.loader.getXMLHttpRequest();cc.log("httpGet----->url:"+b);d.open("GET",b);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.onreadystatechange=function(){if(d.readyState==4&&(d.status>=200&&d.status<=207)){var f=d.statusText;var e=d.response;cc.log("getPhpGetData---->"+e.toString());c(e)}else{if(a!=null){a()}}};d.send()};var PostURLPHP=function(b,d,c,e,a){var f=cc.loader.getXMLHttpRequest();cc.log("httpPos----->url:"+b+"**************data---->"+d.toString());f.open("POST",b);f.setRequestHeader("Content-Type","application/x-www-form-urlencoded");f.otherdata=e;f.onreadystatechange=function(){if(f.readyState==4&&(f.status>=200&&f.status<=207)){var h=f.statusText;var g=f.response;cc.log("getPhpPostData---->"+g.toString());c(g,f.otherdata)}else{if(a!=null){a(f.otherdata)}}};f.send(d)};var getwebsocket=function(a,b,f,e,d){this._wsiError=null;this._wsiError=new WebSocket(a);this._wsiError.binaryType="arraybuffer";var c=this._wsiError;this._wsiError.onopen=function(g){if(b!=null){b(g,c)}};this._wsiError.onmessage=function(g){var h=new Base64();if(f!=null){f(g,c,h.decode(g.data))}};this._wsiError.onerror=function(g){cc.log("Error was fired");if(e!=null){e(g,c)}};this._wsiError.onclose=function(g){cc.log("_wsiError websocket instance closed.");if(d!=null){d(g,c)}};return this._wsiError};var wsSendData=function(a,e,d,b){var c=getdatapacket(e,d,b);a.send(c.buffer)};gameclass.websocket=cc.Class.extend({url:null,openfunc:null,onmsgfunc:null,onerrorfunc:null,onclosefunc:null,ws:null,curservrtime:null,curclienttime:null,game:null,ctor:function(){this.curservrtime=0;this.curclienttime=0},setgame:function(a){this.game=a}});gameclass.websocket.prototype.getcurservertime=function(){return this.curservrtime+(Math.floor(new Date().getTime()/1000)-this.curclienttime)};gameclass.websocket.prototype.init=function(a,b,e,d,c){this.url=a;this.openfunc=b;this.onmsgfunc=e;this.onerrorfunc=d;this.onclosefunc=c;this.ws=null;cc.log("create webSocket,url="+this.url);this.ws=new WebSocket(this.url);this.ws.binaryType="arraybuffer";var f=this;this.ws.onopen=function(g){if(f.openfunc!=null){f.openfunc(f,g)}};this.ws.onmessage=function(h){if(f.onmsgfunc!=null){var m=new Uint8Array(h.data);var n=Bytes2Str(m);var k=JSON.parse(n);var g=JSON.parse(k.msgsign);f.curservrtime=g.time;f.curclienttime=Math.floor(new Date().getTime()/1000);if(g.encode&&g.encode==1){var l=new Uint8Array(BASE64.decoder(k.msgdata));k.msgdata=Bytes2Str(pako.inflate(l))}cc.log(k.msgdata);cc.log(k);if(k.msghead=="err"){var l=JSON.parse(k.msgdata);if(l.info.length>0){f.game.uimgr.closeui("gameclass.inputcode2");f.game.uimgr.showui("gameclass.msgboxui");f.game.uimgr.uis["gameclass.msgboxui"].setString(l.info)}}else{if(k.msghead=="updcard"){var l=JSON.parse(k.msgdata);f.game.modmgr.mod_login.logindata.card=l.card;if(f.game.uimgr.uis["gameclass.hallui"]!=null){f.game.uimgr.uis["gameclass.hallui"].update()}}else{k.msgdata=JSON.parse(k.msgdata);cc.log("getMsg----->msgHead:"+k.msghead+"||msgData="+JSON.stringify(k.msgdata));f.onmsgfunc(f,k)}}}};this.ws.onerror=function(g){cc.log("Error was fired");if(f.onerrorfunc!=null){f.onerrorfunc(f,g,f.ws)}};this.ws.onclose=function(g){cc.log("_wsiError websocket instance closed.");if(f.onclosefunc!=null){f.onclosefunc(f,g)}};return this};gameclass.websocket.prototype.setonmsgfunc=function(a){this.onmsgfunc=a};gameclass.websocket.prototype._send=function(a){this.ws.send(a)};gameclass.websocket.prototype.send=function(b,d){var a={msghead:b,msgdata:JSON.stringify(d)};var c=JSON.stringify(a);cc.log("sendMsg----->"+b+"||data="+c);this._send(c)};gameclass.newwebsocket=function(a,b,e,d,h,g,f){var c=new gameclass.websocket;c.setgame(a);if(e!=null){e(c)}c.init(b,d,h,g,f);return c};gameclass.servertype=2;gameclass.clientver=2000;gameclass.version="1008";gameclass.gameniuniu=1;gameclass.gameddz=6;gameclass.gameszp=7;gameclass.gamelzddz=8;gameclass.gamesdb=10;gameclass.gamechg=11;gameclass.gamettz=17;gameclass.gameptj=19;gameclass.gamehlgc=185;gameclass.gamegoldkwx=10000;gameclass.gamelyc=64;gameclass.gamesaolei=36;gameclass.gamewolong=130;gameclass.mapinfo=null;gameclass.battery=100;gameclass.area=0;var setservertype=function(a){gameclass.servertype=a;if(gameclass.servertype==1){gameclass.baseurl="47.104.76.131:8031";gameclass.imgurl="image.hbyouyou.com/youyou.image/Index/proxyIcon"}else{if(gameclass.servertype==2){gameclass.baseurl="120.26.163.168:8031";gameclass.imgurl="image.hbyouyou.com/youyou.image/Index/proxyIcon"}}};setservertype(gameclass.servertype);gameclass.mod_base=cc.Class.extend({data:null,game:null,ctor:function(){this._super()},setgame:function(a){this.game=a},});gameclass.mod_base.prototype.getver=function(c,f,e,a){var b={msghead:c,msgdata:JSON.stringify(f)};var d=JSON.stringify(b);cc.log("httpPos----->url:"+gameclass.baseurl+"||head:"+c+"||data="+d);var g=this;PostURL("http://"+gameclass.baseurl+"/versionmsg","",function(k){if(e!=null){var h=Number(k);if(h<gameclass.clientver){}e(h<gameclass.clientver,a)}})};gameclass.mod_base.prototype.agentPostRequest=function(c,e,g,f,a){c=c+e;var b="";for(var d in g){b=b+d+"="+g[d]+"&"}if(b!=""){b=b.substr(0,b.length-1)}var h=this;PostURLPHP(c,b,function(l){if(f!=null){var k={};if(l!=""){k=JSON.parse(l)}f(k)}})};gameclass.mod_base.prototype.sendhttp=function(d,g,f,a){var b={msghead:d,msgdata:JSON.stringify(g)};var e=JSON.stringify(b);cc.log("httpPos----->url:"+gameclass.baseurl+"||head:"+d+"||data="+e);var c="http://"+gameclass.baseurl+"/loginmsg?"+encodeURI("msgdata="+e);var h=this;PostURL(c,"",function(n){if(f!=null){var l=JSON.parse(n);var k=JSON.parse(l.msgsign);if(k.encode&&k.encode==1){var m=new Uint8Array(BASE64.decoder(l.msgdata));l.msgdata=Bytes2Str(pako.inflate(m))}if(l.msghead=="err"){h.game.uimgr.showui("gameclass.msgboxui");var m=JSON.parse(l.msgdata);if(m.info.toString()=="当前版本号过低，请下载最新版本进行游戏"){h.game.uimgr.uis["gameclass.msgboxui"].setString(m.info,function(){gameclass.mod_platform.openurl(gameclass.download)})}else{h.game.uimgr.uis["gameclass.msgboxui"].setString(m.info)}}else{cc.log("httpGet--->"+l.msgdata.toString());f(JSON.parse(l.msgdata),"",l)}}})};gameclass.mod_base.loadicon=function(a,c,b){if(!cc.sys.isNative){if(gameclass.servertype==1){a="http://"+gameclass.imgurl+"/getimage?size=96x96&img="+encodeURI(a)}else{if(gameclass.servertype==2){a="res/ui/common/zhanji/userinfo_head.png"}}}else{}b.retain();cc.loader.loadImg(a,{isCrossOrigin:true},function(e,d){if(typeof(d)!="undefined"&&d!=null&&c!=null){if(!cc.sys.isNative){var f=new cc.Texture2D();f.initWithElement(d);f.handleLoadedTexture();c(f,b)}else{c(d,b)}}else{if(typeof(e)!="undefined"){}}b.release()})};gameclass.mod_base.deepCopy=function(d){var a=null;if(d instanceof Array){a=[];for(var b=0;b<d.length;b++){if(d[b] instanceof Array||d[b] instanceof Object){var c=this.deepCopy(d[b]);a[b]=c}else{a[b]=d[b]}}}else{if(d instanceof Object){a={};for(var b in d){if(d[b] instanceof Array||d[b] instanceof Object){var c=this.deepCopy(d[b]);a[b]=c}else{a[b]=d[b]}}}else{a=d}}return a};gameclass.mod_base.cliper=function(a){var c=new cc.Sprite();c.initWithFile(a);var b=new cc.ClippingNode();b.attr({stencil:c,anchorX:0.5,anchorY:0.5,alphaThreshold:0.8,});b.setCascadeOpacityEnabled(true);b.setPosition(cc.p(c.getContentSize().width,c.getContentSize().height));return b};gameclass.mod_base.createGraySprite=function(s,n){var k=(typeof document!=="undefined");if(k){var d=document.createElement("canvas");var q=n.getHtmlElementObj();d.width=q.width;d.height=q.height;if(d.getContext){var c=d.getContext("2d");c.drawImage(q,0,0);var h=c.getImageData(0,0,d.width,d.height);for(var f=0;f<h.width;f++){for(var e=0;e<h.height;e++){var o=(f+e*h.width)*4;var p=h.data[o+0];var t=h.data[o+1];var w=h.data[o+2];var u=0.299*p+0.587*t+0.114*w;h.data[o+0]=u;h.data[o+1]=u;h.data[o+2]=u;if(f<8||e<8||f>(h.width-8)||e>(h.height-8)){h.data[o+0]=0;h.data[o+1]=0;h.data[o+2]=0}}}c.putImageData(h,0,0);var l=new cc.Texture2D();l.initWithElement(d);l.handleLoadedTexture();s.initWithTexture(l);return}}if(!cc.GLProgram.createWithByteArrays){cc.GLProgram.createWithByteArrays=function(b,r){var g=new cc.GLProgram();g.initWithVertexShaderByteArray(b,r);g.link();g.updateUniforms();setTimeout(function(){g.link();g.updateUniforms()},0);return g}}var v="varying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\n"+(k?"uniform sampler2D CC_Texture0;\n":"")+"void main()\n{\n    vec4 v_orColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord);\n    float gray = dot(v_orColor.rgb, vec3(0.299, 0.587, 0.114));\n    gl_FragColor = vec4(gray, gray, gray, v_orColor.a);\n}\n";var m="attribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\n\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\n\nvoid main()\n{\ngl_Position = "+(k?"(CC_PMatrix * CC_MVMatrix)":"CC_PMatrix")+" * a_position;\nv_fragmentColor = a_color;\nv_texCoord = a_texCoord;\n}";s.initWithTexture(n);var a=cc.GLProgram.createWithByteArrays(m,v);a.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);a.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);a.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);s.setShaderProgram(a)};gameclass.mod_base.showtximg=function(f,d,b,h,c,a){if(d==""){d="http://wx.qlogo.cn/mmopen/FZcTPp6P4glCw8tGZriaicHicPPayNQ3gZE63UlcYiauWGrubicaIZdZDr7TG4KHibEicKlVP98bK81ZJeuiaEQkxazvVk5z9Sotrickic/0"}if(!c){c="im_headbg2"}if(!a){a=false}var e=gameclass.mod_base.cliper("res/"+c+".png");f.removeChildByTag(1231);f.addChild(e);e.setTag(1231);e.setAnchorPoint(cc.p(0,0));var g=new cc.Sprite();gameclass.mod_base.loadicon(d,function(k,m){var l=k.getContentSize();g.setScale(f.getContentSize().width/l.width);if(a){gameclass.mod_base.createGraySprite(m,k)}else{m.initWithTexture(k)}g.setAnchorPoint(cc.p(0.5,0.5));g.setPosition(cc.p(0,0));if(b!=null){e.setPosition(cc.p(f.getContentSize().width/2+b,f.getContentSize().height/2+h))}else{e.setPosition(cc.p(f.getContentSize().width/2,f.getContentSize().height/2))}},g);g.setAnchorPoint(cc.p(0.5,0.5));g.setPosition(cc.p(0,0));e.addChild(g);return e};gameclass.mod_userbase=gameclass.mod_base.extend({userbase:null,ctor:function(){}});gameclass.mod_userbase.prototype.setData=function(a){this.userbase=a};gameclass.mod_login=gameclass.mod_base.extend({data:null,logindata:null,roomdata:null,mod_game:null,islogin:null,ctor:function(){this.islogin=false}});gameclass.mod_login.prototype.getserverver=function(a){var b={};var c=this;this.getver("",b,function(f,e,d){a(f)})};gameclass.mod_login.prototype.guestlogin=function(a){if(a!=null&&a!=""){mod_userdefault.globaldata.code=a}var b={code:mod_userdefault.globaldata.code,ver:gameclass.clientver};var c=this;this.sendhttp("loginYK",b,function(f,e,d){if(d.msghead=="loginfail"){gameclass.servertype=2;gameclass.clientver=0;c.game.modmgr.mod_login.guestlogin(a)}else{c.logindata=f;mod_userdefault.globaldata.code=f.openid;mod_userdefault.writeglobaljson();if(f.room==0){c.game.uimgr.showui("gameclass.hallui")}else{c.jionroom(f.ip,f.room)}c.game.uimgr.closeui("gameclass.loginui");c.game.modmgr.mod_center.connect("ws://"+f.center)}})};gameclass.mod_login.prototype.wxlogin=function(b){var a=83;if(!cc.sys.isNative){a=1}var e="loginWX";if(mod_userdefault.globaldata.code!=""){b=mod_userdefault.globaldata.code;e="loginOP"}var c={code:b,type:a,ver:gameclass.clientver};var d=this;this.sendhttp(e,c,function(h,g,f){if(f.msghead=="loginfail"){gameclass.servertype=1;gameclass.clientver=0;d.game.modmgr.mod_login.guestlogin("")}else{d.logindata=h;if(mod_userdefault.globaldata.code!=h.openid){mod_userdefault.globaldata.code=h.openid;mod_userdefault.globaldata.time=(new Date()).getTime();mod_userdefault.writeglobaljson()}d.islogin=true;g_islogin=true;if(h.room==0){d.game.uimgr.showui("gameclass.hallui")}else{d.jionroom(h.ip,h.room)}d.game.uimgr.closeui("gameclass.loginui");d.game.modmgr.mod_center.connect("ws://"+h.center)}})};gameclass.mod_login.prototype.createroom=function(a,b,f,e,c){if(c==null){c=0}var d={uid:this.logindata.uid,type:a,num:b,param1:f,param2:e,agent:c};var g=this;this.sendhttp("create",d,function(h){if(h.agent){g.game.uimgr.showui("gameclass.msgboxui").setString("代开成功！");g.logindata.card=h.card;g.game.uimgr.uis["gameclass.hallui"].update()}else{g.jionroom(h.ip,h.room)}})};gameclass.mod_login.prototype.joinwithroomid=function(a){var b={uid:this.logindata.uid,roomid:Number(a),group:-1};var c=this;this.sendhttp("join",b,function(d){c.jionroom(d.ip,d.room)})};gameclass.mod_login.prototype.getroomlist=function(a){var b={uid:this.logindata.uid};this.sendhttp("getroomlist",b,function(c){a(c)})};gameclass.mod_login.prototype.jionroom=function(c,a,b){var d=this;if(b==null){b=5}this.getroominfo("ws://"+c,a,function(e,f){switch(f.msghead){case"roominfo":d.game.uimgr.showload(false);d.game.uimgr.closeallui(true);g_isgame=true;if(f.msgdata.type==gameclass.gameddz){d.createddz(f.msgdata,e)}else{if(f.msgdata.type==gameclass.gamelzddz){d.createddz_wild(f.msgdata,e)}else{if(f.msgdata.type==gameclass.gamehlgc){d.creathlgc(f.msgdata,e)}else{if(f.msgdata.type==gameclass.gamesaolei){d.createsaolei(f.msgdata,e)}else{if(f.msgdata.type==gameclass.gamewolong){d.createWoLong(f.msgdata,e)}else{e.onclosefunc=null;d.dissmissroom();d.game.uimgr.showui("gameclass.msgboxui");d.game.uimgr.uis["gameclass.msgboxui"].setString("您在房间中，请退出后重试")}}}}}break;case"joinroomfail":e.onclosefunc=null;d.dissmissroom();d.game.uimgr.showui("gameclass.msgboxui");switch(f.msgdata.result){case 1:d.game.uimgr.uis["gameclass.msgboxui"].setString("该房间已解散");break;case 2:d.game.uimgr.uis["gameclass.msgboxui"].setString("该房间已满员");break;default:d.game.uimgr.uis["gameclass.msgboxui"].setString("房间错误");break}break}})};gameclass.mod_login.prototype.getroominfo=function(d,a,b,c){var e=this;gameclass.newwebsocket(this.game,d,function(f){},function(f){var g={uid:e.logindata.uid,roomid:a,minfo:gameclass.mod_platform.getmapinfo()};f.send("joinroom",g)},function(f,g){b(f,g)},function(){cc.log("onerrorfunc")},function(){cc.log("onclosefunc");e.backlogin()})};gameclass.mod_login.prototype.createWoLong=function(c,a){var b=new gameclass.mod_wolong();this.mod_game=b;this.game.uimgr.showui("gameclass.wolongTable");this.game.uimgr.closeui("gameclass.hallui");this.game.uimgr.closeui("gameclass.jionroomui");b.view=this.game.uimgr.uis["gameclass.wolongTable"];this.game.uimgr.uis["gameclass.wolongTable"].bindMod(b,c);b.setgame(this.game);b.entergame(c,a)};gameclass.mod_login.prototype.createddz=function(c,b){var a=new gameclass.mod_ddzhu;this.game.uimgr.showui("gameclass.ddzhutable");this.game.uimgr.closeui("gameclass.hallui");this.game.uimgr.closeui("gameclass.jionroomui");a.setgame(this.game);a.entergame(c,b);this.game.uimgr.uis["gameclass.ddzhutable"].setmod(a);this.mod_game=a};gameclass.mod_login.prototype.createsaolei=function(c,b){var a=new gameclass.mod_minesweeping;this.game.uimgr.showui("gameclass.minesweepingtable",false,null,1);a.setgame(this.game);a.entergame(c,b);this.game.uimgr.uis["gameclass.minesweepingtable"].setmod(a);this.mod_game=a};gameclass.mod_login.prototype.createddz_wild=function(c,b){var a=new gameclass.mod_ddzhu;this.game.uimgr.showui("gameclass.ddzhutable_wild");this.game.uimgr.closeui("gameclass.hallui");this.game.uimgr.closeui("gameclass.jionroomui");a.setgame(this.game);a.entergame(c,b);this.game.uimgr.uis["gameclass.ddzhutable_wild"].setmod(a);this.mod_game=a};gameclass.mod_login.prototype.creathlgc=function(c,b){var a=new gameclass.mod_hlgc;this.game.uimgr.showui("gameclass.hlgc.Table");this.game.uimgr.closeui("gameclass.hallui");this.game.uimgr.closeui("gameclass.jionroomui");a.setgame(this.game);a.entergame(c,b);this.game.uimgr.uis["gameclass.hlgc.Table"].setmod(a);this.mod_game=a};gameclass.mod_login.prototype.dissmissroom=function(){g_isgame=false;g_will_room=0;this.game.uimgr.closeui("gameclass.niuniutable");this.game.uimgr.closeui("gameclass.zjhtable");this.game.uimgr.closeui("gameclass.ddzhutable");this.game.uimgr.closeui("gameclass.ddzhutable_wild");this.game.uimgr.closeui("gameclass.sdbtable");this.game.uimgr.closeui("gameclass.hlgc.Table");this.game.uimgr.closeui("gameclass.lyctable");this.game.uimgr.showui("gameclass.hallui")};gameclass.mod_login.prototype.backlogin=function(){g_isgame=false;g_islogin=false;g_will_room=0;this.game.uimgr.closeui("gameclass.niuniutable");this.game.uimgr.closeui("gameclass.zjhtable");this.game.uimgr.closeui("gameclass.ddzhutable");this.game.uimgr.closeui("gameclass.ddzhutable_wild");this.game.uimgr.closeui("gameclass.lyctable");this.game.uimgr.showui("gameclass.loginui")};gameclass.mod_login.prototype.getfirstgame=function(){return this.mod_game};var mod_userdefault={};mod_userdefault.init=function(){mod_userdefault.userdata={};mod_userdefault.globaldata={};mod_userdefault.globaldata.code="";mod_userdefault.globaldata.time=(new Date()).getTime()};mod_userdefault.init();mod_userdefault.writeglobaljson=function(){cc.sys.localStorage.setItem("global",JSON.stringify(mod_userdefault.globaldata))};mod_userdefault.clone2=function(a,c){var d=a;for(var b in a){if(c[b]!=null){if(typeof(c[b])=="object"){d[b]=mod_userdefault.clone2(a[b],c[b])}else{d[b]=c[b]}}}return d};mod_userdefault.readglobaljson=function(){var a=cc.sys.localStorage.getItem("global");if(a==null||a.length==0){return}mod_userdefault.globaldata=JSON.parse(cc.sys.localStorage.getItem("global"));mod_userdefault.Initglobaldata()};mod_userdefault.Initglobaldata=function(){if(!mod_userdefault.globaldata.hasOwnProperty("autologin")){mod_userdefault.globaldata.autologin=true}if(!mod_userdefault.globaldata.hasOwnProperty("savepassword")){mod_userdefault.globaldata.savepassword=true}};mod_userdefault.readglobaljson();gameclass.mod_platform={};gameclass.mod_platform.game=null;gameclass.mod_platform.loginwx=function(){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","loginwx","(Ljava/lang/String;)V","")}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","LoginWx")}else{}}}}};gameclass.mod_platform.startmap=function(){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","StartMap")}else{}}}}};gameclass.mod_platform.getAddress=function(){var a=gameclass.mod_platform.getmapinfo();if(a==null||a==""){return""}var b=JSON.parse(a);return b.address};gameclass.mod_platform.getmapinfo=function(){if(!cc.sys.isNative){return""}else{if(gameclass.test=="true"){return""}if(cc.sys.os==sys.OS_ANDROID){return jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","getMapInfo","()Ljava/lang/String;")}else{if(cc.sys.os==sys.OS_IOS){return jsb.reflection.callStaticMethod("NativeOcClass","getMapInfo")}}}return""};gameclass.mod_platform.invitefriend=function(a,b,c){game.modmgr.mod_center.isclickPYQ=false;cc.log(a,b,c);if(!cc.sys.isNative){gameclass.mod_platform.wxshare(a,b,c)}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","InviteFriend","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",a.toString(),b.toString(),c.toString())}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","Invite:Roomid:Title:",a.toString(),b.toString(),c.toString())}else{}}}}};gameclass.mod_platform.invitefriendSpoons=function(a,b,c){game.modmgr.mod_center.isclickPYQ=true;if(!cc.sys.isNative){gameclass.mod_platform.wxshare(a,b,c)}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","InviteFriendSpoons","(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V",a.toString(),b.toString(),c.toString())}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","InviteSpoons:Roomid:Title:",a.toString(),b.toString(),c.toString())}else{}}}}};gameclass.mod_platform.copyStr=function(a){if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==cc.sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","copyStr","(Ljava/lang/String;)V",a.toString())}else{if(cc.sys.os==cc.sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","copyStr:",a.toString())}else{}}}};gameclass.mod_platform.begmic=function(){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","BeginMic","(Ljava/lang/String;)V",jsb.fileUtils.getWritablePath())}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","BegMic")}else{}}}}};gameclass.mod_platform.endmic=function(){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","EndMic","(Ljava/lang/String;)V",jsb.fileUtils.getWritablePath())}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","EndMic")}else{}}}}};gameclass.mod_platform.cancelmic=function(){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","CancelMic","(Ljava/lang/String;)V",jsb.fileUtils.getWritablePath())}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","CancelMic")}else{}}}}};gameclass.mod_platform.savescreen=function(e,k){if(!cc.sys.isNative){var b=cc.director.getWinSize();var g=document.getElementById("gameCanvas");var a=null;var f=function(){cc.eventManager.removeListener(a);if(k){k()}var n=g.toDataURL("image/png");var m={imgstr:n};var l=JSON.stringify(m);cc.log("hpptPos----->platform||data="+l);PostURL("http://game.hbyouyou.com/youyou.image/Index/uploadBase64Image",l,function(o){if(e!=null){e(o)}})};a=cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_DRAW,f)}else{var b=cc.director.getWinSize();var d=new cc.RenderTexture(b.width,b.height,cc.Texture2D.PIXEL_FORMAT_RGBA8888,gl.DEPTH24_STENCIL8_OES);d.setPosition(cc.p(b.width/2,b.height/2));d.begin();cc.director.getRunningScene().visit();d.end();var h="share.jpg";d.saveToFile(h,cc.IMAGE_FORMAT_JPEG);cc.log("images saved!");var c=cc.sequence(cc.delayTime(1),cc.callFunc(function(){if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","SharePic","(Ljava/lang/String;)V",jsb.fileUtils.getWritablePath()+h)}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","Share:",jsb.fileUtils.getWritablePath()+h)}else{}}}}));cc.director.getRunningScene().runAction(c)}};gameclass.mod_platform.outPutAndroidLog=function(a){if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==cc.sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","outPutAndroidLog","(Ljava/lang/String;)V",a.toString())}else{if(cc.sys.os==cc.sys.OS_IOS){}else{}}}};gameclass.mod_platform.onlogin=function(a){cc.log("gameclass.mod_platform.onlogin");game.modmgr.mod_login.wxlogin(a)};gameclass.mod_platform.guestlogin=function(a){cc.log("gameclass.mod_platform.guestlogin");game.modmgr.mod_login.guestlogin(a)};gameclass.mod_platform.onMessaegResp=function(){game.modmgr.mod_center.weixinShareOK()};gameclass.mod_platform.buy=function(){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","Buy")}else{}}}}};gameclass.mod_platform.onbuy=function(a){gameclass.mod_platform.game.modmgr.mod_center.iospay(a)};gameclass.mod_platform.onlog=function(a){gameclass.mod_platform.game.uimgr.showui("gameclass.msgboxui");gameclass.mod_platform.game.uimgr.uis["gameclass.msgboxui"].setString(a)};gameclass.mod_platform.wxshare=function(a,c,e){if(window.wx){cc.log(a);cc.log(c);cc.log(e);var d="wxe29f6e4668070234";var b="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+d+"&redirect_uri=http%3a%2f%2fcentre.hbyouyou.com%2fUser%2floginNiuniu&response_type=code&scope=snsapi_userinfo&connect_redirect=1#wechat_redirect";wx.onMenuShareAppMessage({title:e,desc:a,link:b,imgUrl:"http://game.hbyouyou.com/niuniu/icon.png",})}};gameclass.mod_platform.wxsharelink=function(a,c,b){if(window.wx){wx.onMenuShareAppMessage({title:c,desc:a,link:b,imgUrl:"http://game.hbyouyou.com/niuniu/icon.png",})}};gameclass.mod_platform.openurl=function(a){if(!cc.sys.isNative){}else{cc.Application.getInstance().openURL(a)}};gameclass.mod_platform.upsoundok=function(a){if(gameclass.mod_platform.game){var b=gameclass.mod_platform.game.modmgr.mod_login.getfirstgame();if(b){b.chat(3,a)}}};gameclass.mod_platform.getBattery=function(a){if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){if(game.uimgr.uis["gameclass.hallui"]){return a}}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","getBattery:")}else{}}}},gameclass.mod_platform.playurl=function(a){if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","Playurl","(Ljava/lang/String;)V",a)}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","Playurl:",a)}else{}}}};gameclass.mod_platform.onios=function(){if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","OnIos")}else{}}}};gameclass.mod_platform.setbaseinfo=function(a){if(!cc.sys.isNative){}else{if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","SetBaseInfo","(Ljava/lang/String;)V",a.toString())}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","SetBaseInfo:",a.toString())}else{}}}}};gameclass.mod_platform.screenType=0;gameclass.mod_platform.swicthscreen=function(e){if(e===gameclass.mod_platform.screenType){return}else{gameclass.mod_platform.screenType=e}if(cc.sys.os==cc.sys.OS_WINDOWS){}else{if(cc.sys.os==sys.OS_ANDROID){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsCall","SwitchScreen","(I)V",e)}else{if(cc.sys.os==sys.OS_IOS){jsb.reflection.callStaticMethod("NativeOcClass","SwitchScreen:",e.toString())}else{}}}var c=cc.view.getFrameSize();cc.view.setFrameSize(c.height,c.width);if(e==0){if(cc.sys.isNative){cc.view.setDesignResolutionSize(1136,640,cc.ResolutionPolicy.EXACT_FIT)}else{cc.view.setDesignResolutionSize(1136,640,cc.ResolutionPolicy.SHOW_ALL)}}else{if(cc.sys.isNative){cc.view.setDesignResolutionSize(640,1136,cc.ResolutionPolicy.EXACT_FIT)}else{cc.view.setDesignResolutionSize(640,1136,cc.ResolutionPolicy.SHOW_ALL)}}return;if(e==0){var c=cc.director.getWinSize();if(c.width/c.height<1.4){cc.view.setDesignResolutionSize(1136,640,cc.ResolutionPolicy.SHOW_ALL)}else{var f=c.width/960;var a=c.height/640;var b=c.width;var d=c.height;if(f>=a){b=c.width*640/c.height;d=640}else{b=960;d=960*c.height/c.width}cc.view.setDesignResolutionSize(b,d,cc.ResolutionPolicy.NO_BORDER)}}else{cc.view.setDesignResolutionSize(640,1136,cc.ResolutionPolicy.SHOW_ALL)}};mod_compare={};mod_compare.TYPE_WUXIAONIU=400;mod_compare.TYPE_WUHUANIU=300;mod_compare.TYPE_4ZHA=200;mod_compare.TYPE_NIUNIU=100;mod_compare.TYPE_YOUNIU=90;mod_compare.TYPE_MEINIU=0;var ts=[72,13,112,74,33];mod_compare.gettypestr=function(b){b=mod_compare.cardsort(b);b=mod_compare.covertato1(b);var a=mod_compare.get_cardlisttype(b);if(a==mod_compare.TYPE_WUXIAONIU){return"五小牛"}else{if(a==mod_compare.TYPE_WUHUANIU){return"五花牛"}else{if(a==mod_compare.TYPE_4ZHA){return"4炸"}else{if(a==mod_compare.TYPE_NIUNIU){return"牛牛"}else{if(a>=mod_compare.TYPE_YOUNIU){return"牛"+(a-mod_compare.TYPE_YOUNIU)}}}}}return"没牛"};mod_compare.gettype=function(e,b){var h=[];for(var f=0;f<5;f++){h[f]=e[f]}h=mod_compare.cardsort(h);var a=mod_compare.covertato1(h);var d=[];var g=mod_compare.get_cardlisttype(a,d);for(var f=0;f<5;f++){for(var c=0;c<5;c++){if(e[f]==h[c]&&d[c]){b[f]=true;break}}}return g};mod_compare.cardsort=function(a){a=a.sort(function(d,c){return d<c});return a};mod_compare.covertato1=function(d){var a=[];for(var b=0;b<d.length;++b){var c=d[b]%10;var e=Math.floor(d[b]/10);a[b]={};a[b].t=c;a[b].p=e;a[b].card=d[b]}return a};mod_compare.is_5xiaoniu=function(b){for(var a=0;a<b.length;++a){if(b[a]["p"]>=5){return false}}if(b[0]["p"]+b[1]["p"]+b[2]["p"]+b[3]["p"]+b[4]["p"]<=10){return true}return false};mod_compare.is_5huaniu=function(b){for(var a=0;a<b.length;++a){if(b[a]["p"]<=10){return false}}return true};mod_compare.get_cardnumcount=function(a,d){var c=0;for(var b=0;b<d.length;++b){if(d[b]["p"]==a.p){c=c+1}}return c};mod_compare.is_4zha=function(e,a){var c=false;var b;if(e[0]["p"]==e[1]["p"]){b=e[0];c=mod_compare.get_cardnumcount(e[0],e)==4}else{b=e[1];c=mod_compare.get_cardnumcount(e[1],e)==4}if(c){for(var d=0;d<5;d++){if(b!=e[d]){a[d]=false}}}return c};mod_compare.is_niuniu=function(c){var a=0;for(var b=0;b<c.length;++b){if(c[b]["p"]>10){a+=10}else{a+=c[b]["p"]}}return a%10==0};mod_compare.is_youniu=function(e,a){var g=[];for(var f=0;f<e.length;++f){g[f]=e[f];if(g[f]["p"]>10){g[f]["p"]=10}}for(var d=0;d<3;++d){for(var c=d+1;c<4;++c){for(var b=c+1;b<5;++b){if((g[d]["p"]+g[c]["p"]+g[b]["p"])%10==0){a[d]=true;a[c]=true;a[b]=true;return true}}}}return false};mod_compare.get_cardlisttype=function(c,a){for(var b=0;b<5;b++){a[b]=true}if(mod_compare.is_5xiaoniu(c)){return mod_compare.TYPE_WUXIAONIU}if(mod_compare.is_5huaniu(c)){return mod_compare.TYPE_WUHUANIU}if(mod_compare.is_4zha(c,a)){return mod_compare.TYPE_4ZHA}for(var b=0;b<5;b++){a[b]=false}if(mod_compare.is_youniu(c,a)){if(mod_compare.is_niuniu(c)){for(var b=0;b<5;b++){a[b]=true}return mod_compare.TYPE_NIUNIU}else{return mod_compare.TYPE_YOUNIU+(c[0]["p"]+c[1]["p"]+c[2]["p"]+c[3]["p"]+c[4]["p"])%10}}for(var b=0;b<5;b++){a[b]=false}return mod_compare.TYPE_MEINIU};mod_compare.cmpsamecardtype=function(c,b){for(var a=0;a<5;++a){if(c[4-a]["p"]>b[4-a]["p"]){return true}if(c[4-a]["p"]<b[4-a]["p"]){return false}}for(var a=0;a<5;++a){if(c[4-a]["t"]>b[4-a]["t"]){return true}if(c[4-a]["t"]<b[4-a]["t"]){return false}}return false};mod_compare.compare=function(b,a){b=mod_compare.cardsort(b);a=mod_compare.cardsort(a);card1=mod_compare.covertato1(b);card2=mod_compare.covertato1(a);type1=mod_compare.get_cardlisttype(card1);type2=mod_compare.get_cardlisttype(card2);if(type1>type2){return true}if(type1==type2){return mod_compare.cmpsamecardtype(card1,card2)}else{return false}};mod_compare.isNiu=function(a){var c=0;for(var b=0;b<a.length;b++){if(parseInt(a[b]/10)>=10){c+=10;continue}c+=parseInt(a[b]/10)}if(c!=0&&c%10==0){cc.log("true");return true}cc.log("false");return false};mod_compare.countNiu=function(a){var c=0;for(var b=0;b<a.length;b++){if(parseInt(a[b]/10)>=10){c+=10;continue}c+=parseInt(a[b]/10)}if(c<10){return mod_compare.TYPE_YOUNIU+c}c=c%10;return mod_compare.TYPE_YOUNIU+c};mod_compare.tipsMeiNiu=function(b){var a=[];return a};mod_compare.tipsWHN_WXN=function(b){var a=[];for(var c=0;c<b.length;c++){a.push(b[c].card);if(a.length==3){return a}}return[]};mod_compare.tips4ZHA=function(b){var a=[];var d=0;for(var c=0;c<b.length-1;c++){if(b[c].p==b[c+1].p){d=b[c].p;break}}for(var c=0;c<b.length;c++){if(b[c].p==d){a.push(b[c].card)}if(a.length==3){return a}}return[]};mod_compare.tipsGetTenCount=function(a){var b=0;for(var c=0;c<a.length;c++){if(a[c].p>=10){b++}}return b};mod_compare.tipsNIUNIU=function(k){var l=[];var c=mod_compare.tipsGetTenCount(k);if(c==1){var e=false,h=false;for(var g=0;g<k.length;g++){for(var f=0;f<k.length;f++){if(k[g].p>=10&&!e){l.push(k[g].card);e=true}if(k[g].p+k[f].p==10&&g!=f&&!h){l.push(k[g].card);l.push(k[f].card);h=true}if(l.length==3){return l}}}}else{for(var d=0;d<3;++d){for(var b=d+1;b<4;++b){for(var a=b+1;a<5;++a){if((k[d].p+k[b].p+k[a].p)%10==0){l.push(k[d].card);l.push(k[b].card);l.push(k[a].card);return l}}}}}return[]};mod_compare.tipsNIUCount=function(c){var a=[];for(var e=0;e<3;++e){for(var d=e+1;d<4;++d){for(var b=d+1;b<5;++b){if((c[e].p+c[d].p+c[b].p)%10==0){a.push(c[e].card);a.push(c[d].card);a.push(c[b].card);return a}}}}};mod_compare.tipsMeiNiu=function(b){var a=[];a.push(b[0].card);a.push(b[1].card);a.push(b[2].card);return a};mod_compare.tipsNiu=function(d){cc.log(d);var b=[];d=mod_compare.cardsort(d);var c=mod_compare.covertato1(d);var e=mod_compare.get_cardlisttype(c,b);cc.log(e);var a=[];if(e==mod_compare.TYPE_MEINIU){a=mod_compare.tipsMeiNiu(c)}else{if(e==mod_compare.TYPE_WUXIAONIU||e==mod_compare.TYPE_WUHUANIU){a=mod_compare.tipsWHN_WXN(c)}else{if(e==mod_compare.TYPE_4ZHA){a=mod_compare.tips4ZHA(c)}else{if(e==mod_compare.TYPE_NIUNIU){a=mod_compare.tipsNIUNIU(c)}else{if(e>90&&e<100){a=mod_compare.tipsNIUCount(c)}else{if(e==mod_compare.TYPE_MEINIU){a=mod_compare.tipsMeiNiu(c)}}}}}}return a};gameclass.mod_center=gameclass.mod_base.extend({data:null,ip:null,gonggao:null,areainfo:null,notice:null,hasread:null,shareOK:"lvhaoshuai",isclickPYQ:false,ctor:function(){this.gonggao=""},setgame:function(a){this.game=a},});gameclass.mod_center.prototype.connect=function(a){if(this.ip==null){this.ip=a}else{return}var b=this;gameclass.newwebsocket(this.game,a,function(c){},function(c){gameclass.mapinfo=gameclass.mod_platform.getmapinfo();var d={uid:b.game.modmgr.mod_login.logindata.uid,openid:b.game.modmgr.mod_login.logindata.openid,mapinfo:gameclass.mapinfo,group:1};c.send("setuid",d);b.mywebsocket=c},function(c,d){if(d.msghead=="notice"){b.gonggao=d.msgdata.context;if(b.game.uimgr.uis["gameclass.hallui"]!=null){b.game.uimgr.uis["gameclass.hallui"].updategonggao()}}else{if(d.msghead=="areainfo"){b.areainfo=JSON.parse(d.msgdata.context);if(b.game.uimgr.uis["gameclass.hallui"]!=null){b.game.uimgr.uis["gameclass.hallui"].updateareainfo()}}else{if(d.msghead=="noticeinfo"){b.notice=d.msgdata.info;b.hasread=d.msgdata.read;if(b.game.uimgr.uis["gameclass.hallui"]!=null){b.game.uimgr.uis["gameclass.hallui"].updateMailPoint()}}else{if(d.msghead=="joingoldfail"){b.game.uimgr.showui("gameclass.msgboxui");b.game.uimgr.uis["gameclass.msgboxui"].setString("金币不足")}else{if(d.msghead=="userbase"){b.game.modmgr.mod_userbase.setData(d.msgdata)}else{if(d.msghead=="updatemoney"){b.game.modmgr.mod_userbase.userbase.money=d.msgdata.gold;b.game.modmgr.mod_userbase.userbase.gem=d.msgdata.gem;b.game.modmgr.mod_userbase.userbase.charm=d.msgdata.charm;b.game.uimgr.updateUIMsg("updatemoney")}else{if(d.msghead=="invite"){b.game.modmgr.mod_login.inviteData=d.msgdata;if(b.game.modmgr.mod_login.inviteData.isinvite==1){if(b.game.uimgr.uis["gameclass.recommendUI"]){b.game.uimgr.uis["gameclass.recommendUI"].setNoSend()}}}else{}}}}}}}},function(){cc.log("onerrorfunc")},function(){cc.log("onclosefunc");b.ip=null;var c=cc.sequence(cc.delayTime(1),cc.callFunc(function(){b.connect(a)}));cc.director.getRunningScene().runAction(c)})};gameclass.mod_center.prototype.iospay=function(a){var b={receipt:a,sandbox:false};this.mywebsocket.send("charge",b)};gameclass.mod_center.prototype.code=function(a){var b={code:a};this.mywebsocket.send("code",b)};gameclass.mod_center.prototype.getmapinfo=function(a){if(!cc.sys.isNative){return}if(gameclass.clientver==0){return}if(gameclass.mapinfo!=null&&gameclass.mapinfo!=""){return}gameclass.mapinfo=gameclass.mod_platform.getmapinfo();if(gameclass.mapinfo!=null&&gameclass.mapinfo!=""){var b={mapinfo:gameclass.mapinfo};this.mywebsocket.send("setmapinfo",b)}};gameclass.mod_center.prototype.isViewMailPoint=function(){if(this.notice==null){return false}if(this.hasread==null){return this.notice.length>0}for(var b=0;b<this.notice.length;b++){var c=false;for(var a=0;a<this.hasread.length;a++){if(this.notice[b].id==this.hasread[a]){c=true;break}}if(!c){return true}}return false};gameclass.mod_center.prototype.sendReadMail=function(c){if(this.mywebsocket==null){return}if(this.hasread==null){return}for(var a=0;a<this.hasread.length;a++){if(this.hasread[a]==c){return}}this.hasread.push(c);var b={id:c};this.mywebsocket.send("readmail",b);if(this.game.uimgr.uis["gameclass.hallui"]!=null){this.game.uimgr.uis["gameclass.hallui"].updateMailPoint()}};gameclass.mod_center.prototype.buyItem=function(b){if(this.mywebsocket==null){return}var a={id:b};this.mywebsocket.send("buyitem",a)};gameclass.mod_center.prototype.joinGoldRoom=function(a){if(this.mywebsocket==null){return}var b={roomid:a};this.mywebsocket.send("joingoldroom",b)};gameclass.mod_center.prototype.sendInviteCode=function(b){var a={code:Number(b)};this.mywebsocket.send("invite",a)};gameclass.mod_center.prototype.weixinShareOK=function(a){if(this.isclickPYQ){var b={id:18};this.mywebsocket.send("shareOK",b)}};mod_sound={};mod_sound.playeffect=function(b,a){return cc.audioEngine.playEffect(b,a)};mod_sound.stopffect=function(a){return cc.audioEngine.stopEffect(a)};mod_sound.playbmg=function(b,a){return cc.audioEngine.playMusic(b,a)};mod_sound.stopbmg=function(a){return cc.audioEngine.stopMusic(a)};mod_sound.stopallsound=function(){cc.audioEngine.stopAllEffects();cc.audioEngine.stopMusic(true)};mod_sound.stopAllEffects=function(){cc.audioEngine.stopAllEffects()};mod_sound.setEffectsVolume=function(a){cc.audioEngine.setEffectsVolume(a)};mod_sound.getEffectsVolume=function(){return cc.audioEngine.getEffectsVolume()};mod_sound.setMusicVolume=function(a){cc.audioEngine.setMusicVolume(a)};mod_sound.getMusicVolume=function(){return cc.audioEngine.getMusicVolume()};gameclass.mod_record=gameclass.mod_base.extend({msg_list_Hander:{},msg_data_hander:{},o_data:null,s_data:null,curGameid:null,curRoomid:null,curBureauid:null,curUserid:null,maxJu:[],ctor:function(){this.msg_list_Hander[gameclass.gameniuniu]="record";this.msg_list_Hander[gameclass.gamelzddz]="recordddz1";this.msg_list_Hander[gameclass.gameddz]="recordddz1";this.msg_list_Hander[gameclass.gamesdb]="record";this.msg_list_Hander[gameclass.gamehlgc]="recordqhmj1";this.msg_list_Hander[gameclass.gamelyc]="record";this.msg_list_Hander[gameclass.gamewolong]="record";this.msg_data_hander[gameclass.gameniuniu]="record";this.msg_data_hander[gameclass.gamelzddz]="recordddz2";this.msg_data_hander[gameclass.gameddz]="recordddz2";this.msg_data_hander[gameclass.gamesdb]="record";this.msg_data_hander[gameclass.gamelyc]="record";this.msg_data_hander[gameclass.gamehlgc]="recordqhmj2";this.msg_data_hander[gameclass.gamewolong]="record"},setCurGameid:function(a){this.curGameid=a},setCurRoomid:function(a){this.curRoomid=a},setCurBureauid:function(a){this.curBureauid=a},setCurUserid:function(a){this.curUserid=a},getMaxJu:function(e){this.maxJu=[];for(var b in e){var c=Number(b);var a=e[b].children.length;var d={roomId:c,maxJu:a};this.maxJu.push(d)}},});gameclass.mod_record.prototype.getRecordList=function(a,c,b){this.getGCRecordInfo(a,c,b)};gameclass.mod_record.prototype.getGCRecordInfo=function(a,d,c){this.curGameid=null;this.o_data=null;this.s_data=null;var e=this;var b=this.msg_list_Hander[a];this.sendhttp(this.msg_list_Hander[a],d,function(h,g,f){e.setCurGameid(a);if(a==gameclass.gamelzddz||a==gameclass.gameddz||a==gameclass.gameszp||a==gameclass.gamehlgc){var m={roomData:h,temp:g,playData:f};e.o_data=m.roomData.info}else{e.o_data=[];if(!h.info){}else{for(var k=0;k<h.info.length;k++){e.o_data.push(JSON.parse(h.info[k]))}}}var l={};cc.each(e.o_data,function(q,n){if(a==gameclass.gameszp){q=JSON.parse(q)}if(q.roomid>10000000){var p=parseInt(q.roomid/100);if(!l[p]){l[p]={ot:q.roomid,time:q.time,children:[]}}l[p].children.push(q)}});e.s_data=l;if(a==gameclass.gamehlgc){e.getMaxJu(l)}if(c){c(l)}})};gameclass.mod_record.prototype.getBureauList=function(){return this.s_data[this.curRoomid]};gameclass.mod_record.prototype.getRecordBureau=function(a){var c=this.msg_data_hander[this.curGameid];var b={type:this.curBureauid,uid:this.curUserid};this.sendhttp(c,b,function(f,e,d){a(f)})};var gameclass=gameclass||{};gameclass.tool_cardType=cc.Class.extend({CARDTYPE:{danzhang:1,duizi:2,sanzhang:3,zhadan:4,sandaiyi:5,sandaier:6,liandui:7,shunzi:8,sidaierdan:9,sidaierdui:10,feiji:11,danfei:12,shuangfei:13,huojian:14,},ctor:function(){},check:function(a){if(a.length<1){return 0}var e=this.build(a);cc.log(e);var b=[this.isDanZhang.bind(this),this.isDuiZi.bind(this),this.isSanZhang.bind(this),this.isZhaDan.bind(this),this.isSanDaiYi.bind(this),this.isSanDaiEr.bind(this),this.isLianDui.bind(this),this.isShunZi.bind(this),this.isSiDaiErDan.bind(this),this.isSiDaiErDui.bind(this),this.isFeiJi.bind(this),this.isDanFei.bind(this),this.isShuangFei.bind(this),this.isHuoJian.bind(this)];var d=0;for(var c=0;c<b.length;c++){if(b[c]){d=b[c](e,a.length);if(d!==0){break}}}return d},build:function(d){var b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var a=0;a<d.length;a++){var c=d[a];if(c==100){c=13}else{if(c==200){c=14}else{c-=3}}b[c]++}return b},compare:function(a,d){cc.log("pressCards="+a+",befCards="+d);var c=this.check(a);cc.log("---------------压牌-----------------000");cc.log(c);if(c==0){return{value:-1}}var b=this.check(d);cc.log("---------------上家出的牌------------000");cc.log(b);if(b==0){return{value:-1}}if(c.type==this.CARDTYPE.huojian){return{type:this.CARDTYPE.huojian,value:1}}if(c.type==this.CARDTYPE.zhadan){if(b.type!=this.CARDTYPE.zhadan&&b.type!=this.CARDTYPE.huojian){return{type:this.CARDTYPE.zhadan,value:1}}else{if(b.type==this.CARDTYPE.zhadan){if(a[0]>d[0]){return{type:this.CARDTYPE.zhadan,value:1}}else{return{value:-1}}}}}if(c.type!=b.type){return{value:-1}}switch(c.type){case this.CARDTYPE.danzhang:return{type:this.CARDTYPE.danzhang,value:c.value>b.value?1:-1,res:c.value};break;case this.CARDTYPE.duizi:return{type:this.CARDTYPE.duizi,value:c.value>b.value?1:-1,res:c.value};break;case this.CARDTYPE.sanzhang:return{type:this.CARDTYPE.sanzhang,value:c.value>b.value?1:-1,res:c.value};break;case this.CARDTYPE.sandaiyi:return{type:this.CARDTYPE.sandaiyi,value:c.value>b.value?1:-1,res:c.value};break;case this.CARDTYPE.sandaier:return{type:this.CARDTYPE.sandaier,value:c.value>b.value?1:-1,res:c.value};break;case this.CARDTYPE.liandui:return{type:this.CARDTYPE.liandui,value:c.value.min>b.value.min?1:-1,res:c.value.min};case this.CARDTYPE.shunzi:if(c.value.count!=b.value.count){return -1}return{type:this.CARDTYPE.shunzi,value:c.value.min>b.value.min?1:-1,res:c.value.min};break;case this.CARDTYPE.sidaierdan:return{type:this.CARDTYPE.sidaierdan,value:c.value>b.value?1:-1,res:c.value};case this.CARDTYPE.sidaierdui:return{type:this.CARDTYPE.sidaierdui,value:c.value>b.value?1:-1,res:c.value};break;case this.CARDTYPE.feiji:return{type:this.CARDTYPE.feiji,value:c.value.min>b.value.min?1:-1,res:c.value.min};case this.CARDTYPE.danfei:return{type:this.CARDTYPE.danfei,value:c.value.min>b.value.min?1:-1,res:c.value.min};case this.CARDTYPE.shuangfei:return{type:this.CARDTYPE.shuangfei,value:c.value.min>b.value.min?1:-1,res:c.value.min};break;default:return{value:-1};break}},isDanZhang:function(c,b){if(b!=1){return 0}for(var a=0;a<c.length;a++){if(c[a]==1){return{type:this.CARDTYPE.danzhang,value:a}}}return 0},isDuiZi:function(d,b){if(b!=2){return 0}var c=false;for(var a=0;a<d.length;a++){if(d[a]==2){return{type:this.CARDTYPE.duizi,value:a}}}return 0},isSanZhang:function(d,b){if(b!=3){return 0}var c=false;for(var a=0;a<d.length;a++){if(d[a]==3){return{type:this.CARDTYPE.sanzhang,value:a}}}return 0},isZhaDan:function(d,b){if(b!=4){return 0}var c=false;for(var a=0;a<d.length;a++){if(d[a]==4){return{type:this.CARDTYPE.zhadan,value:a}}}return 0},isSanDaiYi:function(f,b){if(b!=4){return 0}var e=0,c=0,d=-1;var g=0;for(var a=0;a<f.length;a++){if(f[a]==3){d=a;c++}if(f[a]==1){g=a;e++}}if(c==1&&e==1){return{type:this.CARDTYPE.sandaiyi,value:d,d1:g}}return 0},isSanDaiEr:function(f,b){if(b!=5){return 0}var e=0,c=0,d=-1;var g=0;for(var a=0;a<f.length;a++){if(f[a]==3){d=a;c++}if(f[a]==2){g=a;e++}}if(c==1&&e==1){return{type:this.CARDTYPE.sandaier,value:d,d1:g}}return 0},isContinuation:function(d){if(d[12]>0||d[13]>0||d[14]>0){return 0}var c=-1,a=-1;for(var b=0;b<d.length;b++){if(c==-1&&d[b]!=0){c=b;break}}if(c<0){return 0}for(var b=d.length-1;b>=0;b--){if(a==-1&&d[b]!=0){a=b;break}}if(a<0){return 0}for(var b=c;b<=a;b++){if(d[b]==0){return 0}}return{min:c,max:a,count:a-c+1}},isLianDui:function(d,c){if(c<5){return 0}for(var b=0;b<d.length;b++){if(d[b]!=0&&d[b]!=2){return 0}}var a=this.isContinuation(d);if(a==0){return 0}if(a.count<3){return 0}return{type:this.CARDTYPE.liandui,value:a}},isShunZi:function(d,c){if(c<5){return 0}for(var b=0;b<d.length;b++){if(d[b]!=0&&d[b]!=1){return 0}}var a=this.isContinuation(d);if(a==0){return 0}if(a.count<5){return 0}return{type:this.CARDTYPE.shunzi,value:a}},isSiDaiErDan:function(b,m){if(m!=6){return 0}var c=0,a=0,l=0,k=-1,h=-1,f=-1;var e=0,d=0;for(var g=0;g<b.length;g++){if(b[g]==4){f=g;l++}if(b[g]==1){if(e==0){e=g}else{d=g}c++}if(b[g]==2){e=g;d=g;c+=2}}if(l==1&&c==2){return{type:this.CARDTYPE.sidaierdan,value:f,d1:e,d2:d}}return 0},isSiDaiErDui:function(b,k){if(k!=8){return 0}var c=0,a=0,h=0,f=-1;var e=0,d=0;for(var g=0;g<b.length;g++){if(b[g]==4){f=g;h++}if(b[g]==2){if(c==0){e=g;c++}else{d=g;a++}}}if(h==1&&c==1&&a==1){return{type:this.CARDTYPE.sidaierdui,value:f,d1:e,d2:d}}return 0},isFeiJi:function(d,c){if(c<6||c>18){return 0}for(var b=0;b<d.length;b++){if(d[b]!=0&&d[b]!=3){return 0}}var a=this.isContinuation(d);if(a==0){return 0}if(a.count<2){return 0}return{type:this.CARDTYPE.feiji,value:a}},isDanFei:function(a,k){if(k<8){return 0}var b=0,h=0;var c=[];var g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var e=0;e<a.length;e++){if(a[e]==3){g[e]=3;h++}else{for(var d=0;d<a[e];d++){c.push(e)}b+=a[e]}}if(h!=b){return 0}var f=this.isContinuation(g);if(f==0){return 0}return{type:this.CARDTYPE.danfei,value:f,d1:c}},isShuangFei:function(b,k){if(k<10){return 0}var a=0,h=0;var d=0;var g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var c=[];for(var e=0;e<b.length;e++){if(b[e]==3){g[e]=3;h++}else{if(b[e]==2){a++;c.push(e)}else{d+=b[e]}}}if(h!=a||d>0){return 0}var f=this.isContinuation(g);if(f==0){return 0}return{type:this.CARDTYPE.shuangfei,value:f,d2:c}},isHuoJian:function(b,a){if(a!=2){return 0}if(b[b.length-1]==1&&b[b.length-2]==1){return{type:this.CARDTYPE.huojian}}return 0},getOneCard:function(o,f,c,m,d,h,k){if(h==null||h<=0){h=1}if(k==null){k=false}var b=[];for(var g=0;g<o.length;g++){if(o[g]>d){b[b.length]=o[g];if(b.length>=h&&!k){return b}}}for(var g=0;g<f.length;g++){if(f[g]>d){for(var e=0;e<2;e++){b[b.length]=f[g];if(b.length>=h&&!k){return b}if(k){break}}}}for(var g=0;g<c.length;g++){if(c[g]>d){for(var e=0;e<3;e++){b[b.length]=c[g];if(b.length>=h&&!k){return b}if(k){break}}}}if(k){for(var g=0;g<m.length;g++){if(m[g]>d){b[b.length]=m[g]}}}if(k&&b.length>=h){b.sort(function(q,p){return q-p});var l=-1;var n=true;for(var g=0;g<b.length;g++){n=true;for(var e=1;e<h;e++){if(g+e>=b.length){n=false;break}if(b[g+e]-b[g+e-1]!=1){n=false;break}}if(n){l=g;break}}if(l==-1){return null}var a=[];for(var g=l;g<h+l;g++){a[g-l]=b[g]}return a}return null},getTwoCard:function(o,f,c,m,d,h,k){if(h==null||h<=0){h=1}if(k==null){k=false}var a=[];for(var g=0;g<f.length;g++){if(f[g]>d){a[a.length]=f[g];a[a.length]=f[g];if(a.length/2>=h&&!k){return a}}}for(var g=0;g<c.length;g++){if(c[g]>d){a[a.length]=c[g];a[a.length]=c[g];if(a.length/2>=h&&!k){return a}}}if(k){for(var g=0;g<m.length;g++){if(m[g]>d){a[a.length]=m[g];a[a.length]=m[g]}}}if(k&&a.length>=h*2){a.sort(function(q,p){return q-p});var l=-1;var n=true;for(var g=0;g<a.length;g+=2){n=true;for(var e=1;e<h;e++){if(g+e*2>=a.length){n=false;break}if(a[g+e*2]-a[g+(e-1)*2]!=1){n=false;break}}if(n){l=g;break}}if(l==-1){return null}var b=[];for(var g=l;g<h*2+l;g++){b[g-l]=a[g]}return b}return null},getThreeCard:function(o,f,c,m,d,h,k){cc.log(o,f,c,d,h,k);if(h==null||h<=0){h=1}if(k==null){k=false}var a=[];for(var g=0;g<c.length;g++){if(c[g]>d){a[a.length]=c[g];a[a.length]=c[g];a[a.length]=c[g];if(a.length/3>=h&&!k){return a}}}if(k){for(var g=0;g<m.length;g++){if(m[g]>d){a[a.length]=m[g];a[a.length]=m[g];a[a.length]=m[g]}}}if(k&&a.length>=h*3){a.sort(function(q,p){return q-p});var l=-1;var n=true;for(var g=0;g<a.length;g+=3){n=true;for(var e=1;e<h;e++){if(g+e*3>=a.length){n=false;break}if(a[g+e*3]-a[g+(e-1)*3]!=1){n=false;break}}if(n){l=g;break}}if(l==-1){return null}var b=[];for(var g=l;g<h*3+l;g++){b[g-l]=a[g]}return b}return null},getFourCard:function(d,a){var c=[];for(var b=0;b<d.length;b++){if(d[b]>a){c[0]=c[1]=c[2]=c[3]=d[b];return c}}return null},analyseCard:function(l,h,d,b,f){var k=[];var a=[];var g=false;for(var e=0;e<l.length;e++){if(l[e]==1000||l[e]==2000){a[a.length]=l[e];continue}if(k.hasOwnProperty(l[e])){k[l[e]]++}else{k[l[e]]=1}}for(var c in k){if(k[c]==1){h[h.length]=parseInt(c)}else{if(k[c]==2){d[d.length]=parseInt(c)}else{if(k[c]==3){b[b.length]=parseInt(c)}else{if(k[c]==4){f[f.length]=parseInt(c)}}}}}if(a.length==2){g=true}else{if(a.length==1){h[h.length]=a[0]}}return g},costCard:function(e,a,c){for(var d=0;d<a.length;d+=c){for(var b=0;b<e.length;b++){if(e[b]==a[d]){e.splice(b,1);break}}}},getLastCard:function(v,s){var o=[];var t=[];var u=[];var e=[];var c=[];var d=this.analyseCard(v,t,u,e,c);var f=[];var g=[];var p=[];var l=[];var q=this.analyseCard(s,f,g,p,l);if(s.length==0){if(t.length>0){o[0]=t[0];return o}else{if(u.length>0){o[0]=o[1]=u[0];return o}else{if(e.length>0){o[0]=o[1]=o[2]=e[0];return o}else{if(c.length>0){o[0]=o[1]=o[2]=o[3]=c[0];return o}}}}}if(q){return o}if(s.length==1){var m=this.getOneCard(t,u,e,c,s[0]);if(m!=null){return m}}if(s.length==2){var m=this.getTwoCard(t,u,e,c,s[0]);if(m!=null){return m}}if(s.length==3){var m=this.getThreeCard(t,u,e,c,s[0]);if(m!=null){return m}}var k=false;if(s.length==4){if(s[0]==s[1]&&s[2]==s[3]&&s[0]==s[3]){k=true;var h=this.getFourCard(c,s[0]);if(h!=null){return h}}else{var n=this.getThreeCard(t,u,e,c,p[0]);if(n!=null){this.costCard(e,n,3);var b=this.getOneCard(t,u,e,c,0);if(b!=null){n[3]=b[0];return n}}}}if(s.length==5){if(p.length>0&&g.length>0){var n=this.getThreeCard(t,u,e,c,p[0]);if(n!=null){this.costCard(e,n,3);var a=this.getTwoCard(t,u,e,c,0);if(a!=null){n[3]=n[4]=a[0];return n}}}}if(s.length>=5){if(f.length==s.length){var b=this.getOneCard(t,u,e,c,f[0],f.length,true);cc.log(b);if(b!=null){return b}}else{if(g.length==s.length/2){var a=this.getTwoCard(t,u,e,c,g[0],g.length,true);if(a!=null){return a}}else{if(p.length==s.length/3){var n=this.getThreeCard(t,u,e,c,p[0],p.length,true);if(n!=null){return n}}else{if(l.length==0&&p.length==f.length&&g.length==0){var n=this.getThreeCard(t,u,e,c,p[0],p.length,true);if(n!=null){this.costCard(e,n,3);var b=this.getOneCard(t,u,e,c,0,p.length);if(b!=null){for(var r=0;r<b.length;r++){n[n.length+r]=b[r]}return n}}}else{if(l.length==0&&p.length==g.length&&f.length==0){var n=this.getThreeCard(t,u,e,c,p[0],p.length,true);if(n!=null){this.costCard(e,n,3);var a=this.getTwoCard(t,u,e,c,0,p.length);if(a!=null){for(var r=0;r<a.length;r++){n[n.length+r]=a[r]}return n}}}else{if(l.length==0&&p.length==(f.length+g.length)){var n=this.getThreeCard(t,u,e,c,p[0],p.length,true);if(n!=null){this.costCard(e,n,3);var b=this.getOneCard(t,u,e,c,0,p.length);if(b!=null){for(var r=0;r<b.length;r++){n[n.length+r]=b[r]}return n}}}else{if(l.length==1&&f.length==2&&p.length==0&&g.length==0){var h=this.getFourCard(c,l[0]);if(h!=null){var b=this.getOneCard(t,u,e,c,0,2);if(b!=null){h[4]=b[0];h[5]=b[1];return h}}}else{if(l.length==1&&g.length==1&&p.length==0&&f.length==0){var h=this.getFourCard(c,l[0]);if(h!=null){var b=this.getOneCard(t,u,e,c,0,2);if(b!=null){h[4]=b[0];h[5]=b[1];return h}}}else{if(l.length==1&&g.length==2&&p.length==0&&f.length==0){var h=this.getFourCard(c,l[0]);if(h!=null){var a=this.getTwoCard(t,u,e,c,0,2);if(a!=null){h[4]=h[5]=a[0];h[6]=h[7]=a[2];return h}}}}}}}}}}}}if(!k){for(var r=0;r<c.length;r++){cc.log("boom fourCard="+c[r]);o[0]=o[1]=o[2]=o[3]=c[r];cc.log("lastCards[0]="+o[0]);return o}}if(d){o[0]=1000;o[1]=2000;return o}return new Array()},tipsCard:function(c,a){for(var b=0;b<c.length;b++){if(c[b]==1000||c[b]==2000){continue}c[b]=parseInt(c[b]/10);if(c[b]==1){c[b]=14}else{if(c[b]==2){c[b]=20}}}cc.log("Tool--tipsCard="+c);c.sort(function(e,d){return e-d});for(var b=0;b<a.length;b++){if(a[b]==1000||a[b]==2000){continue}a[b]=parseInt(a[b]/10);if(a[b]==1){a[b]=14}else{if(a[b]==2){a[b]=20}}}a.sort(function(e,d){return e-d});cc.log("tips handCards="+c);cc.log("tips stepCards="+a);return this.getLastCard(c,a)},});gameclass.tool_cardType.create=function(){return new gameclass.tool_cardType()};var gameclass=gameclass||{};gameclass.tool_wildcardType=gameclass.tool_cardType.extend({razznum:0,razz:0,currazz:[],ctor:function(){},build:function(d){var b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var a=0;a<d.length;a++){var c=d[a];if(c==100){c=13}else{if(c==200){c=14}else{c-=3}}b[c]++}return b},checkW:function(a,g){if(a.length<1){return 0}if(g==100||g==200){return 0}if(g==1){g=14}if(g==2){g=15}g-=3;if(g<0||g>12){return 0}var f=this.build(a);var c=[this.isDanZhangW.bind(this),this.isDuiZiW.bind(this),this.isSanZhangW.bind(this),this.isZhaDanW.bind(this),this.isSanDaiYiW.bind(this),this.isSanDaiErW.bind(this),this.isLianDuiW.bind(this),this.isShunZiW.bind(this),this.isSiDaiErDanW.bind(this),this.isSiDaiErDuiW.bind(this),this.isFeiJiW.bind(this),this.isDanFeiW.bind(this),this.isShuangFeiW.bind(this),this.isHuoJianW.bind(this)];var b=[];var e=0;for(var d=0;d<c.length;d++){if(c[d]){e=c[d](f,a.length,g);if(e){b.push(e)}}}e=b.length>0?b:0;return e},transformToCardArr:function(d){var b=[];switch(d.type){case this.CARDTYPE.danzhang:for(var c=d.value;c<=d.value;c++){b.push(c)}break;case this.CARDTYPE.duizi:for(var c=d.value;c<=d.value;c++){for(var a=0;a<2;a++){b.push(c)}}break;case this.CARDTYPE.sanzhang:for(var c=d.value;c<=d.value;c++){for(var a=0;a<3;a++){b.push(c)}}break;case this.CARDTYPE.zhadan:for(var c=d.value;c<=d.value;c++){for(var a=0;a<4;a++){b.push(c)}}break;case this.CARDTYPE.sandaiyi:for(var c=d.value;c<=d.value;c++){for(var a=0;a<3;a++){b.push(c);if(a==2){b.push(d.d1)}}}break;case this.CARDTYPE.sandaier:for(var c=d.value;c<=d.value;c++){for(var a=0;a<3;a++){b.push(c);if(a==2){b.push(d.d1);b.push(d.d1)}}}break;case this.CARDTYPE.liandui:for(var c=d.value.min;c<=d.value.max;c++){for(var a=0;a<2;a++){b.push(c)}}break;case this.CARDTYPE.shunzi:for(var c=d.value.min;c<=d.value.max;c++){b.push(c)}break;case this.CARDTYPE.sidaierdan:for(var c=d.value;c<=d.value;c++){for(var a=0;a<4;a++){b.push(c);if(a==3){b.push(d.d1);b.push(d.d2)}}}break;case this.CARDTYPE.sidaierdui:for(var c=d.value;c<=d.value;c++){for(var a=0;a<4;a++){b.push(c);if(a==3){b.push(d.d1);b.push(d.d1);b.push(d.d2);b.push(d.d2)}}}break;case this.CARDTYPE.feiji:for(var c=d.value.min;c<=d.value.max;c++){for(var a=0;a<3;a++){b.push(c)}}break;case this.CARDTYPE.danfei:for(var c=d.value.min;c<=d.value.max;c++){for(var a=0;a<3;a++){b.push(c)}}for(var c=0;c<d.d1.length;c++){b.push(d.d1[c])}break;case this.CARDTYPE.shuangfei:for(var c=d.value.min;c<=d.value.max;c++){for(var a=0;a<3;a++){b.push(c)}}for(var c=0;c<d.d2.length;c++){for(var a=0;a<2;a++){b.push(d.d2[c])}}break;case this.CARDTYPE.huojian:b.push(1000);b.push(2000);break;default:break}return b},compareW:function(l,c,h,m,g){cc.log("pressCards="+l+"\nbefCards="+c+"\nwildCard="+h+"\npressHasWild="+m+"\nbefHasWild="+g);var c=this.check(c);cc.log("---------------上家出的牌------------111");cc.log(c);if(c==0){return 0}var l=this.checkW(l,h);cc.log("---------------压牌-----------------111");cc.log(l);if(l==0){return 0}var k=[];for(var e=0;e<l.length;e++){for(var d=0;d<l[e].length;d++){if(this.compareSize(l[e][d],c,m,g)){k.push(l[e][d])}}}var n=[];var f=[];for(var e=0;e<k.length;e++){var a=false;for(var d=0;d<f.length;d++){if(f[d]==k[e].type){a=true;break}}if(!a){f.push(k[e].type)}}for(var d=0;d<f.length;d++){var a=false;var b=[];for(var e=0;e<k.length;e++){if(f[d]==k[e].type){b.push(k[e])}}n.push(b)}cc.log(n);if(n.length>0){return n}return 0},compareSize:function(d,c,a,b){cc.log(d,c,a,b);if(d.type==this.CARDTYPE.huojian){return true}if(d.type==this.CARDTYPE.zhadan){if(c.type!=this.CARDTYPE.zhadan&&c.type!=this.CARDTYPE.huojian){return true}else{if(c.type==this.CARDTYPE.zhadan){if(a==b){return d.value>c.value}else{return !a}}}}if(d.type!=c.type){return false}switch(d.type){case this.CARDTYPE.danzhang:case this.CARDTYPE.duizi:case this.CARDTYPE.sanzhang:case this.CARDTYPE.sandaiyi:case this.CARDTYPE.sandaier:if(d.value>c.value){return true}break;case this.CARDTYPE.liandui:if(d.value.min>c.value.min){return true}break;case this.CARDTYPE.shunzi:if(d.value.count!=c.value.count){return false}if(d.value.min>c.value.min){return true}break;case this.CARDTYPE.sidaierdan:case this.CARDTYPE.sidaierdui:if(d.value>c.value){return true}break;case this.CARDTYPE.feiji:case this.CARDTYPE.danfei:case this.CARDTYPE.shuangfei:if(d.value.min>c.value.min){return true}break;default:break}return false},isDanZhangW:function(d,c){if(c!=1){return 0}var a=[];var b=this.isDanZhang(d,c);if(b){a.push(b)}return a.length>0?a:0},isDuiZiW:function(d,c,e){if(c!=2){return 0}if(d[13]>0||d[14]>0){return 0}var a=[];var b=this.isDuiZi(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isDuiZiW.bind(this),this.isDuiZi.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isSanZhangW:function(d,c,e){if(c!=3){return 0}var a=[];var b=this.isSanZhang(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isSanZhangW.bind(this),this.isSanZhang.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isZhaDanW:function(d,c,e){if(c!=4){return 0}var a=[];var b=this.isZhaDan(d,c);if(b){a.push(b);cc.log(a)}b=this.matchCard(d,c,e,this.isZhaDanW.bind(this),this.isZhaDan.bind(this));if(b){a=a.concat(b);cc.log(a)}return a.length>0?a:0},isSanDaiYiW:function(d,c,e){if(c!=4){return 0}var a=[];var b=this.isSanDaiYi(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isSanDaiYiW.bind(this),this.isSanDaiYi.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isSanDaiErW:function(d,c,e){cc.log("isSanDaiErW");if(c!=5){return 0}var a=[];var b=this.isSanDaiEr(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isSanDaiErW.bind(this),this.isSanDaiEr.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},matchCard:function(a,l,f,b,h){var g=0;var d=[];var k=a.slice(0,a.length);if(k[f]){k[f]--;for(var c=k.length-3;c>=0;c--){if(c==f){continue}var e=k.slice(0,k.length);e[c]++;if(k[f]>0){g=b(e,l,f)}else{g=h(e,l)}if(g){if(cc.isArray(g)){d=d.concat(g)}else{d.push(g)}}}return d.length>0?d:0}},isLianDuiW:function(d,c,e){if(c<5){return 0}var a=[];var b=this.isLianDui(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isLianDuiW.bind(this),this.isLianDui.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isShunZiW:function(d,c,e){if(c<5){return 0}var a=[];var b=this.isShunZi(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isShunZiW.bind(this),this.isShunZi.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isSiDaiErDanW:function(d,c,e){if(c!=6){return 0}var a=[];var b=this.isSiDaiErDan(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isSiDaiErDanW.bind(this),this.isSiDaiErDan.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isSiDaiErDuiW:function(d,c,e){if(c!=8){return 0}var a=[];var b=this.isSiDaiErDui(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isSiDaiErDuiW.bind(this),this.isSiDaiErDui.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isFeiJiW:function(d,c,e){if(c<6||c>18){return 0}var a=[];var b=this.isFeiJi(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isFeiJiW.bind(this),this.isFeiJi.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isDanFeiW:function(d,c,e){if(c<8){return 0}var a=[];var b=this.isDanFei(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isDanFeiW.bind(this),this.isDanFei.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isShuangFeiW:function(d,c,e){if(c<10){return 0}var a=[];var b=this.isShuangFei(d,c);if(b){a.push(b)}b=this.matchCard(d,c,e,this.isShuangFeiW.bind(this),this.isShuangFei.bind(this));if(b){a=a.concat(b)}return a.length>0?a:0},isHuoJianW:function(d,c){if(c!=2){return 0}var a=[];var b={};if(d[d.length-1]==1&&d[d.length-2]==1){b={type:this.CARDTYPE.huojian};a.push(b)}return a.length>0?a:0},getCardTypeString:function(a){var b="";switch(a){case this.CARDTYPE.danzhang:b="单张";break;case this.CARDTYPE.duizi:b="对子";break;case this.CARDTYPE.sanzhang:b="三张";break;case this.CARDTYPE.zhadan:b="炸弹";break;case this.CARDTYPE.sandaiyi:case this.CARDTYPE.sandaier:b="三带一";break;case this.CARDTYPE.liandui:b="连对";break;case this.CARDTYPE.shunzi:b="顺子";break;case this.CARDTYPE.sidaierdan:case this.CARDTYPE.sidaierdui:b="四带二";break;case this.CARDTYPE.feiji:case this.CARDTYPE.danfei:case this.CARDTYPE.shuangfei:b="飞机";break;case this.CARDTYPE.huojian:break}return b},getOneCard:function(o,f,c,m,d,h,k){if(h==null||h<=0){h=1}if(k==null){k=false}var b=[];for(var g=0;g<o.length;g++){if(this.getRazzCard(o[g],h==1?1:0)>d){b[b.length]=o[g];if(b.length>=h&&!k){return b}}}for(var g=0;g<f.length;g++){if(this.getRazzCard(f[g],h==1?2:0)>d){b[b.length]=f[g];if(b.length>=h&&!k){return b}}}for(var g=0;g<c.length;g++){if(this.getRazzCard(c[g],h==1?3:0)>d){b[b.length]=c[g];if(b.length>=h&&!k){return b}}}if(k){for(var g=0;g<m.length;g++){if(m[g]>d){b[b.length]=m[g]}}}if(k&&b.length>=h){b.sort(function(q,p){return q-p});var l=-1;var n=true;for(var g=0;g<b.length;g++){n=true;for(var e=1;e<h;e++){if(g+e>=b.length){n=false;break}if(b[g+e]-b[g+e-1]!=1){n=false;break}}if(n){l=g;break}}if(l==-1){return null}var a=[];for(var g=l;g<h+l;g++){a[g-l]=b[g]}return a}return null},getTwoCard:function(o,f,c,m,d,h,k){if(h==null||h<=0){h=1}if(k==null){k=false}var a=[];for(var g=0;g<f.length;g++){if(this.getRazzCard(f[g],h==1?2:0)>d){a[a.length]=f[g];a[a.length]=f[g];if(a.length/2>=h&&!k){return a}}}for(var g=0;g<c.length;g++){if(this.getRazzCard(c[g],h==1?3:0)>d){a[a.length]=c[g];a[a.length]=c[g];if(a.length/2>=h&&!k){return a}}}if(k){for(var g=0;g<m.length;g++){if(m[g]>d){a[a.length]=m[g];a[a.length]=m[g]}}}if(k&&a.length>=h*2){a.sort(function(q,p){return q-p});var l=-1;var n=true;for(var g=0;g<a.length;g+=2){n=true;for(var e=1;e<h;e++){if(g+e*2>=a.length){n=false;break}if(a[g+e*2]-a[g+(e-1)*2]!=1){n=false;break}}if(n){l=g;break}}if(l==-1){return null}var b=[];for(var g=l;g<h*2+l;g++){b[g-l]=a[g]}return b}return null},getThreeCard:function(o,f,c,m,d,h,k){if(h==null||h<=0){h=1}if(k==null){k=false}var a=[];for(var g=0;g<c.length;g++){if(this.getRazzCard(c[g],h==1?3:0)>d){a[a.length]=c[g];a[a.length]=c[g];a[a.length]=c[g];if(a.length/3>=h&&!k){return a}}}if(k){for(var g=0;g<m.length;g++){if(m[g]>d){a[a.length]=m[g];a[a.length]=m[g];a[a.length]=m[g]}}}if(k&&a.length>=h*3){a.sort(function(q,p){return q-p});var l=-1;var n=true;for(var g=0;g<a.length;g+=3){n=true;for(var e=1;e<h;e++){if(g+e*3>=a.length){n=false;break}if(a[g+e*3]-a[g+(e-1)*3]!=1){n=false;break}}if(n){l=g;break}}if(l==-1){return null}var b=[];for(var g=l;g<h*3+l;g++){b[g-l]=a[g]}return b}return null},getFourCard:function(d,a){var c=[];for(var b=0;b<d.length;b++){if(this.getRazzCard(d[b],4)>a){c[0]=c[1]=c[2]=c[3]=d[b];return c}}return null},getRazzCard:function(b,a){if(a==0){return b}if(this.currazz.length<a){return b}for(var c=0;c<this.currazz.length;c++){if(this.currazz[c]==b){a--;if(a<=0){return this.razz}}}return b},getLastCard:function(x,u,p,c){var q=[];this.currazz=p;var v=[];var w=[];var f=[];var d=[];var e=this.analyseCard(x,v,w,f,d);var g=[];var h=[];var r=[];var m=[];var s=this.analyseCard(u,g,h,r,m);if(u.length==0){if(v.length>0){q[0]=v[0];return q}else{if(w.length>0){q[0]=q[1]=w[0];return q}else{if(f.length>0){q[0]=q[1]=q[2]=f[0];return q}else{if(d.length>0){q[0]=q[1]=q[2]=q[3]=d[0];return q}}}}}if(s){return q}if(u.length==1){var n=this.getOneCard(v,w,f,d,u[0]);if(n!=null){return n}}if(u.length==2){var n=this.getTwoCard(v,w,f,d,u[0]);if(n!=null){return n}}if(u.length==3){var n=this.getThreeCard(v,w,f,d,u[0]);if(n!=null){return n}}var l=false;if(u.length==4){if(u[0]==u[1]&&u[2]==u[3]&&u[0]==u[3]){l=true;if(c==0){var k=this.getFourCard(d,u[0]);if(k!=null){if(p.length==0){return k}if(k[0]==this.razz){return k}}}else{for(var t=2;t<=14;t++){var k=this.getFourCard(d,t);if(k==null){continue}if(k[0]==this.razz){return k}if(k[0]>u[0]){return k}if(this.getRazzCard(k[0],1)==k[0]){return k}}}}else{var o=this.getThreeCard(v,w,f,d,r[0]);if(o!=null){this.costCard(f,o,3);var b=this.getOneCard(v,w,f,d,0);if(b!=null){o[3]=b[0];return o}}}}if(u.length==5){if(r.length>0&&h.length>0){var o=this.getThreeCard(v,w,f,d,r[0]);if(o!=null){this.costCard(f,o,3);var a=this.getTwoCard(v,w,f,d,0);if(a!=null){o[3]=o[4]=a[0];return o}}}}if(u.length>=5){if(g.length==u.length){var b=this.getOneCard(v,w,f,d,g[0],g.length,true);if(b!=null){return b}}else{if(h.length==u.length/2){var a=this.getTwoCard(v,w,f,d,h[0],h.length,true);if(a!=null){return a}}else{if(r.length==u.length/3){var o=this.getThreeCard(v,w,f,d,r[0],r.length,true);if(o!=null){return o}}else{if(m.length==0&&r.length==g.length&&h.length==0){var o=this.getThreeCard(v,w,f,d,r[0],r.length,true);if(o!=null){this.costCard(f,o,3);var b=this.getOneCard(v,w,f,d,0,r.length);if(b!=null){for(var t=0;t<b.length;t++){o[o.length+t]=b[t]}return o}}}else{if(m.length==0&&r.length==h.length&&g.length==0){var o=this.getThreeCard(v,w,f,d,r[0],r.length,true);if(o!=null){var a=this.getTwoCard(v,w,f,d,0,r.length);if(a!=null){this.costCard(f,o,3);for(var t=0;t<a.length;t++){o[o.length+t]=a[t]}return o}}}else{if(m.length==0&&r.length==(g.length+h.length)){var o=this.getThreeCard(v,w,f,d,r[0],r.length,true);if(o!=null){var b=this.getOneCard(v,w,f,d,0,r.length);if(b!=null){this.costCard(f,o,3);for(var t=0;t<b.length;t++){o[o.length+t]=b[t]}return o}}}else{if(m.length==1&&g.length==2&&r.length==0&&h.length==0){var k=this.getFourCard(d,m[0]);if(k!=null){var b=this.getOneCard(v,w,f,d,0,2);if(b!=null){k[4]=b[0];k[5]=b[1];return k}}}else{if(m.length==1&&h.length==1&&r.length==0&&g.length==0){var k=this.getFourCard(d,m[0]);if(k!=null){var b=this.getOneCard(v,w,f,d,0,2);if(b!=null){k[4]=b[0];k[5]=b[1];return k}}}else{if(m.length==1&&h.length==2&&r.length==0&&g.length==0){var k=this.getFourCard(d,m[0]);if(k!=null){var a=this.getTwoCard(v,w,f,d,0,2);if(a!=null){k[4]=k[5]=a[0];k[6]=k[7]=a[2];return k}}}}}}}}}}}}if(!l){for(var t=0;t<d.length;t++){cc.log("boom fourCard="+d[t]);q[0]=q[1]=q[2]=q[3]=d[t];cc.log("lastCards[0]="+q[0]);return q}}if(e){q[0]=1000;q[1]=2000;return q}return new Array()},getHandCards:function(d,b){var a=[];for(var c=0;c<d.length;c++){a[c]=d[c]}if(b!=null){a[a.length]=b;a.sort(function(f,e){return f-e})}return a},getCurRazz:function(d,b){var a=[];for(var c=0;c<d.length;c++){a[c]=d[c]}a[a.length]=b;return a},getOutCards:function(h,k,g,b,c){g--;for(var d=3;d<=14;d++){var f=this.getHandCards(h,d);var e=this.getCurRazz(c,d);if(g==0){var a=this.getLastCard(f,k,e,b);if(a.length>0){return a}}else{var a=this.getOutCards(f,k,g,b,e);if(a!=null&&a.length>0){return a}}}var f=this.getHandCards(h,20);var e=this.getCurRazz(c,20);if(g==0){var a=this.getLastCard(f,k,e,b);if(a.length>0){return a}}else{var a=this.getOutCards(f,k,g,b,e);if(a!=null&&a.length>0){return a}}return null},transformLastCard:function(f,c,b){for(var d=0;d<c.length;d++){b[d]=c[d];var e=false;for(var a=0;a<f.length;a++){if(f[a]==c[d]){f.splice(a,1);e=true;break}}if(!e){c[d]=this.razz}}return c},tipsCard:function(h,a,e,g,d){if(g==1){this.razz=14}else{if(g==2){this.razz=20}else{this.razz=g}}this.razznum=0;for(var f=0;f<h.length;){if(h[f]==1000||h[f]==2000){f++;continue}h[f]=parseInt(h[f]/10);if(h[f]==1){h[f]=14}else{if(h[f]==2){h[f]=20}}if(h[f]==this.razz){h.splice(f,1);this.razznum++}else{f++}}cc.log("Tool--tipsCard="+h);h.sort(function(l,k){return l-k});for(var f=0;f<a.length;f++){if(a[f]==1000||a[f]==2000){continue}a[f]=parseInt(a[f]/10);if(a[f]==1){a[f]=14}else{if(a[f]==2){a[f]=20}}}a.sort(function(l,k){return l-k});var c=this.getLastCard(this.getHandCards(h),a,[],e);if(c.length==2&&c[0]==1000&&c[1]==2000){}else{if(c.length==4&&c[0]==c[1]&&c[0]==c[2]&&c[0]==c[3]){}else{if(c.length>0){for(var f=0;f<c.length;f++){d[f]=c[f]}return c}}}if(this.razznum>0){var b=this.getOutCards(h,a,1,e,[]);if(b!=null){return this.transformLastCard(h,b,d)}this.razznum--}if(this.razznum>0){var b=this.getOutCards(h,a,2,e,[]);if(b!=null){return this.transformLastCard(h,b,d)}this.razznum--}if(this.razznum>0){var b=this.getOutCards(h,a,3,e,[]);if(b!=null){return this.transformLastCard(h,b,d)}this.razznum--}if(this.razznum>0){var b=this.getOutCards(h,a,4,e,[]);if(b!=null){return this.transformLastCard(h,b,d)}this.razznum--}if(c.length>0){for(var f=0;f<c.length;f++){d[f]=c[f]}return c}return new Array()},});gameclass.tool_wildcardType.create=function(){return new gameclass.tool_wildcardType()};gameclass.modmgr=cc.Class.extend({data:null,game:null,ctor:function(){},setgame:function(a){this.game=a;this.mod_login=new gameclass.mod_login;this.mod_login.setgame(a);this.mod_center=new gameclass.mod_center;this.mod_center.setgame(a);this.mod_userbase=new gameclass.mod_userbase;this.mod_userbase.setgame(a)}});gameclass.uimgr=cc.Class.extend({uis:null,game:null,ctor:function(){this.uis={}},setgame:function(a){this.game=a}});gameclass.uimgr.prototype.gettmepparent=function(){return this._gettmepparent};gameclass.uimgr.prototype.showload=function(a){};gameclass.uimgr.prototype.closeallui=function(b){for(var a in this.uis){if(this.uis[a]==null){continue}this.closeani(this.uis[a],b);this.uis[a]=null}};gameclass.uimgr.prototype.showui=function(name,close,parent,screen){this._gettmepparent=parent;if(this._gettmepparent==null){this._gettmepparent=cc.director.getRunningScene()}if(screen==null||screen==0){gameclass.mod_platform.swicthscreen(0)}else{if(screen==1){gameclass.mod_platform.swicthscreen(1)}}var ui=this.uis[name];if(ui!=null&&close==false){return this.uis[name]}if(ui!=null&&close!=false){this.closeui(name)}var ui=eval("new "+name+"();");this.gettmepparent().addChild(ui);this.uis[name]=ui;this.uis[name].setgame(this.game);this.uis[name].show();return this.uis[name]};gameclass.uimgr.prototype.createnode=function(b,d,f,h){var c=null;c=ccs.csLoader.createNode(b);if(true==d){var e=cc.director.getVisibleSize();c.setContentSize(e.width,e.height);ccui.helper.doLayout(c);if(f!=null){var g=c.getChildByName(f);this.centernode(g)}}if(c!=null){h=h||0;var a=null;if(h){c.setAnchorPoint(0.5,0.5);c.setScale(0.3);a=cc.sequence(cc.scaleTo(0.1,1.1,1.1),cc.scaleTo(0.05,1,1),cc.callFunc(function(k){}));c.setPosition(cc.winSize.width/2,cc.winSize.height/2);c.runAction((a))}c.setTag(10000)}return c};gameclass.uimgr.prototype.closeui=function(a,b){if(this.uis[a]!=null){this.closeani(this.uis[a],b);this.uis[a]=null}};gameclass.uimgr.prototype.hasui=function(a){return this.uis[a]!=null};gameclass.uimgr.prototype.getui=function(a){return this.uis[a]};gameclass.uimgr.prototype.centernode=function(a){if(a==null){cc.log("centernode is null");return}a.setPosition((cc.winSize.width-a.getContentSize().width)/2,0)};gameclass.uimgr.prototype.closeani=function(a,b){a.destroy();a.removeFromParent()};gameclass.uimgr.prototype.updateUIMsg=function(b){for(var a in this.uis){if(this.uis[a]==null){continue}if(this.uis[a].updateUIMsg(b)){break}}};gameclass.baseui=cc.Layer.extend({sprite:null,game:null,ctor:function(){this._super()},setgame:function(a){this.game=a},show:function(){},updateUIMsg:function(a){return false},destroy:function(){},});gameclass.loginui=gameclass.baseui.extend({sprite:null,node:null,agreement:null,check:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.loginui_loginpngpjson,true);var c=ccui.helper.seekWidgetByName(this.node,"bg");if(cc.sys.localStorage.getItem("saveSetting")){var k=cc.sys.localStorage.getItem("saveSetting");k=JSON.parse(k);mod_sound.setMusicVolume(k.yinyue);mod_sound.setEffectsVolume(k.yinxiao)}else{mod_sound.setMusicVolume(0.5);mod_sound.setEffectsVolume(0.5)}if(window.wx){gameclass.mod_platform.wxshare(StaticData.GAME_NAME,0,"大家一起过来玩de吧。")}this.addChild(this.node);this.check=ccui.helper.seekWidgetByName(this.node,"CheckType0");this.check.setSelected(true);this.agreement=ccui.helper.seekWidgetByName(this.node,"agreement");var a=function(m,n){switch(n){case ccui.Widget.TOUCH_ENDED:d.game.uimgr.showui("gameclass.agreement");break}};this.agreement.addTouchEventListener(a);var l=ccui.helper.seekWidgetByName(this.node,"guestBtn");l.setVisible(true);var e=ccui.helper.seekWidgetByName(this.node,"wxBtn");e.setVisible(false);var h=ccui.helper.seekWidgetByName(this.node,"codeinput");var g=ccui.helper.seekWidgetByName(this.node,"version");mod_sound.playbmg(g_music.bmg,true);if(gameclass.test=="true"){e.setVisible(false);l.setVisible(true)}else{if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_IOS){gameclass.mod_platform.startmap()}}var d=this;if(cc.sys.isNative){h.setVisible(true);l.setVisible(true);e.setVisible(false)}if(cc.sys.os===cc.sys.OS_IOS||cc.sys.os===cc.sys.OS_ANDROID){h.setVisible(false);g.setVisible(true)}else{h.setVisible(true);g.setVisible(false)}g.setVisible(true);g.setString("当前版本:"+gameclass.version);var b=function(m,n){switch(n){case ccui.Widget.TOUCH_ENDED:if(!d.check.isSelected()){d.game.uimgr.showui("gameclass.msgboxui");d.game.uimgr.uis["gameclass.msgboxui"].setString("请先同意用户协议");return}d.game.modmgr.mod_login.guestlogin(h.getString());break}};l.addTouchEventListener(b);var f=function(n,o){switch(o){case ccui.Widget.TOUCH_ENDED:if(!d.check.isSelected()){d.game.uimgr.showui("gameclass.msgboxui");d.game.uimgr.uis["gameclass.msgboxui"].setString("请先同意用户协议");return}if(cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_IOS){if(mod_userdefault.globaldata.code!=""&&(new Date()).getTime()-mod_userdefault.globaldata.time<86400000*7){d.game.modmgr.mod_login.wxlogin("")}else{mod_userdefault.globaldata.code="";gameclass.mod_platform.loginwx()}}else{if(cc.sys.os==cc.sys.OS_WINDOWS){if(cc.sys.isNative){d.game.modmgr.mod_login.guestlogin(h.getString())}else{var m=(function(p){var s=null;if(window&&window.location){var q=new RegExp("(^|&)"+p+"=([^&]*)(&|$)","i");var s=window.location.search.substr(1).match(q)}if(s!=null){return unescape(s[2])}return null})("code");m=m||h.getString();d.game.modmgr.mod_login.guestlogin(m)}}else{if(code!=null){d.game.modmgr.mod_login.wxlogin(code)}else{d.game.modmgr.mod_login.guestlogin(h.getString())}}}break}};e.addTouchEventListener(f)},showGuest:function(){var a=ccui.helper.seekWidgetByName(this.node,"guestBtn");a.setVisible(true)}});gameclass.hallui=gameclass.baseui.extend({sprite:null,node:null,wchat:null,btn_jinbi:null,ctor:function(){this._super();this._address=gameclass.mod_platform.getAddress()},show:function(){mod_sound.playbmg(g_music.bmg,true);this.node=this.game.uimgr.createnode(res.halluijson,true);if(window.wx){gameclass.mod_platform.wxshare(gameclass.title,0,"大家一起过来玩吧。")}var c=ccui.helper.seekWidgetByName(this.node,"maskLayer");this._male=ccui.helper.seekWidgetByName(this.node,"male");this._famale=ccui.helper.seekWidgetByName(this.node,"famale");this._noticeTxt=ccui.helper.seekWidgetByName(this.node,"noticeTxt");this._curGameSp=ccui.helper.seekWidgetByName(this.node,"curGameSp");this._page0=ccui.helper.seekWidgetByName(this.node,"page0");this._page1=ccui.helper.seekWidgetByName(this.node,"page1");this._gameLayer=ccui.helper.seekWidgetByName(this.node,"gameLayer");this._shareLayer=ccui.helper.seekWidgetByName(this.node,"shareLayer");this._shareLayer.setVisible(false);this.swapPage(true);this._male.setVisible(false);c.setVisible(false);c.setTouchEnabled(true);c.addTouchEventListener(function(m,n){if(n==ccui.Widget.TOUCH_ENDED){c.setVisible(false)}},this);this._gameType=staticFunction.getStorage(StaticData.HALL_CASH,StaticData.GAME_DEFAUL);this.updateCurGame();this.addChild(this.node);var g=this;this.wchat=ccui.helper.seekWidgetByName(this.node,"wchat");gameclass.createbtnpress(this.node,"buyroomcard",function(){g.game.uimgr.showui("gameclass.buycardui")});var h=ccui.helper.seekWidgetByName(this.node,"headback");h.setTouchEnabled(true);gameclass.mod_base.showtximg(h,this.game.modmgr.mod_login.logindata.imgurl,0,0,"im_headbg2");var a=ccui.helper.seekWidgetByName(this.node,"name");var b=ccui.helper.seekWidgetByName(this.node,"id");var d=ccui.helper.seekWidgetByName(this.node,"money");a.setString(this.game.modmgr.mod_login.logindata.name);b.setString(this.game.modmgr.mod_login.logindata.uid.toString());d.setString(this.game.modmgr.mod_login.logindata.card.toString());if(this.game.modmgr.mod_login.logindata.sex==0){this._male.setVisible(false);this._famale.setVisible(true)}else{this._male.setVisible(true);this._famale.setVisible(false)}for(var f=0;f<this._gameLayer.getChildrenCount();f++){var l=this._gameLayer.getChildren()[f];var e=l.getName();var k=parseInt(e.substr(4,e.length));l.gameType=k;gameclass.createbtnpress(this.node,e,function(m){g.showCreateRoom(m.gameType)})}gameclass.createbtnpress(this.node,"joinBtn",function(){g.game.uimgr.showui("gameclass.jionroomui")});gameclass.createbtnpress(this.node,"btn_setting1",function(){g.game.uimgr.showui("gameclass.couponLayer")});gameclass.createbtnpress(this.node,"createBtn",function(){if(g._gameType!=null){g.showCreateRoom(g._gameType)}else{g.swapPage(false)}});gameclass.createbtnpress(this.node,"backBtn",function(){g.swapPage(true)});gameclass.createbtnpress(this.node,"headback",function(){var m=g.game.uimgr.showui("gameclass.UserInfoView");m.updateView(g.game.modmgr.mod_login.logindata.imgurl,g.game.modmgr.mod_login.logindata.name,"ID："+g.game.modmgr.mod_login.logindata.uid,"IP："+g.game.modmgr.mod_login.logindata.ip,"地址："+g._address)});gameclass.createbtnpress(this.node,"btn_setting",function(){g.game.uimgr.showui("gameclass.settingui")});gameclass.createbtnpress(this.node,"btn_record",function(){g.game.uimgr.showui("gameclass.recordPlayList")});gameclass.createbtnpress(this.node,"btn_help",function(){g.game.uimgr.showui("gameclass.GameRuleView")});gameclass.createbtnpress(this.node,"shareBtn",function(){g._shareLayer.setVisible(true)});gameclass.createbtnpress(this.node,"shareBtn",function(){g._shareLayer.setVisible(true)});gameclass.createbtnpress(this.node,"shareCloseBtn",function(){g._shareLayer.setVisible(false)});gameclass.createbtnpress(this.node,"friendCircleBtn",function(){gameclass.mod_platform.invitefriend("",gameclass.download,StaticData.GAME_NAME+"，最好玩的棋牌游戏平台，快一起来玩吧！")});gameclass.createbtnpress(this.node,"wxFriendBtn",function(){gameclass.mod_platform.invitefriendSpoons("",gameclass.download,StaticData.GAME_NAME+"，最好玩的棋牌游戏平台，快一起来玩吧！")});gameclass.createbtnpress(this.node,"swapBtn",function(){g.swapPage(false)});gameclass.createbtnpress(this.node,"shopBtn",function(){g.game.uimgr.showui("gameclass.shopView")});this.updategonggao();this.schedule(function(){this.game.modmgr.mod_center.getmapinfo()},1);if(g_will_room!=0){g.game.modmgr.mod_login.joinwithroomid(g_will_room);g_will_room=0}},updateCurGame:function(){if(this._gameType!=null){var a=StaticData.getRoomSetFromType(this._gameType);this._curGameSp.setTexture(a.nameIcon)}},setCurGame:function(a){this._gameType=a;staticFunction.setStorage(StaticData.HALL_CASH,StaticData.GAME_DEFAUL,a);this.updateCurGame()},showCreateRoom:function(a){this.setCurGame(a);this.game.uimgr.showui("gameclass.createroomui")},swapPage:function(a){if(a){this._page0.setVisible(true);this._page1.setVisible(false)}else{this._page0.setVisible(false);this._page1.setVisible(true)}},update:function(){var a=ccui.helper.seekWidgetByName(this.node,"money");a.setString(this.game.modmgr.mod_login.logindata.card);a.runAction(cc.blink(1,2))},updategonggao:function(){var b=ccui.helper.seekWidgetByName(this.node,"pmdInfo");b.setString(this.game.modmgr.mod_center.gonggao);b.ignoreContentAdaptWithSize(true);b.stopAllActions();var a=cc.repeatForever(cc.sequence(cc.moveTo(20,cc.p(0-b.getContentSize().width,b.getPosition().y)),cc.moveTo(0,cc.p(ccui.helper.seekWidgetByName(this.node,"pmdBack").getContentSize().width,b.getPosition().y))));b.runAction(a)},updateMailPoint:function(){var a=this.game.modmgr.mod_center.notice.length;var b="";if(this.game.modmgr.mod_center.notice.length!=0){b=this.game.modmgr.mod_center.notice[a-1].context}this._noticeTxt.setString(b)},updateareainfo:function(){},});gameclass.mail=gameclass.baseui.extend({node:null,context:null,title:null,img_titles:[],ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.mailjson,true);this.addChild(this.node);var f=this;gameclass.createbtnpress(this.node,"close",function(){f.game.uimgr.closeui("gameclass.mail",true)});this.context=ccui.helper.seekWidgetByName(this.node,"context");this.context.setString("");this.title=ccui.helper.seekWidgetByName(this.node,"title");if(this.game.modmgr.mod_center.notice==null){return}var a=function(h,k){switch(k){case ccui.Widget.TOUCH_ENDED:for(var g=0;g<f.img_titles.length;g++){if(g==h.index){f.img_titles[g].loadTexture(res.btn_title1,ccui.Widget.LOCAL_TEXTURE)}else{f.img_titles[g].loadTexture(res.btn_title2,ccui.Widget.LOCAL_TEXTURE)}}f.context.setString(f.game.modmgr.mod_center.notice[f.game.modmgr.mod_center.notice.length-1-h.index].context);f.game.modmgr.mod_center.sendReadMail(f.game.modmgr.mod_center.notice[f.game.modmgr.mod_center.notice.length-1-h.index].id);break}};for(var b=0;b<this.game.modmgr.mod_center.notice.length;b++){var d=new ccui.Layout();d.index=b;d.setTouchEnabled(true);var c=new ccui.ImageView();c.loadTexture(res.btn_title2,ccui.Widget.LOCAL_TEXTURE);c.setAnchorPoint(cc.p(0.5,0.5));d.addChild(c);d.setContentSize(c.getContentSize());c.setPosition(c.getContentSize().width/2,c.getContentSize().height/2);this.img_titles[b]=c;this.title.pushBackCustomItem(d);d.addTouchEventListener(a);var e=new ccui.Text(this.game.modmgr.mod_center.notice[this.game.modmgr.mod_center.notice.length-1-b].title,"Arial",25);c.addChild(e);e.setPosition(c.getContentSize().width/2,c.getContentSize().height/2)}},});gameclass.createroomui=gameclass.baseui.extend({node:null,_clubId:0,_clubRoomIndex:0,_rightContain:null,_rangeCtrArr:[],_gameType:null,ctor:function(){this._super();this._clubId=0;this._clubRoomIndex=0;this._gameType=0},setclubid:function(a,b){this._clubId=a;this._clubRoomIndex=b},show:function(){this.node=this.game.uimgr.createnode(res.createroomjson,true);this.addChild(this.node);this._rightContain=ccui.helper.seekWidgetByName(this.node,"rightContain");this._okBtn=ccui.helper.seekWidgetByName(this.node,"okBtn");this._okDefaultX=this._okBtn.getPositionX();this._rangeCtrArr=[];var a=staticFunction.getStorage(StaticData.HALL_CASH,StaticData.GAME_DEFAUL);this._setObj=StaticData.getRoomSetFromType(a);this.changeTab();this.updateRight();var b=this;gameclass.createbtnpress(this.node,"backBtn",function(){b.game.uimgr.closeui("gameclass.createroomui")});gameclass.createbtnpress(this.node,"okBtn",function(){b.createHandle()})},createHandle:function(c){var g=this._setObj;var e=this.saveStorage();var b=e.comboboxArr;var d=e.rangeArr;var a=g.param1Arr[0][b[0]];var h=this.getGameParam(g.gameType,g.param1Arr,b,d);var f=this.getGameParam2(g.gameType,g.param1Arr,b,d);if(this._clubId>0){this.game.uimgr.closeui("gameclass.createroomui");this.game.uimgr.uis["gameclass.clubmanger"].setClubRoom(g.gameType,h,0,a,this._clubRoomIndex)}else{cc.log("comboboxArr="+b+",card=="+a+",param1="+h+",param2="+f);this.game.modmgr.mod_login.createroom(g.gameType,a,h,f,c)}},getGameParam:function(c,b,d,e){var a=0;if(c==gameclass.gamehlgc){a=e[0]*100000+b[6][d[6]+1]*10000+b[5][d[5]]*1000+b[4][d[4]]*100+b[3][d[3]]*10+b[1][d[1]]}else{if(c==gameclass.gameddz){a=b[3][d[3]]*1000+b[2][d[2]]*100+b[1][d[1]]*10+b[4][d[4]]}else{if(c==gameclass.gamelzddz){a=b[3][d[3]]*1000+b[2][d[2]]*100+b[1][d[1]]*10+b[4][d[4]]}else{if(c==gameclass.gamesaolei){a=b[1][d[1]]*10}else{if(c==gameclass.gamewolong){a=b[8][d[8]]*1000+b[7][d[7]]*100+b[2][d[2]]*10+b[1][d[1]]}}}}}return a},getGameParam2:function(c,b,d,e){var a=0;if(c==gameclass.gamewolong){a=b[6][d[6]]*1000+b[5][d[5]]*100+b[4][d[4]]*10+b[3][d[3]]}else{if(c==gameclass.gamesaolei){a=e[0]}else{if(c==gameclass.gamehlgc){a=b[2][d[2]]}}}return a},saveStorage:function(){var a=this._setObj;var f={comboboxArr:[],rangeArr:[]};var h=[];var g=ccui.helper.seekWidgetByName(this.node,"tab"+a.gameType);var d=a.param1Arr.length;for(var b=0;b<d;b++){var k=g.getChildByName("type"+b);var e=k.getChildByName("cbContain");if(e!=null){h.push(this.getCbGroupIndex(e))}var c=k.getChildByName("cbNoneContain");if(c!=null){h.push(this.getCbGroupIndex(c))}}f.comboboxArr=h;f.rangeArr=this.getRangeArray(a.gameType);staticFunction.setStorage(StaticData.ROOM_SET_STORAGE_KEY,StaticData.ROOM_GAMETYPE_PREV+a.gameType,f);return f},changeTab:function(){var d=this._setObj;for(var b=0;b<this._rightContain.getChildrenCount();b++){var c=this._rightContain.getChildren()[b];var a=c.getName();var e=parseInt(a.substr(3,a.length));if(e==d.gameType){c.setVisible(true)}else{c.setVisible(false)}}},updateRight:function(){var c=this._setObj;var b=staticFunction.getStorage(StaticData.ROOM_SET_STORAGE_KEY,StaticData.ROOM_GAMETYPE_PREV+c.gameType);if(b==null){b={};var a=c.default1Arr;b.comboboxArr=a;b.rangeArr=[];staticFunction.setStorage(StaticData.ROOM_SET_STORAGE_KEY,StaticData.ROOM_GAMETYPE_PREV+c.gameType,b)}this._gameType=c.gameType;this.updateCbView(c.gameType,b.comboboxArr);this.updateInfoView(c.gameType);this.updateRangeView(c.gameType)},updateCbView:function(p,h){var k=ccui.helper.seekWidgetByName(this.node,"tab"+p);var o=false;for(var d=0;d<h.length;d++){var l=h[d];var q=k.getChildByName("type"+d);var g=q.getChildByName("cbContain");this.updateCbContain(g,l);var e=q.getChildByName("cbNoneContain");this.updateCbNoneContain(e,l);if(d==5){var n=e.getChildByName("cb0");if(n.isSelected()){o=true}else{o=false}var m=k.getChildByName("type6");var a=m.getChildByName("cbNoneContain");var f=a.getChildByName("cb1");if(o){f.setSelected(true)}}}if(p==gameclass.gamehlgc){var c=ccui.helper.seekWidgetByName(this.node,"tab"+gameclass.gamehlgc);var r=ccui.helper.seekWidgetByName(c,"type1");var b=ccui.helper.seekWidgetByName(r,"cb0");if(b.isSelected()){this.gameHlgcCbSpecial(0)}else{this.gameHlgcCbSpecial(1)}}},updateInfoView:function(a){var f=ccui.helper.seekWidgetByName(this.node,"tab"+a);var b=f.getChildByName("infoContain");if(b==null){return}for(var d=0;d<b.getChildrenCount();d++){var e=b.getChildren()[d];var g=e.getChildByName("info");g.setVisible(false);var c=e.getChildByName("btn");c.info=g;c.addTouchEventListener(function(h,k){switch(k){case ccui.Widget.TOUCH_BEGAN:h.info.setVisible(true);break;default:h.info.setVisible(false);break}})}},updateRangeView:function(a){this._rangeCtrArr=[];var d=ccui.helper.seekWidgetByName(this.node,"tab"+a);var f=d.getChildByName("rangeContain");if(f==null){return}var e=[];for(var b=0;b<f.getChildrenCount();b++){var c=f.getChildren()[b];var g=new gameclass.rangeControl(c,1,4,[1,2,3,4]);e.push(g)}this._rangeCtrArr.push({gameType:a,rangeArr:e})},getRangeArray:function(b){var a=[];for(var d=0;d<this._rangeCtrArr.length;d++){var f=this._rangeCtrArr[d];var e=f.rangeArr;if(f.gameType==b){for(var c=0;c<e.length;c++){a.push(e[c]._curValue)}}}return a},updateCbContain:function(g,d){if(g==null){return}var c=g.getChildrenCount();for(var e=0;e<c;e++){var b=g.getChildren()[e];b.allowNone=true;var f=b.getChildByName("cbContain");if(f!=null){var a=d-1;if(a<0){a=0}this.updateCbContain(f,a);if(d==0){b.setSelected(false)}else{b.setSelected(true)}f.setVisible(b.isSelected())}else{if(c>1){if(e==d){b.setSelected(true)}else{b.setSelected(false)}b.addEventListener(this.checkBoxClick,this)}else{if(d==0){b.setSelected(false)}else{b.setSelected(true)}if(b.getTag()==129){return}else{b.addEventListener(this.checkBoxClick,this)}}}}},updateCbNoneContain:function(e,c){if(e==null){return}var b=e.getChildrenCount();for(var d=0;d<b;d++){var a=e.getChildren()[d];a.allowNone=true;a.addEventListener(this.checkBoxClick,this);if(b>1){if(d==c){a.setSelected(true)}else{a.setSelected(false)}}else{if(c==0){a.setSelected(false)}else{a.setSelected(true)}}a.isSelect=a.isSelected()}},getCbGroupIndex:function(f){var b=f.getChildrenCount();for(var c=0;c<b;c++){var a=f.getChildren()[c];var d=a.isSelected();var e=a.getChildByName("cbContain");if(e!=null){if(d){return this.getCbGroupIndex(e)+1}else{return 0}}else{if(b<=1){if(a.isSelected()){return 1}else{return 0}}else{if(d){return c}else{continue}}}}return -1},checkBoxParentClick:function(a,b){var c=a.getChildByName("cbContain");if(b==ccui.CheckBox.EVENT_SELECTED){c.setVisible(true)}else{c.setVisible(false)}},checkBoxClick:function(h,o){var m=h.getParent();if(this._gameType==gameclass.gamehlgc){var n=m.getParent();var c=n.getParent();var g=c.getChildByName("type5");var k=c.getChildByName("type6");var d=k.getChildByName("cbNoneContain");var b=d.getChildByName("cb0");var r=d.getChildByName("cb1");if(m.getTag()==145||m.getTag()==150){return}}if(m==null){return}var a=m.getChildrenCount();for(var f=0;f<a;f++){var e=m.getChildren()[f];if(a>1){if(e==h){if(e.allowNone&&e.isSelect){e.setSelected(false)}else{e.setSelected(true)}}else{e.setSelected(false)}e.isSelect=e.isSelected()}else{if(e==h){var q=e.isSelect;if(e.allowNone&&e.isSelect){e.setSelected(false);e.allowNone=false}else{e.setSelected(true);e.allowNone=true}}e.isSelect=e.isSelected()}}if(this._gameType==gameclass.gamehlgc){var l=g.getChildByName("cbNoneContain");if(l.getChildren()[0].isSelected()){b.setSelected(false);b.setTouchEnabled(false);r.setSelected(true);r.setTouchEnabled(false)}if(m.getTag()==155){var p=m.getChildren()[0];if(p.isSelected()){b.setSelected(false);b.setTouchEnabled(false);r.setSelected(true);r.setTouchEnabled(false)}else{b.setTouchEnabled(true);r.setTouchEnabled(true)}}}var o=m.getParent();if(o==null){return}if(this._setObj==null){return}if(this._setObj.gameType==gameclass.gamehlgc&&o.getName()=="type1"){if(h.getName()=="cb0"){this.gameHlgcCbSpecial(0)}else{if(h.getName()=="cb1"){this.gameHlgcCbSpecial(1)}}}},gameHlgcCbSpecial:function(e){var f=ccui.helper.seekWidgetByName(this.node,"tab"+gameclass.gamehlgc);var g=ccui.helper.seekWidgetByName(f,"type0");var d=ccui.helper.seekWidgetByName(g,"cb0");var b=ccui.helper.seekWidgetByName(g,"cb1");var c=ccui.helper.seekWidgetByName(d,"detail");var a=ccui.helper.seekWidgetByName(b,"detail");if(e==0){c.setString("8局（1个房钻）");a.setString("16局（2个房钻）")}else{c.setString("8局（4个房钻）");a.setString("16局（8个房钻）")}},destroy:function(){}});gameclass.recordPlayList=gameclass.baseui.extend({mod_record:null,recordRoomid:null,index:0,btnGroupCtr:null,btnStyle:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.RecordReplayList,true);this.addChild(this.node);this.mod_record=new gameclass.mod_record();this.mod_record.setgame(this.game);this.listView=ccui.helper.seekWidgetByName(this.node,"listView");this._replayTxt=ccui.helper.seekWidgetByName(this.node,"replayTxt");this.btnStyle=this.listView.getChildByName("btnStyle");this.btnGroupCtr=new gameclass.buttonGroupControl(this.changeTab.bind(this));this.listView.removeAllChildren();var d=[];var a=StaticData.roomSetArr.length;for(var f=0;f<a;f++){var e=this.btnStyle.clone();var b=staticFunction.addTabBtn(e,StaticData.roomSetArr[f].normalImg,StaticData.roomSetArr[f].selectImg);var c=b[1];c.setPositionX(c.getPositionX()-4);c.setPositionY(c.getPositionY()+7);this.listView.addChild(e);d.push(new gameclass.baseButtonControl(e,["normal"],["select"]))}this.btnGroupCtr.initData(d);this.btnGroupCtr.setSelectIndex(0);this.mod_record.setCurUserid(this.game.modmgr.mod_login.logindata.uid);this.gameList=ccui.helper.seekWidgetByName(this.node,"rightListView");var g=this;gameclass.createbtnpress(this.node,"btn_colse",function(){g.game.uimgr.closeui("gameclass.recordPlayList")});gameclass.createbtnpress(this.node,"replayBtn",function(){var p=g._replayTxt.getString();var h=0,n=0,m=0;if(p.length==10||p.length==14){h=gameclass.gamehlgc;n=p.substring(0,8);m=p.substring(8,p.length);g.mod_record.setCurBureauid(Number(n));g.mod_record.setCurUserid(Number(m));g.mod_record.setCurGameid(Number(h));g.game.uimgr.showui("gameclass.ReplayWindow").setMod(g.mod_record);g.game.uimgr.closeui("gameclass.hallui")}else{if(p.length==15){h=p.substring(0,1);n=p.substring(1,9);m=p.substring(9,15);if(h==gameclass.gameddz||h==gameclass.gamelzddz){g.mod_record.setCurBureauid(Number(n));g.mod_record.setCurUserid(Number(m));g.mod_record.setCurGameid(Number(h));g.game.uimgr.showui("gameclass.ddzrecord").setMod(g.mod_record);g.game.uimgr.closeui("gameclass.hallui")}else{if(h==gameclass.gameNewNiuNiu){var o={type:Number(h),uid:Number(m)};var l=p.substring(1,7);var k=null;g.mod_record.getRecordListStatic(gameclass.gameNewNiuNiu,o,function(){cc.each(g.mod_record.s_data,function(r,q){if(q==l){k=r}});if(k){g.game.uimgr.showui("gameclass.niuniurecord").showRecord_nn(k.ot,k.children,k.time);g.game.uimgr.closeui("gameclass.hallui")}})}else{g.showToast("数据错误!")}}}else{g.showToast("输入有误，请重新输入!")}}});g.changeTab()},showToast:function(b){if(this.node.getChildByTag(123456)){return}var d=this;d.node.removeChildByTag(123456);var a=new cc.Sprite(res.img_input);a.setPosition(this.node.getContentSize().width/2,100);a.setOpacity(160);a.setTag(123456);var c=new cc.LabelTTF(b,"Arial",25);c.setPosition(a.getContentSize().width/2,a.getContentSize().height/2);a.addChild(c);d.node.addChild(a);d.scheduleOnce(function(){d.node.removeChildByTag(123456)},3)},changeTab:function(){var a=this.btnGroupCtr._selectIndex;var c=StaticData.roomSetArr[a];var b={type:c.gameType,uid:this.game.modmgr.mod_login.logindata.uid};this.showRecordList(b,c.gameType)},showRecordList:function(b,a){var c=this;c.mod_record.getRecordList(a,b,function(d){c.showData(a)})},getDate:function(a){var b=new Date(a*1000);var a=(b.getFullYear())+"-"+(b.getMonth()+1)+"-"+(b.getDate())+" "+(b.getHours())+":"+(b.getMinutes())+":"+(b.getSeconds());return a},showData:function(q){this.gameList.removeAllChildren();var b=this.btnGroupCtr._selectIndex;var f=StaticData.roomSetArr[b];var l=this;var s;for(var g in this.mod_record.s_data){var c=this.mod_record.s_data[g];s=f.gameType;for(var d=0;d<c.children.length;d++){if(c.children[d].type){s=c.children[d].type;break}}if(s!=f.gameType){continue}var t=this.game.uimgr.createnode(res.recordListCell,true).getChildByName("Panel_1");t.removeFromParent(false);this.gameList.pushBackCustomItem(t);ccui.helper.seekWidgetByName(t,"roomId").setString(Number(g));ccui.helper.seekWidgetByName(t,"name").setString(f.name);ccui.helper.seekWidgetByName(t,"time").setString("时间:"+this.getDate(c.children[0].time));var a=ccui.helper.seekWidgetByName(t,"stateWin");var p=ccui.helper.seekWidgetByName(t,"stateLost");var o={};if(q==gameclass.gamehlgc||q==gameclass.gameddz||q==gameclass.gamelzddz||q==gameclass.gameszp||q==gameclass.gamewolong){o=c.children[0].person}else{o=c.children[0].info}var k=o.length;for(var e=0;e<6;e++){var r=ccui.helper.seekWidgetByName(t,"player"+e);r.setVisible(e<k);if(e>k-1){continue}r.setString(o[e].name);var n=0;if(o[e].total){n=o[e].total}else{for(var d=0;d<c.children.length;d++){if(q==gameclass.gamehlgc||q==gameclass.gameddz||q==gameclass.gamelzddz||q==gameclass.gameszp||q==gameclass.gamewolong){n+=c.children[d].person[e].score}else{n+=c.children[d].info[e].score}}}if(o[e].uid==this.game.modmgr.mod_login.logindata.uid){if(n==0){a.setVisible(false);p.setVisible(false)}else{if(n>0){a.setVisible(true);p.setVisible(false)}else{a.setVisible(false);p.setVisible(true)}}}r.getChildByName("score").setString(n)}var h=ccui.helper.seekWidgetByName(t,"btn_chakan");h.roomid=Number(g);h._type=1;if(q==gameclass.gamehlgc){h._type=2}h.addTouchEventListener(l.touchEvent_gc,l)}},touchEvent_gc:function(a,b){var c=this;switch(b){case ccui.Widget.TOUCH_ENDED:c.mod_record.setCurRoomid(a.roomid);this.game.uimgr.closeui("gameclass.recordPlayList");this.game.uimgr.showui("gameclass.recordBureau").setMod(c.mod_record,a._type);break;default:break}},destroy:function(){this.btnGroupCtr.destroy()},});gameclass.recordBureau=gameclass.baseui.extend({gameType:0,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.RecordBureau,true);this.addChild(this.node);this.recorBureaulist=ccui.helper.seekWidgetByName(this.node,"ListView_1");gameclass.createbtnpress(this.node,"btn_colse",function(){this.game.uimgr.closeui("gameclass.recordBureau");this.game.uimgr.showui("gameclass.recordPlayList")})},setMod:function(b,c){var e=this;e.mod_record=b;var d=e.mod_record.getBureauList();var a=d.children;a.sort(function(g,f){return g.time>f.time});e.setClickItem(a,c)},setClickItem:function(e,l){var g=this;g.gameType=g.mod_record.curGameid;g.recorBureaulist.removeAllChildren();for(var f=0;f<e.length;f++){var n=this.game.uimgr.createnode(res.recordCell,true).getChildByName("Panel_1");n.setContentSize(cc.size(n.getContentSize().width,130));n.removeFromParent(false);this.recorBureaulist.pushBackCustomItem(n);var m=[];if(g.gameType==gameclass.gamehlgc||g.gameType==gameclass.gameddz||g.gameType==gameclass.gamelzddz||g.gameType==gameclass.gamewolong){m=e[f].person}else{m=e[f].info}var h=m.length;for(var d=0;d<4;d++){var o=ccui.helper.seekWidgetByName(n,"player"+d);var b=ccui.helper.seekWidgetByName(n,"score"+d);b.setVisible(d<h);if(d>h-1){o.setString("");b.setString("");continue}o.setString(m[d].name);b.setString(m[d].score)}var k=ccui.helper.seekWidgetByName(n,"rankTxt");k.setString((f+1).toString());var a=parseInt(e[f].ot/100);var c=ccui.helper.seekWidgetByName(n,"btn_replay");c.bureauid=e[f].roomid;c.nn_time=e[f].time;c.nn_ju=f;if(l==1){c.addTouchEventListener(g.hf_touchEvent,g)}else{if(l==2){c.addTouchEventListener(g.hf_touchEvent_gc,g)}}if(g.mod_record.curGameid==gameclass.gamewolong){c.itemIndex=e[f].roomid;c.recordData=e}else{if(g.mod_record.curGameid==gameclass.gamelyc){c.nn_data=e[f].info}else{c.nn_data=e[f]}}}},getDate:function(a){var b=new Date(a*1000);var a=(b.getFullYear())+"-"+(b.getMonth()+1)+"-"+(b.getDate())+" "+(b.getHours())+":"+(b.getMinutes())+":"+(b.getSeconds());return a},hf_touchEvent_gc:function(a,b){var c=this;switch(b){case ccui.Widget.TOUCH_ENDED:c.mod_record.setCurBureauid(a.bureauid);c.game.uimgr.closeui("gameclass.recordBureau");c.game.uimgr.closeui("gameclass.hallui");c.game.uimgr.showui("gameclass.ReplayWindow").setMod(c.mod_record);break;default:break}},hf_touchEvent:function(b,c){var e=this;switch(c){case ccui.Widget.TOUCH_ENDED:e.game.uimgr.closeui("gameclass.recordBureau");e.game.uimgr.closeui("gameclass.hallui");e.mod_record.setCurBureauid(b.bureauid);if(e.gameType==gameclass.gamettz){}else{if(e.gameType==gameclass.gameddz||e.gameType==gameclass.gamelzddz){e.game.uimgr.showui("gameclass.ddzrecord").setMod(e.mod_record)}else{if(e.gameType==gameclass.gamewolong){var d=b.itemIndex;var a=b.recordData;e.game.uimgr.showui("gameclass.woLongRecord").setMod(a,d)}else{}}}break;default:break}},});gameclass.exitroom=gameclass.baseui.extend({node:null,pl_agree:null,pl_wait:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.exitroom,true);this.pl_agree=ccui.helper.seekWidgetByName(this.node,"agree");this.pl_wait=ccui.helper.seekWidgetByName(this.node,"wait");this.addChild(this.node);var a=this;gameclass.createbtnpress(this.node,"cancelbtn",function(){a.game.uimgr.closeui("gameclass.exitroom");a.mod_niuniu.nodissmissroom()});gameclass.createbtnpress(this.node,"okbtn",function(){a.mod_niuniu.dissmissroom()})},setData:function(l,f){this.mod_niuniu=l;var h=this;var m=ccui.helper.seekWidgetByName(this.node,"leftTime");var d=cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(function(){var p=h.mod_niuniu.mywebsocket.getcurservertime();var o=f.time-p;if(o<=0){o=0}m.setString(o+"秒后解散房间")})));m.runAction(d);var b;if(this.mod_niuniu.roominfo){b=this.mod_niuniu.roominfo.person}else{b=this.mod_niuniu.view.personData.person}for(var g=0;g<5;g++){var c=ccui.helper.seekWidgetByName(this.node,"p"+(g+1).toString());c.setVisible(g<b.length);if(g>=b.length){continue}var n=b[g];cc.log(n);gameclass.mod_base.showtximg(c,n.imgurl,0,0,"im_headbg4");ccui.helper.seekWidgetByName(c,"name").setString(n.name);var a=ccui.helper.seekWidgetByName(c,"stateIcon");var k=0;for(var e=0;e<f.agree.length;e++){if(f.agree[e]==n.uid){if(e==0){k=2}else{k=1}}}if(k==0){a.setTexture("res/ui/qhqp/12-apply/qh_img_waitting@2x.png")}else{if(k==1){a.setTexture("res/ui/qhqp/12-apply/qh_img_agree@2x.png")}else{a.setTexture("res/ui/qhqp/12-apply/qh_img_agree@2x.png")}}if(n.uid==this.game.modmgr.mod_login.logindata.uid){this.pl_agree.setVisible(k==0);this.pl_wait.setVisible(k!=0)}}}});gameclass.msgboxui=gameclass.baseui.extend({sprite:null,node:null,onok:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.msgbox,true);this.addChild(this.node);var a=this;gameclass.createbtnpress(this.node,"Panel_1",function(){a.game.uimgr.closeui("gameclass.msgboxui")});gameclass.createbtnpress(this.node,"cancelbtn",function(){a.game.uimgr.closeui("gameclass.msgboxui")});gameclass.createbtnpress(this.node,"okbtn",function(){a.game.uimgr.closeui("gameclass.msgboxui");if(a.onok!=null){a.onok()}})},setString:function(c,a){this.onok=a;var b=ccui.helper.seekWidgetByName(this.node,"msg");b.setString(c)}});gameclass.settingui=gameclass.baseui.extend({sprite:null,node:null,musicSlider:null,soundSlider:null,btn_change:null,btn_ok:null,sliderMusic:null,sliderEffects:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.setting,true,1);this.musicSlider=ccui.helper.seekWidgetByName(this.node,"musicSlider");this.soundSlider=ccui.helper.seekWidgetByName(this.node,"effectSlider");this.addChild(this.node);var a=ccui.helper.seekWidgetByName(this.node,"Panel_1").getChildren();if(gameclass.mod_hlgc.isSmothing==false){a[0].getChildByName("Check").setSelected(true);a[1].getChildByName("Check").setSelected(false)}else{if(gameclass.mod_hlgc.isSmothing==true){a[0].getChildByName("Check").setSelected(false);a[1].getChildByName("Check").setSelected(true)}}for(var b=0;b<a.length;b++){var d=a[b];if(d.getTag()==0){d.addClickEventListener(this.checkBoxCallBack.bind(this))}}var f=this;gameclass.createbtnpress(this.node,"root",function(){f.game.uimgr.closeui("gameclass.settingui")});gameclass.createbtnpress(this.node,"exitLogin",function(){var g={yinyue:f.sliderMusic,yinxiao:f.sliderEffects};g=JSON.stringify(g);f.saveSetting(g);f.game.uimgr.closeui("gameclass.settingui")});this.btn_change=ccui.helper.seekWidgetByName(this.node,"change");gameclass.createbtnpress(this.node,"change",function(){mod_userdefault.globaldata.code="";mod_userdefault.writeglobaljson();f.game.modmgr.mod_login.backlogin()});var e=function(h,k){switch(k){case ccui.Slider.EVENT_PERCENT_CHANGED:var m=h;var l=m.getPercent();var g=l.toFixed(0)/100;f.sliderMusic=g;mod_sound.setMusicVolume(g);break;default:break}};var c=function(h,k){switch(k){case ccui.Slider.EVENT_PERCENT_CHANGED:var m=h;var l=m.getPercent();f.sliderEffects=l;var g=l.toFixed(0)/100;f.sliderEffects=g;mod_sound.setEffectsVolume(g);break;default:break}};this.sliderMusic=mod_sound.getMusicVolume();this.sliderEffects=mod_sound.getEffectsVolume();this.musicSlider.setPercent(this.sliderMusic*100);this.musicSlider.addEventListener(e);this.soundSlider.setPercent(this.sliderEffects*100);this.soundSlider.addEventListener(c)},checkBoxCallBack:function(c){var a=c.getParent().getChildren();if(!c.getTag()){for(var b=0;b<a.length;b++){a[b].getChildByName("Check").setSelected(false)}c.getChildByName("Check").setSelected(true)}if(a[0].getChildByName("Check").isSelected()){gameclass.mod_hlgc.isSmothing=false}else{if(a[1].getChildByName("Check").isSelected()){gameclass.mod_hlgc.isSmothing=true}}},saveSetting:function(a){cc.sys.localStorage.setItem("saveSetting",a)},setCheckState:function(b){for(var c=0;c<this.btnGroupCtr.length;c++){var a=this.btnGroupCtr[c].getChildren()[0];a.setSelected(false)}var d=this.btnGroupCtr[b].getChildren()[0];d.setSelected(true)},getSetting:function(){return cc.sys.localStorage.getItem("saveSetting")},destroy:function(){cc.eventManager.removeCustomListeners(gameclass.LOGIN_SET_TABBTN_CLICK)},});gameclass.settingui.gmusic=25;gameclass.settingui.gamesound=25;gameclass.gameStorageKey="gameStorageKey";gameclass.loginSetKey="loginSetKey";gameclass.LOGIN_SET_TABBTN_CLICK="gameclass.LOGIN_SET_TABBTN_CLICK";gameclass.TAB_LOGIN_TO_GOLD=0;gameclass.TAB_LOGIN_TO_ROOM_CARD=1;gameclass.LOGIN_TO_ROOM_DEFAULT=0;gameclass.resultoneui=gameclass.baseui.extend({sprite:null,node:null,mod_niuniu:null,niuniutable:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.resultoneui,true);this.addChild(this.node)},setniuniumod:function(g,c,t){this.mod_niuniu=g;this.niuniutable=c;this.niuniutable.clock.setVisible(false);var o=this;gameclass.createbtnpress(this.node,"sendReady",function(){if(o.mod_niuniu.isover){o.game.uimgr.showui("gameclass.resultui");o.game.uimgr.uis["gameclass.resultui"].setData(o.mod_niuniu)}o.game.uimgr.closeui("gameclass.resultoneui");o.mod_niuniu.gameready()});ccui.helper.seekWidgetByName(this.node,"roomid").setString("房间号:"+this.mod_niuniu.roominfo.roomid);var f=new Date();var m=f.Format("yy-MM-dd hh:mm");ccui.helper.seekWidgetByName(this.node,"time").setString(m);var d=this.mod_niuniu.roominfo.step;if(d>this.mod_niuniu.roominfo.maxstep){d=this.mod_niuniu.roominfo.maxstep}else{if(d==0){d=1}}ccui.helper.seekWidgetByName(this.node,"step").setString("局数:"+d+"/"+this.mod_niuniu.roominfo.maxstep);var l=[];var e=[];for(var s=0;s<this.mod_niuniu.gameniuniuinfo.info.length;s++){var t=this.mod_niuniu.gameniuniuinfo.info[s];if(t.dealer){l[0]=t;e[0]=this.mod_niuniu.roominfo.person[s]}}for(var s=0;s<this.mod_niuniu.gameniuniuinfo.info.length;s++){var t=this.mod_niuniu.gameniuniuinfo.info[s];if(!t.dealer){l[l.length]=t;e[e.length]=this.mod_niuniu.roominfo.person[s]}}for(var s=0;s<5;s++){var h=ccui.helper.seekWidgetByName(this.node,"playerbg"+s);if(s<l.length){var t=l[s];var n=e[s];h.setVisible(true);gameclass.mod_base.showtximg(ccui.helper.seekWidgetByName(h,"icon"),n.imgurl,0,0,"im_headbg3");ccui.helper.seekWidgetByName(h,"playername").setString(n.name);ccui.helper.seekWidgetByName(h,"id").setString("ID:"+n.uid);ccui.helper.seekWidgetByName(h,"zhuang").setVisible(t.dealer);var r=ccui.helper.seekWidgetByName(h,"cnode");for(var p=0;p<5;p++){var a=t.card[p];var k=this.niuniutable.crateBtnCard(a);k.setScale(0.7);k.setPositionX(p*22);r.addChild(k)}var b=cc.Sprite.create();b.initWithSpriteFrameName("nn331_img_niu"+t.type+".png");r.addChild(b);b.setScale(0.45);b.setPosition(38.72,-25.44);var q=ccui.helper.seekWidgetByName(h,"score");if(t.score>0){q.setString("+"+t.score)}else{q.setString(""+t.score)}}else{h.setVisible(false)}}}});gameclass.jionroomui=gameclass.baseui.extend({sprite:null,node:null,arrnum:null,ctor:function(){this._super();this.arrnum=[];for(var a=0;a<6;a++){this.arrnum[a]=-1}},show:function(){this.node=this.game.uimgr.createnode(res.jionroomui,true);this.addChild(this.node);var b=this;gameclass.createbtnpress(this.node,"backBtn",function(){b.game.uimgr.closeui("gameclass.jionroomui")});gameclass.createbtnpress(this.node,"closeBtn",function(){b.game.uimgr.closeui("gameclass.jionroomui")});gameclass.createbtnpress(this.node,"Panel_1_0",function(){b.game.uimgr.closeui("gameclass.jionroomui")});gameclass.createbtnpress(this.node,"cs",function(){b.cleanup()});gameclass.createbtnpress(this.node,"sc",function(){b.cleanupback()});for(var a=0;a<10;a++){gameclass.createbtnpress(this.node,"btn"+(a).toString(),function(d,c,e){b.pressnum(e)},function(){},function(){},a)}for(var a=0;a<6;a++){if(this.arrnum[a]<0){ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString(this.arrnum[a].toString())}}},pressnum:function(c){for(var d=0;d<6;d++){if(this.arrnum[d]==-1){this.arrnum[d]=c;if(d==5){var a=0;for(var b=0;b<6;b++){a+=this.arrnum[b];if(b<5){a*=10}}this.game.modmgr.mod_login.joinwithroomid(Number(a))}break}}for(var d=0;d<6;d++){if(this.arrnum[d]<0){ccui.helper.seekWidgetByName(this.node,""+(d+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(d+1).toString()).setString(this.arrnum[d].toString())}}},cleanup:function(){for(var a=0;a<6;a++){this.arrnum[a]=-1}for(var a=0;a<6;a++){if(this.arrnum[a]<0){ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString(this.arrnum[a].toString())}}},cleanupback:function(){for(var a=5;a>=0;a--){if(this.arrnum[a]>=0){this.arrnum[a]=-1;break}}for(var a=0;a<6;a++){if(this.arrnum[a]<0){ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString(this.arrnum[a].toString())}}}});gameclass.resultui=gameclass.baseui.extend({sprite:null,node:null,sharelayer:null,chulitu:null,shareing:null,round:null,curtime:null,roomid:null,ctor:function(){this._super();this.shareing=false},show:function(){this.node=this.game.uimgr.createnode(res.resultui,true);var c=this;this.sharelayer=ccui.helper.seekWidgetByName(this.node,"sharelayer");this.sharelayer.setVisible(false);this.chulitu=ccui.helper.seekWidgetByName(this.node,"chulitu");this.round=ccui.helper.seekWidgetByName(this.node,"round");this.curtime=ccui.helper.seekWidgetByName(this.node,"curtime");this.roomid=ccui.helper.seekWidgetByName(this.node,"roomid");var a=new Date();var b=a.Format("yy-MM-dd hh:mm");this.curtime.setString(b);gameclass.createbtnpress(this.node,"sharelayer",function(){c.sharelayer.setVisible(false)});this.addChild(this.node);var c=this;gameclass.createbtnpress(this.node,"cancelbtn",function(){c.game.uimgr.showui("gameclass.hallui");c.game.uimgr.closeui("gameclass.resultui")});gameclass.createbtnpress(this.node,"okbtn",function(){gameclass.mod_platform.savescreen(function(d){if(window.wx){d=JSON.parse(d);if(d.error==0){c.share(d.url);c.chulitu.setString("处理完成")}c.shareing=false}},function(){if(window.wx){c.sharelayer.setVisible(true)}});if(window.wx){c.chulitu.setString("图片正在处理中");c.shareing=true}})},setData:function(k){this.mod_niuniu=k;this.roomid.setString("房间号:"+this.mod_niuniu.roominfo.roomid.toString());var m=(this.mod_niuniu.roominfo.step+1);if(m>this.mod_niuniu.roominfo.maxstep){m=this.mod_niuniu.roominfo.maxstep}var g=0;for(var e=0;e<this.mod_niuniu.gameniuniuinfo.info.length;e++){if(e==g){continue}if(this.mod_niuniu.endinfo[e].score<this.mod_niuniu.endinfo[g].score){continue}g=e}this.round.setString("局数:"+m+"/"+this.mod_niuniu.roominfo.maxstep);for(var e=0;e<5;e++){var f=ccui.helper.seekWidgetByName(this.node,"player"+e);if(e<this.mod_niuniu.gameniuniuinfo.info.length){var c=this.mod_niuniu.gameniuniuinfo.info[e];var l=this.mod_niuniu.roominfo.person[e];var n=this.mod_niuniu.endinfo[e];f.setVisible(true);gameclass.mod_base.showtximg(ccui.helper.seekWidgetByName(f,"icon"),l.imgurl,0,0,"im_headbg3");var a=ccui.helper.seekWidgetByName(f,"name").setString(l.name);var b=ccui.helper.seekWidgetByName(f,"id").setString(l.uid);var h=[];for(var d=0;d<6;d++){h[d]=ccui.helper.seekWidgetByName(f,"text"+d)}h[0].setString(n.deal.toString());h[1].setString(n.kill.toString());h[2].setString(n.dead.toString());h[3].setString(n.niu.toString());h[4].setString(n.win.toString());h[5].setString(n.score.toString());ccui.helper.seekWidgetByName(f,"win").setVisible(g==e)}else{f.setVisible(false)}}}});gameclass.resultui.prototype.share=function(a){gameclass.mod_platform.wxsharelink(StaticData.GAME_NAME+"结算","战绩",a)};gameclass.buycardui=gameclass.baseui.extend({sprite:null,node:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.buycardui,true);this.addChild(this.node);var a=this;gameclass.createbtnpress(this.node,"root",function(){a.game.uimgr.closeui("gameclass.buycardui")})}});gameclass.UserInfoView=gameclass.baseui.extend({bgLayer:null,sprite:null,node:null,headImg:null,nameTxt:null,uidTxt:null,uipTxt:null,addressTxt:null,ctor:function(){this._super()},show:function(){var a=new ccui.Layout();this.addChild(a);a.setTouchEnabled(true);a.setContentSize(cc.winSize);this.bgLayer=new cc.LayerColor(cc.color(0,0,0,155),cc.winSize.width,cc.winSize.height);a.addChild(this.bgLayer);this.node=this.game.uimgr.createnode(res.userInfoPanelJson,true);this.addChild(this.node);this.node.setPosition(cc.p(cc.winSize.width/2,cc.winSize.height/2));this.headImg=ccui.helper.seekWidgetByName(this.node,"headback_0");this.nameTxt=ccui.helper.seekWidgetByName(this.node,"name");this.uidTxt=ccui.helper.seekWidgetByName(this.node,"uid_Text");this.uipTxt=ccui.helper.seekWidgetByName(this.node,"uip_Text");this.addressTxt=ccui.helper.seekWidgetByName(this.node,"address_Text");var b=this;a.addTouchEventListener(function(c,d){if(d==ccui.Widget.TOUCH_ENDED){b.game.uimgr.closeui("gameclass.UserInfoView")}},this)},updateView:function(c,b,e,d,a){gameclass.mod_base.showtximg(this.headImg,c,0,0,"im_headbg2");this.nameTxt.setString(b);this.uidTxt.setString(e.toString());this.uipTxt.setString(d);this.addressTxt.setString(a)},});gameclass.chatui=gameclass.baseui.extend({sprite:null,node:null,left:null,chatNode:null,ctor:function(){this._super()},show:function(){var e=this;this.node=this.game.uimgr.createnode(res.chatui,true);this.btn_close=ccui.helper.seekWidgetByName(this.node,"btn_close");this.chatNode=ccui.helper.seekWidgetByName(this.node,"chatnode");this.addChild(this.node);this.left=[];var d=function(k,l){switch(l){case ccui.Widget.TOUCH_ENDED:e.mod_kwx.chat(2,""+k.index);e.game.uimgr.closeui("gameclass.chatui");break}};var a=function(k,l){switch(l){case ccui.Widget.TOUCH_ENDED:e.game.uimgr.closeui("gameclass.chatui");break}};this.btn_close.addTouchEventListener(a);var h=50;var c=50;for(var f=0;f<7;f++){this.left[f]=ccui.helper.seekWidgetByName(this.node,"left"+f);this.left[f].setItemsMargin(13)}for(var f=0;f<g_face.length;f++){var g=new ccui.Layout();g.index=f;g.setContentSize(h,c);var b=new cc.Sprite();b.initWithFile(g_face[f]);b.setAnchorPoint(cc.p(0.5,0.5));b.setPosition(30,20);if(b.getContentSize().height>b.getContentSize().width){b.setScale(c/b.getContentSize().height)}else{b.setScale(h/b.getContentSize().width)}g.addChild(b);g.setTouchEnabled(true);this.left[Math.floor(f/8)].addChild(g);g.addTouchEventListener(d)}},setmod:function(a){var o=this;this.mod_kwx=a;var n=[];var e=[];for(var h=0;h<2;h++){n[h]=ccui.helper.seekWidgetByName(this.node,"btn"+h);e[h]=ccui.helper.seekWidgetByName(this.node,"list"+h)}this.page=1;var m=function(q){o.page=q;for(var p=0;p<2;p++){n[p].getChildByName("select").setVisible(q==p);n[p].getChildByName("normal").setVisible(!n[p].getChildByName("select").isVisible());e[p].setVisible(q==p)}};m(this.page);gameclass.createbtnpress(this.node,"btn0",function(){m(0);o.chatNode.setVisible(false)});gameclass.createbtnpress(this.node,"btn1",function(){m(1);o.chatNode.setVisible(true)});gameclass.createbtnpress(this.node,"textfield",function(){});var l=ccui.helper.seekWidgetByName(this.node,"textfield");gameclass.createbtnpress(this.node,"sendbtn",function(){o.mod_kwx.chat(1,l.getString());o.game.uimgr.closeui("gameclass.chatui")});var f=[];if(this.mod_kwx.GameType==gameclass.gameddz||this.mod_kwx.GameType==gameclass.gamelzddz){f=g_chatstrDdz}else{if(this.mod_kwx.GameType==gameclass.gamewolong){f=g_chatstrNew}else{f=g_chatstr}}var d=function(p,q){switch(q){case ccui.Widget.TOUCH_ENDED:o.mod_kwx.chat(1,f[p.index]);o.game.uimgr.closeui("gameclass.chatui");break}};for(var h=0;h<f.length;h++){var k=new ccui.Layout();var b=new cc.Sprite(res.talkBg);b.setScaleX(0.97);k.index=h;k.setTouchEnabled(true);var c=new cc.LabelTTF(f[h],"Arial",22);c.setColor(cc.color(0,0,0));c.setAnchorPoint(cc.p(0,0));c.setPosition(20,10);b.setAnchorPoint(cc.p(0,0));b.setPosition(0,0);k.addChild(b);k.addChild(c);k.setContentSize(cc.size(510,55));e[1].pushBackCustomItem(k);k.addTouchEventListener(d)}for(var h=0;h<this.mod_kwx.chatlst.length;h++){var g=this.mod_kwx.chatlst[h];if(g!=null){o.pushstr(g)}}},pushstr:function(a){}});gameclass.chatuinew=gameclass.baseui.extend({sprite:null,node:null,chat_cy:[],chat_bq:[],tb_cyy:null,tb_qb:null,mod_game:null,ctor:function(){this._super()},show:function(){var g=this;this.node=this.game.uimgr.createnode(res.chatui,true);this.chat_cy[0]=ccui.helper.seekWidgetByName(this.node,"chat_cy1");this.chat_cy[1]=ccui.helper.seekWidgetByName(this.node,"chat_cy2");this.chat_bq[0]=ccui.helper.seekWidgetByName(this.node,"chat_bq1");this.chat_bq[1]=ccui.helper.seekWidgetByName(this.node,"chat_bq2");this.tb_cyy=ccui.helper.seekWidgetByName(this.node,"cyy");this.tb_qb=ccui.helper.seekWidgetByName(this.node,"qb");this.addChild(this.node);this.showCYY();gameclass.createbtnpress(this.node,"bg",function(){g.game.uimgr.closeui("gameclass.chatuinew")});gameclass.createbtnpress(this.node,"Button_close",function(){g.game.uimgr.closeui("gameclass.chatuinew")});gameclass.createbtnpress(this.node,"Button_4",function(){var h=ccui.helper.seekWidgetByName(g.node,"input").getString();if(h==""){return}g.mod_game.chat(1,h);g.game.uimgr.closeui("gameclass.chatuinew")});var e=function(h,k){switch(k){case ccui.Widget.TOUCH_BEGAN:g.showCYY();break}};this.chat_cy[1].addTouchEventListener(e);var d=function(h,k){switch(k){case ccui.Widget.TOUCH_BEGAN:g.showBQ();break}};this.chat_bq[1].addTouchEventListener(d);for(var b=1;b<=8;b++){var a=ccui.helper.seekWidgetByName(this.tb_cyy,"chat_"+b.toString());a.setTag(b);a.addTouchEventListener(f)}var d=function(h,k){switch(k){case ccui.Widget.TOUCH_ENDED:g.mod_game.chat(2,(h.getTag()-1).toString());g.game.uimgr.closeui("gameclass.chatuinew");break}};var f=function(h,k){switch(k){case ccui.Widget.TOUCH_ENDED:g.mod_game.chat(1,g_chatstr[h.getTag()-1]);g.game.uimgr.closeui("gameclass.chatuinew");break}};for(var b=1;b<=20;b++){var c=ccui.helper.seekWidgetByName(this.tb_qb,"b_"+b.toString());c.setTag(b);c.addTouchEventListener(d)}},setmod:function(b){var a=this;this.mod_game=b},showCYY:function(){this.chat_cy[0].setVisible(true);this.chat_cy[1].setVisible(false);this.chat_bq[0].setVisible(false);this.chat_bq[1].setVisible(true);this.tb_cyy.setVisible(true)},showBQ:function(){this.chat_cy[0].setVisible(false);this.chat_cy[1].setVisible(true);this.chat_bq[0].setVisible(true);this.chat_bq[1].setVisible(false);this.tb_cyy.setVisible(false)},});gameclass.inputcode2=gameclass.baseui.extend({sprite:null,node:null,arrnum:null,ctor:function(){this._super();this.arrnum=[];for(var a=0;a<6;a++){this.arrnum[a]=-1}},show:function(){this.node=this.game.uimgr.createnode(res.jionroomui2,true);this.addChild(this.node);this.game.modmgr.mod_center.code("A");var b=this;gameclass.createbtnpress(this.node,"backBtn",function(){b.game.uimgr.closeui("gameclass.inputcode2")});gameclass.createbtnpress(this.node,"Panel_1_0",function(){b.game.uimgr.closeui("gameclass.inputcode2")});gameclass.createbtnpress(this.node,"cs",function(){b.cleanup()});gameclass.createbtnpress(this.node,"sc",function(){b.cleanupback()});for(var a=0;a<10;a++){gameclass.createbtnpress(this.node,"btn"+(a).toString(),function(d,c,e){b.pressnum(e)},function(){},function(){},a)}for(var a=0;a<6;a++){if(this.arrnum[a]<0){ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString(this.arrnum[a].toString())}}},pressnum:function(c){for(var d=0;d<6;d++){if(this.arrnum[d]==-1){this.arrnum[d]=c;if(d==5){var a=0;for(var b=0;b<6;b++){a+=this.arrnum[b];if(b<5){a*=10}}this.game.modmgr.mod_center.code(a.toString());this.game.uimgr.closeui("gameclass.inputcode2")}break}}for(var d=0;d<6;d++){if(this.arrnum[d]<0){ccui.helper.seekWidgetByName(this.node,""+(d+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(d+1).toString()).setString(this.arrnum[d].toString())}}},cleanup:function(){for(var a=0;a<6;a++){this.arrnum[a]=-1}for(var a=0;a<6;a++){if(this.arrnum[a]<0){ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString(this.arrnum[a].toString())}}},cleanupback:function(){for(var a=5;a>=0;a--){if(this.arrnum[a]>=0){this.arrnum[a]=-1;break}}for(var a=0;a<6;a++){if(this.arrnum[a]<0){ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString("")}else{ccui.helper.seekWidgetByName(this.node,""+(a+1).toString()).setString(this.arrnum[a].toString())}}}});gameclass.agreement=gameclass.baseui.extend({node:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.agreementjson,true);this.addChild(this.node);var a=this;gameclass.createbtnpress(this.node,"close",function(){a.game.uimgr.closeui("gameclass.agreement")})},});gameclass.shopui=gameclass.baseui.extend({node:null,gold:null,gem:null,charm:null,selectindex:null,ctor:function(){this._super()},show:function(){var e=this;this.node=this.game.uimgr.createnode(res.shopui,true);this.addChild(this.node);this.gold=ccui.helper.seekWidgetByName(this.node,"gold");this.gem=ccui.helper.seekWidgetByName(this.node,"gem");this.charm=ccui.helper.seekWidgetByName(this.node,"charm");var c=function(){this.game.modmgr.mod_center.buyItem(1000+e.selectindex)};var b=function(f,g){switch(g){case ccui.Widget.TOUCH_ENDED:e.selectindex=f.getTag();e.game.uimgr.showui("gameclass.msgboxui");e.game.uimgr.uis["gameclass.msgboxui"].setString("是否花费"+getcsvmgr.csv_item[1000+e.selectindex+"_cost"]+"钻石购买"+getcsvmgr.csv_item[1000+e.selectindex+"_num"]+getcsvmgr.csv_item[1000+e.selectindex+"_name"],c);break}};for(var d=1;d<=6;d++){var a=ccui.helper.seekWidgetByName(this.node,"goldcell"+d);a.setTag(d);ccui.helper.seekWidgetByName(a,"num").setString(getcsvmgr.csv_item[1000+d+"_num"]);ccui.helper.seekWidgetByName(a,"cost").setString(getcsvmgr.csv_item[1000+d+"_cost"]);a.addTouchEventListener(b)}gameclass.createbtnpress(this.node,"close",function(){e.game.uimgr.closeui("gameclass.shopui")});this.updateMoney()},updateMoney:function(){this.gold.setString(this.game.modmgr.mod_userbase.userbase.money);this.gem.setString(this.game.modmgr.mod_userbase.userbase.gem);this.charm.setString(this.game.modmgr.mod_userbase.userbase.charm)},updateUIMsg:function(a){if(a=="updatemoney"){this.updateMoney()}return false},});gameclass.mod_hlgc=gameclass.mod_base.extend({roominfo:null,isPaoLong:null,mywebsocket:null,ongameready:null,ongameniuniuend:null,serverchair:null,ongameview:null,isOver:null,endinfo:null,gamestate:null,onchat:null,chatlst:null,gameEndInfo:null,gameEndAllInfo:null,curDrawCardIndex:null,myUid:0,maxNum:0,bankerUid:0,HSZinfo:null,queType:-1,leftCardArr:[],_needUserNum:0,_readyList:[],isSmothing:null,isDaiPaoLong:null,isHaveingSeat:null,_mySeat:null,ctor:function(){this.isOver=false;this.gamestate=0;this.chatlst=[];this.queArr=[];this.leftCardArr=[];this._readyList=[];this.isPaoLong=false;this.isSmothing=false;this.isDaiPaoLong=false;this.isHaveingSeat=false;this._mySeat=-1},entergame:function(d,a){this.roominfo=d;this.mywebsocket=a;this.myUid=this.game.modmgr.mod_login.logindata.uid;var b=StaticData.getSetObj(d.type);this.roomSetArr=StaticData.roomParamAnalyze(d.type,d.param1,d.param2,0,b.param1Arr);this._needUserNum=parseInt(d.param1/1000%10);this.updateroominfo(this.roominfo);var c=this;this.mywebsocket.setonmsgfunc(function(n,k){switch(k.msghead){case"roominfo":c.joinRoomInfo(k.msgdata);c.view.checkSafe(k.msgdata.person);break;case"joinroomfail":c.mywebsocket.onclosefunc=null;c.game.modmgr.mod_login.dissmissroom();break;case"exitroom":c.game.uimgr.closeui("gameclass.exitroom");if(!c.isOver){c.mywebsocket.onclosefunc=null;c.game.modmgr.mod_login.dissmissroom()}break;case"tickroom":c.mywebsocket.onclosefunc=null;c.game.modmgr.mod_login.backlogin();c.game.uimgr.showui("gameclass.msgboxui");c.game.uimgr.uis["gameclass.msgboxui"].setString("您的账号已在其他地方登陆");break;case"gameseatqh":c.isHaveingSeat=true;c.checkSelfReady(k.msgdata);c.updateReady(k.msgdata.info);c.updateGameInfo(k.msgdata);break;case"gameQHMJbegin":for(var l=0;l<k.msgdata.info.length;l++){var h=k.msgdata.info[l];if(h.uid==c.myUid){gameclass.isCheat=h.cheat_allowed;break}}c.gamestate=1;c.view.roomInfo.step+=1;c.updateGameInfo(k.msgdata);c.view.setSeatState();c.gameBegin(k.msgdata);if(c.roominfo.step==0){c.view.checkSafe(c.roominfo.person)}var f=[];var o=[];var g=[];var p=c.offsetPlayer(k.msgdata.info);for(var l=0;l<gameclass.HLGC_MAX_USER;l++){if(p[l]!=null){f.push(p[l].card.card1);o.push(p[l].que);g.push(p[l].three)}else{f.push([]);o.push(0);g.push(0)}}c.queArr=o;c.view.onDealCards(f);c.gameInfo=k.msgdata;c.getBankId();c.view.betCheck();c.view.updateCardCommon();break;case"gamebets":c.view.gamebets(k.msgdata.uid,k.msgdata.bets);break;case"gameQHMJinfo":c.leftCardArr=k.msgdata.remain;for(var l=0;l<k.msgdata.info.length;l++){var h=k.msgdata.info[l];if(h.uid==c.myUid){gameclass.isCheat=h.cheat_allowed;break}}c.view.updateReadyView();c.updateGameInfo(k.msgdata);c.view.betCheck();c.view.updateCardCommon();c.view.checkSafe(c.roominfo.person);break;case"gamethree":c.slectThree(k.msgdata);break;case"gameQHMJthree":c.allSlectThree(k.msgdata);c.view.showQue(c.queArr);break;case"gameque":c.changeState(k.msgdata.uid,k.msgdata.bets);break;case"gameallque":c.changeAllState(k.msgdata);break;case"gameview":c.ongameview();break;case"dissmissroom":c.game.uimgr.closeui("gameclass.exitroom");c.game.uimgr.showui("gameclass.exitroom",false);c.game.uimgr.uis["gameclass.exitroom"].setData(c,k.msgdata);break;case"nodissmissroom":c.game.uimgr.closeui("gameclass.exitroom");c.game.uimgr.showui("gameclass.msgboxui");c.game.uimgr.uis["gameclass.msgboxui"].setString("有人不同意解散房间");break;case"chatroom":c.chatlst[c.chatlst.length]=k.msgdata;var m=c.getPlayerIndexById(k.msgdata.uid);c.view.chatshowinfo(m,k.msgdata);if(c.game.uimgr.uis["gameclass.chatui"]){c.game.uimgr.uis["gameclass.chatui"].pushstr(k.msgdata)}if(c.onchat){c.onchat(k.msgdata)}break;case"gameQHMJ_draw":c.DrawCard(k.msgdata);break;case"gameQHMJclose":c.view.closeArrow();break;case"gameQHMJstep":c.DisplayStepCard(k.msgdata);break;case"gameQHMJ_operator":c.isOperator(k.msgdata);break;case"gameQHMJ_peng":c.isPeng(k.msgdata);break;case"gameQHMJ_gang":c.isGang(k.msgdata);break;case"gameQHMJ_cagang":c.isGang(k.msgdata);break;case"gameQHMJhu":c.onHu(k.msgdata);break;case"gameQHMJlast":c.leftCardArr=k.msgdata;break;case"gameQHMJbao":c.view.showBao(k.msgdata);break;case"gameQHMJend":c._readyList=[];c.gameInfo.begin=false;c.onSimpleEnd(k.msgdata);break;case"gameready":c.isOk(k.msgdata);break;case"gameQHMJbye":c.isOver=true;c.gameEndAllInfo=k.msgdata;c.mywebsocket.onclosefunc=null;c.view.gameBye();break;case"lineperson":if(!c.roominfo.person){return}c.setuserReady(k.msgdata.uid,k.msgdata.line);var e=c.getPlayerIndexById(k.msgdata.uid);if(e>=0){c.view.initUserBaseView(e)}break;case"gameline":if(c.gamestate==1||c.gamestate==0){var e=c.getPlayerIndexById(k.msgdata.uid);c.view.userLineOut(e,k.msgdata)}break;case"gamekwxmygod":if(this.game.uimgr.uis["gameclass.hlgc.cheatPlayMo"]){this.game.uimgr.uis["gameclass.hlgc.cheatPlayMo"].updateAllCard(k.msgdata.info)}break}})},isCardsCommon:function(a){if(this.gameInfo.Razz==null){return false}for(var b=0;b<this.gameInfo.Razz.length;b++){if(a==this.gameInfo.Razz[b]){return true}}return false},setAllReady:function(){this._readyList=[];for(var b=0;b<this.persons.length;b++){var a=this.persons[b];if(a==null){continue}this._readyList.push({uid:a.uid,ready:true})}},checkSelfReady:function(c){if(!c.begin){for(var b=0;b<c.info.length;b++){var a=c.info[b];if(a.uid==this.game.modmgr.mod_login.logindata.uid){if(!a.ready){this.sendGameReady()}break}}}},updateReady:function(c){this._readyList=[];for(var a=0;a<c.length;a++){var b=c[a];this._readyList.push({uid:b.uid,ready:b.ready})}},setuserReady:function(b,c){for(var a=0;a<this._readyList.length;a++){var d=this._readyList[a];if(d.uid==b){d.ready=c;return}}this._readyList.push({uid:b,ready:true})},sendCard:function(e,d,c,b){var a={card:e,};if(this.curDrawCardIndex==0&&!c&&!b){this.mywebsocket.send("gamestep",a)}else{if(this.curDrawCardIndex==0&&b){this.view.sendGuoCallBack();this.mywebsocket.send("gamestep",a)}else{d()}}},sendSeat:function(b){var a={seat:b,};this.mywebsocket.send("gameseatqh",a)},sendPeng:function(){this.mywebsocket.send("gamepeng",{})},sendGetBet:function(b){var a={bets:b,};this.mywebsocket.send("gamebets",a)},sendGang:function(b){var a={card:b,};this.mywebsocket.send("gamegang",a);this.view.sendGangCallBack()},sendHu:function(){this.mywebsocket.send("gamehu",{})},sendGuo:function(){this.view.saveArr=[];this.mywebsocket.send("gameguo",{})},sendGameReady:function(){this.mywebsocket.send("gameready",{})},dissmissroom:function(a){var b={type:a};this.mywebsocket.send("dissmissroom",b)},Testcard:function(a){this.mywebsocket.send("gamekwxneed",a)},sendCheat:function(a){var b={card:a};this.mywebsocket.send("gamekwxneed",b)},chat:function(a,c){var b={type:a,chat:c};this.mywebsocket.send("chatroom",b)},nodissmissroom:function(){var a={};this.mywebsocket.send("nodissmissroom",a)},DisplayStepCard:function(b){var a=b.card;var c=this.getPlayerIndexById(b.uid);this.view.onSendCard(a,c)},slectThree:function(b){var c=this.getPlayerIndexById(b.uid);var a=b.three;this.view.showThree(c,a)},allSlectThree:function(c){var b=c.get;var a=c.remove;this.view.allSlectThree(b,a)},DrawCard:function(a){var b=this.getPlayerIndexById(a.uid);this.curDrawCardIndex=b;var c=this.getPlayerSeatById(a.uid);this.view.onDrawCard(c,b,a)},isOperator:function(a){this.view.onOperate(a)},isPeng:function(b){var a=this.getPengBackIndex(b.uid,b.ouid);var c=this.getPlayerIndexById(b.uid);this.curDrawCardIndex=c;var d=this.getPlayerSeatById(b.uid);this.view.onPeng(d,c,b.card,a)},getPengBackIndex:function(d,b){var a=0;var e=0;var f=0;for(var c=0;c<this.persons.length;c++){if(this.persons[c]&&this.persons[c].uid==d){e=c}else{if(this.persons[c]&&this.persons[c].uid==b){f=c}}}if((f+1+gameclass.HLGC_MAX_USER)%gameclass.HLGC_MAX_USER==e){return 0}else{if((f-1+gameclass.HLGC_MAX_USER)%gameclass.HLGC_MAX_USER==e){return 2}else{return 1}}},isGang:function(a){var b=this.getPlayerIndexById(a.uid);this.curDrawCardIndex=b;this.view.onGang(b,a.card,a.view)},onHu:function(a){var b=this.getPlayerIndexById(a.uid);this.view.onHu(b,0,a.ouid,a.card)},onSimpleEnd:function(c){var d=this.offsetPlayer(c.info);var a=[];for(var b=0;b<d.length;b++){if(d[b]!=null){a.push(d[b].total)}else{a.push(0)}}this.view.reflashScore(a);this.gameEndInfo={hz:c.hz,lastcard:c.lastcard,info:c.info,bao:c.bao};this.view.onSimpleEnd()},getplayerdatabyuid:function(b){for(var a=0;a<this.roominfo.person.length;a++){if(this.roominfo.person[a].uid==b){return this.roominfo.person[a]}}},bindUI:function(a){this.view=a},changeState:function(c,a){var b=this.getPlayerIndexById(c);this.view.changeState(b,a)},changeAllState:function(b){b=this.offsetPlayer(b.queinfo);var c=[];for(var a=0;a<b.length;a++){c[a]=b[a].bets}this.view.showQue(c)},joinRoomInfo:function(a){this.roominfo.person=a.person;this.maxNum=this.roominfo.person.length;this.getCurPlayerIndex(a.person,this.myUid);a=this.offsetPlayer(a.person);this.persons=a;this.view.setPlayerState(a)},getPlayerSeatById:function(b){var c=[null,null,null,null];for(var a=0;a<this.gameInfo.info.length;a++){if(!this.gameInfo.info[a]||this.gameInfo.info[a].seat<0){continue}c[(this.gameInfo.info[a].seat-this._mySeat+4)%4]=gameclass.mod_base.deepCopy(this.gameInfo.info[a])}for(var a=0;a<c.length;a++){if(c[a]&&c[a].uid==b){return a}}return -1},getPlayerIndexById:function(b){for(var a=0;a<this.persons.length;a++){if(this.persons[a]&&this.persons[a].uid==b){return a}}return -1},_getPersonDataByUid:function(b){for(var a=0;a<this.persons.length;a++){if(this.persons[a]&&this.persons[a].uid==b){return this.persons[a]}}return -1},getCurPlayerIndex:function(a,c){for(var b=0;b<a.length;b++){if(!a[b]){continue}if(a[b].uid==c){this.curPlayerIndex=b;break}}return this.curPlayerIndex},offsetPlayer:function(b){for(var e=0;e<this._needUserNum;e++){if(e>=b.length){b.push({})}}var d=[];for(var a=0;a<gameclass.HLGC_MAX_USER;a++){var c=this.getSceneIndexFromS(a);d[c]=b[a]?b[a]:null}return d},updateGameInfo:function(a){this.gameInfo=a;for(var b=0;b<a.info.length;b++){if(a.info[b].uid==this.myUid){this._mySeat=a.info[b].seat;break}}this.getBankId();this.view.setRoomInfo(this.roominfo);if(a.begin||this.roominfo.step>0){if(this.game.modmgr.mod_login.logindata.uid==this.myUid){this.isHaveingSeat=true}}this.view.updatePlayerinfo(this.gameInfo);if(a.begin||this.roominfo.step>0){this.reconnectionShow();return}},getUserRead:function(b){for(var a=0;a<this._readyList.length;a++){var c=this._readyList[a];if(c.uid==b){return c.ready}}return false},isOk:function(a){this.setuserReady(a.uid,true);this.view.updateReadyView()},getBankId:function(){if(!this.gameInfo){return}if(!this.gameInfo.info){return}var b=this.offsetPlayer(this.gameInfo.info);this.bankerUid=0;for(var a=0;a<this.gameInfo.info.length;a++){if(this.gameInfo.info[a].deal){this.bankerUid=this.gameInfo.info[a].uid;break}}},reconnectionShow:function(){if(this.gameInfo.begin){this.gameBegin(this.gameInfo);this.chuliData(this.gameInfo);this.view.setSeatState()}else{if(!this.gameInfo.info){return}var a=this.offsetPlayer(this.gameInfo.info);this.view.reconnectionShow(a,this.roominfo,this.persons);if(a[0].ready){}else{this.gameEndInfo={hz:this.gameInfo.hz,lastcard:this.gameInfo.lastcard,info:this.gameInfo.info,bao:this.gameInfo.bao,};this.game.uimgr.showui("gameclass.hlgcResultOneUi").setDjjsMod(this)}}},clearDesk:function(){},gameBegin:function(c){this.view.setSeatBtn();var d=this.offsetPlayer(c.info);this.view.gameReady(d,this.roominfo,c.num);var a=[];for(var b=0;b<d.length;b++){if(d[b]){a.push(d[b].total)}else{a.push(0)}}this.view.reflashScore(a)},updateroominfo:function(a){this.roominfo={agree:a.agree,maxStep:a.maxstep,roomid:a.roomid,step:a.step,time:a.time,type:a.type,param1:a.param1,param2:a.param2,fd:parseInt(a.param1/1000000)%10,zmjd:parseInt(a.param1/100000)%10,dgh:parseInt(a.param1/10000)%10,hsz:parseInt(a.param1/1000)%10,yjdj:parseInt(a.param1/100)%10,mqq:parseInt(a.param1/10)%10,tdh:a.param1%10,person:a.person,};this.persons=a.person;this.HSZinfo={isHSZ:this.roominfo.hsz==1,hasSlectNum:0};this.maxNum=this.persons.length;this.getCurPlayerIndex(this.persons,this.myUid);this.persons=this.offsetPlayer(this.persons);if(this.roominfo.time!=0){this.game.uimgr.showui("gameclass.exitroom",false);this.game.uimgr.uis["gameclass.exitroom"].setData(this,this.roominfo)}},chuliData:function(w){this.gamestate=(w.begin==true?1:0);var d=null;var h=null;var v=null;if(w.curstep>0){var o=this.getPlayerSeatById(w.curstep);d=this.getPlayerIndexById(w.curstep);this.view.setArrowTowards(o)}if(w.befstep>0){h=this.getPlayerIndexById(w.befstep);v=w.lastcard}var e=this.offsetPlayer(w.info);var q=[];var m=[];var c=[];var g=[];var n=[];var u=[];var f=[];var k=[];for(var s=0;s<gameclass.HLGC_MAX_USER;s++){g[s]=[]}for(var s=0;s<gameclass.HLGC_MAX_USER;s++){if(e[s]!=null){q.push(e[s].card.card1);m.push(e[s].card.card2);c.push(e[s].card.cardm);n.push(e[s].que);u.push(e[s].hutype);f.push(e[s].hucard);k.push(e[s].three);for(var r=0;r<e[s].card.cardp.length;r++){var b=e[s].card.cardp[r];var l=this.getPengBackIndex(e[s].uid,e[s].peng_uids[b]);g[s].push({type:"peng",index:s,nums:[b],pengbackIndex:l})}var t=e[s].card.cardmg.concat(e[s].card.cardcg);for(var r=0;r<t.length;r++){g[s].push({type:"gang",index:s,nums:[t[r]],gangType:1})}if(e[s].card.cardxfg.length>0){g[s].push({type:"gang",index:s,nums:[StaticData.WIND_GANG],gangType:1})}for(var r=0;r<e[s].card.cardag.length;r++){g[s].push({type:"gang",index:s,nums:[e[s].card.cardag[r]%100],gangType:0})}}else{q.push([]);m.push([]);c.push([]);n.push(0);u.push(0);f.push(0);k.push([])}}this.view.whoHasHu(u);this.view.onDealCards(q);this.queArr=n;this.curDrawCardIndex=d;if(v>0){this.view.connet_setLastInfo(h,v)}this.view.connect_showTableCard(m);this.view.connect_showPengGangCard(g);this.view.showHuPoke(f);var p=null;for(var s=0;s<gameclass.HLGC_MAX_USER;s++){if(u[s]==0){if(e[s]!=null&&e[s].num-e[s].card.card1.length==1){p=s;var a={card:c[s]};var o=this.getPlayerSeatById(w.curstep);this.view.onDrawCard(o,s,a);break}}}this.view.setCardAcount(w.num);for(var s=0;s<gameclass.HLGC_MAX_USER;s++){if(e[s]!=null&&e[s].uid==this.game.modmgr.mod_login.logindata.uid){var x={huType:e[s].hutype,peng:e[s].peng,gang:e[s].gang,hu:e[s].hu,};this.view.onOperate(x);break}}if(h){this.view.connect_isHaveOutPoke(d,(d==h))}this.view.chuliDataCheckListen()},});gameclass.mod_hlgc.prototype.onSendmygod=function(){this.mywebsocket.send("gamekwxmygod",{})};gameclass.mod_hlgc.prototype.onSendgetmygod=function(a){this.mywebsocket.send("kwxgetmygod",{card:parseInt(a)})};gameclass.mod_hlgc.prototype.getserverchair=function(a){return(gameclass.HLGC_MAX_USER+a+this.curPlayerIndex)%gameclass.HLGC_MAX_USER};gameclass.mod_hlgc.prototype.getSceneIndexFromS=function(a){return(gameclass.HLGC_MAX_USER+a-this.curPlayerIndex)%gameclass.HLGC_MAX_USER};gameclass.HLGC_MAX_USER=4;gameclass.HLGC_MAX_TxtCARD_NUM=30;gameclass.HLGC_MAX_CARD_NUM=37;gameclass.outPokerLayer=cc.Class.extend({node:null,parent:null,playerSendNum:null,outCardsArrSP:null,outCardsArr:null,curOutStartPos:null,viewNodeArr:null,ctor:function(c){this.node=c.outNode;this.parent=c.parent;this.outCardsArr=[[],[],[],[]];this.outCardsArrSP=[[],[],[],[]];this.curOutStartPos=[cc.p(568,200),cc.p(910,320),cc.p(560,430),cc.p(250,320)];this.startPos=[cc.p(385,230),cc.p(820,203),cc.p(760,410),cc.p(330,457)];this.constStartPos=[cc.p(400,180),cc.p(860,200),cc.p(740,500),cc.p(280,457)];this.viewNodeArr=[];for(var a=0;a<gameclass.HLGC_MAX_USER;a++){var b=new cc.Node();this.viewNodeArr[a]=b;this.node.addChild(b)}},renderCards:function(c){this.outCardsArrSP[c]=[];this.viewNodeArr[c].removeAllChildren();var b=cc.p(this.constStartPos[c]);var f=this.outCardsArr[c];for(var a=0;a<f.length;a++){var e=this.creatCardSp(c,f[a],a);var d=cc.size(e.getContentSize().width*e.getScale(),e.getContentSize().height*e.getScale());b=this.cpPosition(c,a,d,b);e.setPosition(b);e.setTag(c*100+a);this.outCardsArrSP[c].push(e);this.viewNodeArr[c].addChild(e)}},cpPosition:function(c,e,d,b){var h=[11,14,14,12];var a=false;var g=cc.p(this.constStartPos[c]);var f=Math.floor(e/10)%2;if(e>=20){a=true}e=e%10;switch(c){case 0:b.x=e*(d.width-2)+g.x;b.y=f*44+g.y+(a==true?h[c]:0);break;case 1:b.x=f*47*-1+g.x;b.y=e*29+g.y+(a==true?h[c]:0);break;case 2:b.x=e*(d.width-2)*-1+g.x;b.y=f*44*-1+g.y+(a==true?h[c]:0);break;case 3:b.x=f*47+g.x;b.y=e*29*-1+g.y+(a==true?h[c]:0);break}return b},removePengGangSp:function(a,c){for(var b in this.outCardsArr[a]){if(this.outCardsArr[a][b]==c){this.outCardsArr[a].splice(b,1);break}}this.renderCards(a)},getConnectTableData:function(a){this.outCardsArr=a},creatCardSp:function(b,d,a){a=parseInt(a);var c;if(this.parent.mod_hlgc.roomSetArr[5]==1){if(b==0){c=gameclass.hlgc.Table.CreateCard(d,2,1,0)}else{c=gameclass.hlgc.Table.CreateCard(d,b,1,0)}}else{c=gameclass.hlgc.Table.CreateCard(d,b,3,0)}if(b==0){c.setLocalZOrder(1000-a);if(a>=20){c.setLocalZOrder(1000000-a)}}else{if(b==1){c.setLocalZOrder(1000-a);if(a>=20){c.setLocalZOrder(100000-a)}}else{if(b==2){c.setLocalZOrder(a)}else{if(a<10){c.setLocalZOrder(1000+a)}else{if(a<20){c.setLocalZOrder(100+a)}}if(a>=20){c.setLocalZOrder(10000+a)}}}}c.setAnchorPoint(0.5,0.5);return c},flyMajonAct:function(g,f){var e=this.curOutStartPos[g];var b=this.outCardsArrSP[g].length;var d=cc.p(0,0);var a=this.creatCardSp(g,f,b);a.setPosition(e);if(g==0||g==2){a.setScale(0.8)}else{a.setScale(1.6)}if(b==0){d=cc.p(this.constStartPos[g])}else{var c=this.outCardsArrSP[g][b-1];d=this.cpPosition(g,b,c.getContentSize(),c.getPosition())}var h=this;this.node.addChild(a);a.runAction(cc.sequence(cc.delayTime(0.3),cc.moveTo(0,d),cc.callFunc(function(){a.removeFromParent();h.outCardsArr[g].push(f);h.renderCards(g);var k=h.outCardsArrSP[g].length;h.parent.setPointerAct(h.outCardsArrSP[g][k-1],g)})))},checkTableCard:function(c){for(var b=0;b<this.parent.mod_hlgc.maxNum;b++){for(var a=0;a<this.outCardsArr[b].length;a++){if(c==this.outCardsArr[b][a]){this.viewNodeArr[b].getChildByTag(b*100+a).setColor(cc.color(150,150,150))}else{this.viewNodeArr[b].getChildByTag(b*100+a).setColor(cc.color(255,255,255))}}}},removeTableCard:function(){this.outCardsArr=[[],[],[],[]];for(var a=0;a<4;a++){this.renderCards(a)}},});gameclass.hlgc=gameclass.hlgc||{};gameclass.hlgc.Player=cc.Class.extend({parent:null,gameUiLayer:null,node:null,index:null,sex:null,curCards:null,curCardsSP:null,pengGangArr:null,pengGangNodeArr:null,flowerArr:null,startPos:null,drawCardPos:null,sendCardPos:null,pengGangPos:null,expressionPosArr:null,name_text:null,scoreBg:null,score_text:null,head_img:null,_headContain:null,_masterIcon:null,operateSp:null,zhuang_img:null,isQiPai:false,talkText:null,voiceSp:null,haveOutPoke:false,specialOperate:false,queType:null,isQue:true,isHasHu:false,hasDelete:false,isTing:false,Jiang:0,gangNum:null,_data:null,_game:null,offLineImg:null,_tingCardArr:[],ctor:function(b,f,d,a,h){this.node=b;this.index=f;this.parent=h;this.gameUiLayer=d;this.controlLayer=a;this.curCards=[];this.curCardsSP=[];this.pengGangArr=[];this.pengGangNodeArr=[];this.expressionPosArr=[];this.flowerArr=[];this.mahNodeArr=[];this.slectArr=[];this.huLogoSP=[];for(var c=0;c<gameclass.HLGC_MAX_USER;c++){this.expressionPosArr.push(ccui.helper.seekWidgetByName(this.gameUiLayer,"expressionNode"+c).getPosition());this.mahNodeArr[c]=ccui.helper.seekWidgetByName(this.gameUiLayer,"mah"+c);this.huLogoSP[c]=ccui.helper.seekWidgetByName(this.gameUiLayer,"hulogo"+c);this.huLogoSP[c].setVisible(false)}var e=[cc.p(30,30),cc.p(950,140),cc.p(835,550),cc.p(160,540)];var g=[cc.p(50,80),cc.p(950,150),cc.p(795,580),cc.p(160,540)];var k=[cc.p(1030,30),cc.p(950,572),cc.p(300,550),cc.p(160,140)];this.CONST_STARTPOS=e[this.index];this.CONST_PENGGANGPOS=g[this.index];this.drawCardPos=k[this.index];this.name_text=ccui.helper.seekWidgetByName(this.node,"playerName");this.scoreBg=ccui.helper.seekWidgetByName(this.node,"scoreBG");this.score_text=ccui.helper.seekWidgetByName(this.node,"playerscore0");this.betTxt=ccui.helper.seekWidgetByName(this.node,"betTxt");this.betTxt.setString("");this.offLineImg=ccui.helper.seekWidgetByName(this.node,"offLine");this.offLineImg.setVisible(false);this.voiceSp=ccui.helper.seekWidgetByName(this.node,"voice");this.voiceSp.setVisible(false);this.operateSp=this.node.getChildByName("operateSp");if(this.index==1){this.voiceSp.setPosition(-50,100);this.operateSp.setPosition(-50,120)}this.head_img=ccui.helper.seekWidgetByName(this.node,"headBg");this._headContain=ccui.helper.seekWidgetByName(this.node,"headContain");this._masterIcon=ccui.helper.seekWidgetByName(this.node,"masterIcon");this.c=ccui.helper.seekWidgetByName(this.node,"cBtn0");this._masterIcon.setVisible(false);this.handNode=new cc.Layer();this.controlLayer.addChild(this.handNode,this.index*-1+100);this.zhuang_img=ccui.helper.seekWidgetByName(this.node,"zhuang");this.zhuang_img.setVisible(false);this.addHeadClick();this.bindEvent();this.readyIcon=ccui.helper.seekWidgetByName(this.node,"readyIcon");if(this.index==0){this.readyIcon.setPosition(this.node.getContentSize().width/2,this.node.getContentSize().height+30)}else{if(this.index==1){this.readyIcon.setPosition(-this.node.getContentSize().width+50,this.node.getContentSize().height/2+20)}else{if(this.index==2){this.readyIcon.setPosition(this.node.getContentSize().width/2,-20)}else{this.readyIcon.setPosition(this.node.getContentSize().width+20,this.node.getContentSize().height/2+20)}}}this.initBaseView()},initBaseView:function(){this.updateRead(false)},updateRead:function(a){this.readyIcon.setVisible(a)},setGame:function(a){this._game=a},setVisible:function(a){this.node.setVisible(a)},addHeadClick:function(){var a=this;this.c.addTouchEventListener(function(c,d){if(d!=ccui.Widget.TOUCH_ENDED){return}if(a._data==null){return}if(a._data.name==null){return}var b=a._game.uimgr.showui("gameclass.UserInfoView",false);b.updateView(a._data.head,a._data.name,"ID："+a._data.uid,"IP："+a._data.uip,"地址："+a._data.address)},this)},bindEvent:function(){var b=this;var a=cc.p(0,0);this.eventManger=new gameclass.majonLisenter({cards:this.curCardsSP,plane:this.handNode,});this.eventManger.on("drag",function(d,e){if(gameclass.mod_hlgc.isSmothing){if(b.parent.allSlect){return}}else{if(!b.parent.allSlect){return}}if(b.isHasHu){return}var c=b.curCards[d.getTag()%100];if(b.parent.mod_hlgc.isCardsCommon(c)){return}if(b.isQue){if(c<(b.queType-1)*10||c>(b.queType)*10){return}}d.setPosition(e.x-d.getContentSize().width*0.5,e.y-d.getContentSize().height*0.5)});this.eventManger.on("dragBegin",function(d,e,c){a=c});this.eventManger.on("dragEnd",function(e,g,f){if(gameclass.mod_hlgc.isSmothing){if(b.parent.allSlect){return}}else{if(!b.parent.allSlect){return}}if(g.y<120||b.curCardsSP.length%3!=2){e.runAction(cc.sequence(cc.moveTo(0.02,a)))}var d=b.curCards[e.getTag()%100];if((b.index==b.parent.mod_hlgc.curDrawCardIndex||b.specialOperate)&&b.curCardsSP.length%3==2){if(!b.isQue){b.sendCard(e,a)}else{if(d>(b.queType-1)*10&&d<(b.queType)*10){b.sendCard(e,a)}else{b.checkCard(-1);e.isSelect=false}}}else{b.checkCard(-1);e.isSelect=false}for(var c=0;c<b.curCardsSP.length;c++){b.curCardsSP[c].setPositionY(b.startPos.y);b.curCardsSP[c].isSelect=false}e.isSelect=true;b.checkCard(d)});this.eventManger.on("slide",function(e){if(!b.parent.allSlect){return}if(b.isHasHu){return}var d=b.curCards[e.getTag()%100];if(b.isQue){if(d<(b.queType-1)*10||d>(b.queType)*10){return}}for(var c=0;c<b.curCardsSP.length;c++){b.curCardsSP[c].up=false;if(e.getTag()==b.curCardsSP[c].getTag()){if(!b.curCardsSP[c].up){b.curCardsSP[c].up=true}if(b.curCardsSP[c].up){b.curCardsSP[c].y=30}}else{b.curCardsSP[c].up=false;b.curCardsSP[c].y=b.startPos.y}}});this.eventManger.on("slideBegin",function(c){});this.eventManger.on("slideEnd",function(c){if(!b.parent.allSlect){return}c.isSelect=true});this.eventManger.on("click",function(f){if(b.isHasHu){return}var e=b.curCards[f.getTag()%100];if(b.isTing){if(b.gameUiLayer.getChildByTag(112233)){b.gameUiLayer.removeChildByTag(112233)}var g=[];for(var d=0;d<b.tingArr.length;d++){if(f.getTag()%100==b.tingArr[d].huIndex&&!b.curCardsSP[f.getTag()%100].isSelect){var c=g.indexOf(b.tingArr[d].huCard);if(c<0){g.push(b.tingArr[d].huCard)}}}b.parent.showTingWindow(g)}if(gameclass.mod_hlgc.isSmothing){return}if(f.isSelect){if((b.index==b.parent.mod_hlgc.curDrawCardIndex||b.specialOperate)&&b.curCardsSP.length%3==2){if(!b.isQue){b.sendCard(f)}else{if(e>(b.queType-1)*10&&e<(b.queType)*10){b.sendCard(f)}else{f.isSelect=false;f.setPositionY(b.startPos.y);b.checkCard(-1)}}}else{f.setPositionY(b.startPos.y);f.isSelect=false;b.checkCard(-1)}return}for(var d=0;d<b.curCardsSP.length;d++){b.curCardsSP[d].setPositionY(b.startPos.y);b.curCardsSP[d].isSelect=false}b.checkCard(e);f.isSelect=true;f.y+=20})},sendCardCheckListen:function(a){this._tingCardArr=[];if(this.tingArr==null){return}for(var b=0;b<this.tingArr.length;b++){if(a==this.tingArr[b].huIndex){var c=this._tingCardArr.indexOf(this.tingArr[b].huCard);if(c<0){this._tingCardArr.push(this.tingArr[b].huCard)}}}},initData:function(){this.curCards=[];this.pengGangArr=[];this.flowerArr=[];this.queType=null;this.isQue=true;this.isHasHu=false;this.isQiPai=false;for(var a=0;a<gameclass.HLGC_MAX_USER;a++){this.huLogoSP[a].setVisible(false)}},changeSlectArr:function(c){if(this.curCardsSP[c].isSelect){return}var b=this.slectArr.shift();this.slectArr.push(c);this.curCardsSP[b].isSelect=false;this.curCardsSP[c].isSelect=true;for(var a=0;a<this.curCardsSP.length;a++){if(this.curCardsSP[a].isSelect){this.curCardsSP[a].setPositionY(this.startPos.y+20)}else{this.curCardsSP[a].setPositionY(this.startPos.y)}}},slectIndex:function(){var b=[[],[],[]];for(var c=0;c<this.curCards.length;c++){if(this.curCards[c]<10){b[0].push(this.curCards[c])}else{if(this.curCards[c]>10&&this.curCards[c]<20){b[1].push(this.curCards[c])}else{b[2].push(this.curCards[c])}}}var e=[];for(var c=0;c<3;c++){var f={index:c,len:b[c].length};e.push(f)}e.sort(function(h,g){return h.len-g.len});for(var c=0;c<e.length;c++){if(e[c].len>=3){var d=e[c].index;if(d==0){this.slectArr=[0,1,2]}else{if(d==1){var a=b[0].length;this.slectArr=[a,a+1,a+2]}else{var a=b[0].length+b[1].length;this.slectArr=[a,a+1,a+2]}}this.showSystemCard();return}}},getSlectedCard:function(){var a=[];for(var b=0;b<3;b++){a[b]=this.curCards[this.slectArr[b]]}return a},showSystemCard:function(){for(var a=0;a<this.curCardsSP.length;a++){this.curCardsSP[a].isSelect=false}for(var a=0;a<3;a++){this.curCardsSP[this.slectArr[a]].isSelect=true;this.curCardsSP[this.slectArr[a]].setPositionY(this.startPos.y+20)}},checkCard:function(a){this.parent.checkTableCard(a)},setBaseInfo:function(a){a=a||{};this._data=a;this.sex=a.sex;this.name_text.setString(a.name||"");this.score_text.setString(a.total.toString()||"");if(a.name){this.scoreBg.setVisible(true);this.score_text.setVisible(true)}else{this.scoreBg.setVisible(false);this.score_text.setVisible(false);this.readyIcon.setVisible(false)}this.offLineImg.setVisible(false);if(a.head!=null){gameclass.mod_base.showtximg(this.head_img,a.head||"",0,0,"",!a.line)}else{this.head_img.removeAllChildren()}},setQueState:function(a){},showSlectLayout:function(a){if(a.length<3){if(this.index==0){this.parent.setSlectVisable(true);this.slectIndex()}this.hasDelete=false}else{if(a.length==3){if(this.index==0){this.parent.setSlectVisable(false)}this.mahNodeArr[this.index].setVisible(true);this.curCards=this.deleArr(this.curCards,a);this.hasDelete=true;this.renderAllCard()}}},allSlectThree:function(c,b){if(!this.hasDelete){this.curCards=this.deleArr(this.curCards,b)}if(this.index==0){for(var d=0;d<c.length;d++){this.curCards.push(c[d])}this.curCards.sort(function(f,e){return f-e})}else{if(this.curCards.length<13){this.curCards=[0,0,0,0,0,0,0,0,0,0,0,0,0]}}this.renderAllCard();if(this.index==0){var a=[];for(var d=0;d<this.curCards.length;d++){if(this.curCards[d]==c[0]){c.splice(0,1);a.push(d)}}for(var d=0;d<a.length;d++){this.curCardsSP[a[d]].setPositionY(this.startPos.y+20)}}},changeShow:function(){this.mahNodeArr[this.index].setVisible(false);this.parent.setSlectVisable(false)},showTableMah:function(){this.mahNodeArr[this.index].setVisible(true)},dealOtherCard:function(){this.renderAllCard()},mySort:function(){var b=[];this.curCards.sort(function(f,e){return f-e});this.isQue=false;var a=[];for(var c=this.curCards.length-1;c>=0;c--){if(this.parent.mod_hlgc.isCardsCommon(this.curCards[c])){a.push(this.curCards.splice(c,1)[0])}}this.curCards=a.concat(this.curCards);var d},renderAllCard:function(){this.handNode.removeAllChildren();this.startPos=cc.p(this.CONST_STARTPOS);this.pengGangPos=cc.p(this.CONST_PENGGANGPOS);this.renderPengGangCardView();this.renderHandCardView();if(this.index==0){this.eventManger.setCardsArr(this.curCardsSP);this.eventManger._isDrag=this.eventManger._isTouch=this.eventManger._isInvalid=false}},renderPengGangCardView:function(){for(var a=0;a<this.pengGangArr.length;a++){var b=new gameclass.OpBox(this.pengGangArr[a]);b.setAnchorPoint(0,0);b.setPosition(this.pengGangPos);b.setTag((this.index+1)*1000+a);switch(this.index){case 0:this.startPos.x+=b.getContentSize().width;this.pengGangPos.x+=b.getContentSize().width;break;case 1:this.startPos.y=this.startPos.y+b.getContentSize().height-10;this.pengGangPos.y=this.pengGangPos.y+b.getContentSize().height-10;b.setLocalZOrder(20-a);break;case 2:this.startPos.x-=b.getContentSize().width;this.pengGangPos.x-=b.getContentSize().width;break;case 3:this.startPos.y=this.startPos.y-b.getContentSize().height+10;this.pengGangPos.y=this.pengGangPos.y-b.getContentSize().height+10;break}this.handNode.addChild(b)}},renderHandCardView:function(){this.createMyPokerWithArr(this.curCards);if(!this.curCardsSP||this.curCardsSP.length<1){return false}if(this.index==1){this.startPos.y+=5}else{if(this.index==3){this.startPos.y+=15}}var a=this.curCardsSP.length;for(var b=0;b<a;b++){var c=this.curCardsSP[b];c.setAnchorPoint(0,0);c.setTag(100+b);c.setPosition(this.startPos);switch(this.index){case 0:this.startPos.x+=(c.getContentSize().width-2)*c.getScale();this.pengGangPos.x+=(c.getContentSize().width-2)*c.getScale();break;case 1:this.startPos.y+=(c.getContentSize().width-2)*c.getScale();this.pengGangPos.y+=(c.getContentSize().width-2)*c.getScale();c.setLocalZOrder(20-b);break;case 2:this.startPos.x-=(c.getContentSize().width-5)*c.getScale();this.pengGangPos.x-=(c.getContentSize().width-5)*c.getScale();break;case 3:this.startPos.y-=(c.getContentSize().width-2)*c.getScale();this.pengGangPos.y-=(c.getContentSize().width-2)*c.getScale();c.setLocalZOrder(b);break}if(this.isQiPai&&b==a-1){if(this.index==1){var d=cc.p(this.drawCardPos.x,this.startPos.y-20);if(d.y>this.drawCardPos.y){d.y=this.drawCardPos.y}c.setPosition(d)}else{if(this.index==2){var d=cc.p(this.startPos.x-0,this.drawCardPos.y);if(d.x<this.drawCardPos.x){d.x=this.drawCardPos.x}c.setPosition(d)}else{if(this.index==3){var d=cc.p(this.drawCardPos.x,this.startPos.y-8);if(d.y<this.drawCardPos.y){d.y=this.drawCardPos.y}c.setPosition(d)}else{c.setPosition(this.drawCardPos)}}}}c.isSelect=false;this.handNode.addChild(c)}},createMyPokerWithArr:function(a){this.curCardsSP=[];for(var b=0;b<a.length;b++){var c=gameclass.hlgc.Table.CreateCard(a[b],this.index,0,this.index==0?0:1);if(this.parent.mod_hlgc.isCardsCommon(a[b])){var d=new cc.Sprite("res/ui/qhqp/img_hun@2x.png");c.addChild(d);d.setPosition(20,85)}if(this.isHasHu){c.setColor(new cc.color(127,127,127));this.huLogoSP[this.index].setVisible(true);this.huLogoSP[this.index].setLocalZOrder(8888)}if(this.isQue&&this.queType&&this.queType>0){if(a[b]<(this.queType-1)*10||a[b]>this.queType*10){c.setColor(new cc.color(127,127,127))}}if(c){this.curCardsSP[b]=c}}},reflashScore:function(a){this.score_text.setString(a)},onDrawCard:function(a){if(this.index==0){this.haveOutPoke=false;this.isQiPai=true;this.mySort();if(a<this.queType*10&&a>(this.queType-1)*10){this.isQue=true}this.curCards.push(a);this.renderAllCard();this.checkListen();this.parent.createTingContinue([])}else{this.isQiPai=true;this.curCards.push(a);this.renderAllCard()}},getGangNum:function(b){var d={};if(b){if(!d[b]){d[b]=0}d[b]++}for(var a in this.curCards){var e=this.curCards[a];if(!d[e]){d[e]=0}d[e]++}for(var a in this.pengGangArr){if(this.pengGangArr[a].type=="peng"){var e=this.pengGangArr[a].nums[0];if(!d[e]){d[e]=0}if(e!=b){d[e]+=3}}}var c=[];for(var a in d){if(d[a]>=4){c.push(parseInt(a))}}if(this.curCards.indexOf(StaticData.WIND_DONG)>=0&&this.curCards.indexOf(StaticData.WIND_NAN)>=0&&this.curCards.indexOf(StaticData.WIND_XI)>=0&&this.curCards.indexOf(StaticData.WIND_BEI)>=0){c.push(StaticData.WIND_GANG)}return c},sendCard:function(e,a){var c=e.getTag()%100;this.sendCardCheckListen(c);this.cardIndex=c;var b=this.curCards[c];if(this.parent.mod_hlgc.isCardsCommon(b)){gameclass.showText("混不可以打出!");return}var d=this;this.parent.sendCard(b,function(){if(a){e.runAction(cc.sequence(cc.moveTo(0.1,a)))}},this.haveOutPoke,this.specialOperate)},onSendCard:function(a){this.isQiPai=false;if(this.index==0){this.haveOutPoke=true;this.isTing=false;if(this.gameUiLayer.getChildByTag(112233)){this.gameUiLayer.removeChildByTag(112233)}}if(this.index!=0){this.cardIndex=this.curCards.length-1}this.checkCard(-1);this.curCards.splice(this.cardIndex,1);this.mySort();this.renderAllCard();this.parent.outPokerManager.flyMajonAct(this.index,a);if(this.index==0){this.parent.createTingContinue(this._tingCardArr)}},onPeng:function(d,b,a){this.pengGangArr.push({type:"peng",index:this.index,nums:[d],pengbackIndex:a});if(this.index==0){this.haveOutPoke=false;this.specialOperate=false;for(var c=0;c<this.curCards.length;c++){if(this.curCards[c]==d){this.curCards.splice(c,2);break}}this.parent.createTingContinue([])}else{this.curCards.splice(0,2)}this.renderAllCard();this.showControlAct(0)},pengDragOne:function(){var a=this.curCards.splice(this.curCards.length-1,1)[0];this.onDrawCard(a)},onGang:function(f,d){if(d!=2){this.pengGangArr.push({type:"gang",index:this.index,nums:[f],gangType:d})}if(this.index==0){this.haveOutPoke=false;this.specialOperate=false;this.curCards.sort(function(h,g){return h-g});if(f==StaticData.WIND_GANG){var b=StaticData.WIND_GANG_ARR;for(var c=0;c<b.length;c++){for(var a=0;a<this.curCards.length;a++){if(this.curCards[a]==b[c]){this.curCards.splice(a,1);break}}}}else{var e=null;if(d==0){e=4}else{if(d==1){e=3}else{if(d==2){e=1}}}for(var c=0;c<this.curCards.length;c++){if(this.curCards[c]==f){this.curCards.splice(c,e);break}}}this.parent.createTingContinue([])}else{if(d==0){this.curCards.splice(0,4)}else{if(d==1){this.curCards.splice(0,3)}else{this.curCards.splice(0,1)}}}if(d==2){for(var c=0;c<this.pengGangArr.length;c++){if(this.pengGangArr[c].nums[0]==f){this.pengGangArr.splice(c,1,{type:"gang",index:this.index,nums:[f],gangType:2});break}}}this.renderAllCard();this.showControlAct(1)},onHu:function(a,b,c){if(this.index==0){this.specialOperate=false}this.isHasHu=true;this.renderAllCard();if(b==1){this.handNode.getChildren()[this.handNode.childrenCount-1].removeFromParent()}this.showHuPoke(c)},deleArr:function(f,c){var a=f.slice(0);var e=c.slice(0);for(var d=0;d<e.length;d++){if(a.indexOf(e[d])>-1){var b=a.indexOf(e[d]);a.splice(b,1)}}return a},dealCards:function(a){this.curCards=a.slice(0);if(this.index!=0){return this.dealOtherCard()}else{return this.dealMyCard()}},dealMyCard:function(){this.mySort();this.renderAllCard();this.eventManger.setCardsArr(this.curCardsSP)},changeData:function(a){var c=[];for(var b=0;b<38;b++){c[b]=0}for(var b=0;b<a.length;b++){c[a[b]]++}return c},tingArrHandle:function(){var c=[];for(var f=0;f<this.tingArr.length;f++){var b=this.tingArr[f];if(b&&f!=this.laiIndex){if(b instanceof Array){var g=this.getHuCards(f);cc.log("i:"+f+"-->"+g.toString());for(var e=0;e<g.length;e++){for(var d=0;d<this.curCards.length;d++){if(this.curCards[d]==f){var h={huIndex:d,huCard:g[e]};c.push(h)}}}}else{for(var d=0;d<this.curCards.length;d++){if(this.curCards[d]==f){for(var a=0;a<StaticData.ALL_CARD.length;a++){var h={huIndex:d,huCard:StaticData.ALL_CARD[a]};c.push(h)}}}cc.log(f+"--->听任意牌")}}}return c},getHuCards:function(h){var a=[];var f=[];var g=this.curCards.concat();var c=g.indexOf(h);for(var e=0;e<g.length;e++){if(e!=c){f.push(g[e])}}var d;for(var e=0;e<StaticData.ALL_CARD.length;e++){d=f.concat();var b=StaticData.ALL_CARD[e];d.push(b);d.sort(function(l,k){return l-k});if(this.getHuCardsSub(d)){a.push(b)}}return a},getHuCardsSub:function(e){var d=0;for(var b=0;b<e.length;b++){if(this.parent.mod_hlgc.isCardsCommon(e[b])){d++;e[b]=this.laiIndex}}e=this.changeData(e);e[this.laiIndex]=0;var c=this._qiDuiLogic(e,d,1);var a=this._huPaiLogic(e,d);if(c||a){return true}return false},checkListen:function(){this.tingArr=[];this.isTing=true;var f=this.curCards.concat();this.laiIndex=0;if(this.parent.mod_hlgc.gameInfo.Razz&&this.parent.mod_hlgc.gameInfo.Razz.length>0){this.laiIndex=this.parent.mod_hlgc.gameInfo.Razz[0]}for(var d=0;d<f.length;d++){if(f[d]==this.laiIndex){continue}if(this.parent.mod_hlgc.isCardsCommon(f[d])){f[d]=this.laiIndex}}var c=this.changeData(f);for(var d=0;d<c.length;d++){if(!c[d]||d%10==0){continue}var e=c.slice(0);e[d]--;this.laiziAcount=e[this.laiIndex];e[this.laiIndex]=0;var h=this.laiziAcount;h++;var g=this._qiDuiLogic(e,h,1);var b=this._huPaiLogic(e,h);if(g==100){this.tingArr[d]=100}else{if(!g){g=[]}if(!b){b=[]}var a=g.concat(b);if(a&&a.length){this.tingArr[d]=a}if(a==100){this.tingArr[d]=100}}}this.tingArr=this.tingArrHandle();this.showTingLogo()},_huPaiLogic:function(b,h){var g=this;var f=false;var a=0;var e=function(t,r,s){a++;var o=t.slice(0);var l=s.slice(0);var p=r;for(var n=1;n<=7;n++){if(p-parseInt((n-1)/3)<0){continue}if(f&&(n==2||n==5)){continue}if(g._getFristType(n,o,s)){if(n==2||n==5){if(!f){f=true}}p-=parseInt((n-1)/3);var k=e(o,p,s);a--;if(k==100){return 100}if(k&&f){return true}o=t.slice(0);p=r;s.splice(0);for(var m=0;m<l.length;m++){s[m]=l[m]}if(n==2||n==5){f=false}}}var q=0;for(var n=0;n<o.length;n++){if(o[n]){q+=o[n]}}if(q==0&&r>0){return 100}if(q==0){return true}return false};var c=[];var d=e(b,h,c);if(d==100){return 100}if(d&&f){return c}return false},_qiDuiLogic:function(a,e,d){if(!d){if(this.curCards.length!=13){return false}}else{if(this.curCards.length!=14){return false}}var g=[];var b=a.slice(0);for(var c=0;c<b.length;c++){if(b[c]%2==1&&e){g.push(c);if(c!=this.parent.laiziNum){e--;b[this.parent.laiziNum]--}}else{if(b[c]%2!=0&&e==0){return false}}}var f=false;if(g.length==0){for(var c=0;c<b.length;c++){if(b[c]%2==0&&e>=2){f=true}else{f=false;return f}}if(f){return 100}}return g},_getFristType:function(c,a,e){for(var d=0;d<a.length;d++){if(!a[d]){continue}if(c==1){if(d<30){if(a[d]&&a[d+1]&&a[d+2]){a[d]-=1;a[d+1]-=1;a[d+2]-=1;return true}}if(d==35&&a[d]){if(a[d+1]&&a[d+2]){a[d]-=1;a[d+1]-=1;a[d+2]-=1;return true}}if(d==36&&a[d]){if(a[d-1]&&a[d+1]){a[d-1]-=1;a[d]-=1;a[d+1]-=1;return true}}if(d==37&&a[d]){if(a[d-2]&&a[d-1]){a[d-2]-=1;a[d]-=1;a[d-1]-=1;return true}}}else{if(c==2){if(a[d]>=2){a[d]-=2;return true}}else{if(c==3){if(a[d]>=3){a[d]-=3;return true}}else{if(c==4){if(d<30){if(a[d]&&a[d+1]){a[d]-=1;a[d+1]-=1;if((d-1)%10!=0){if(e.indexOf(d-1)<0){e.push(d-1)}}if((d+2)%10!=0){if(e.indexOf(d+2)<0){e.push(d+2)}}return true}else{if(a[d]&&a[d+2]){if((d+1)%10!=0){a[d]-=1;a[d+2]-=1;if(e.indexOf(d+1)<0){e.push(d+1)}return true}}}}if(d==35){if(a[d]&&a[d+1]){a[d]-=1;a[d+1]-=1;if((d+2)%10!=0){if(e.indexOf(d+2)<0){e.push(d+2)}}return true}else{if(a[d]&&a[d+2]){a[d]-=1;a[d+2]-=1;if((d+1)%10!=0){if(e.indexOf(d+1)<0){e.push(d+1)}}return true}}}if(d==36){if(a[d]&&a[d-1]){a[d]-=1;a[d-1]-=1;if((d+1)%10!=0){if(e.indexOf(d+1)<0){e.push(d+1)}}return true}else{if(a[d]&&a[d+1]){a[d]-=1;a[d+1]-=1;if((d-1)%10!=0){if(e.indexOf(d-1)<0){e.push(d-1)}}return true}}}if(d==37){if(a[d]&&a[d-2]){a[d]-=1;a[d-2]-=1;if((d-1)%10!=0){if(e.indexOf(d-1)<0){e.push(d-1)}}return true}else{if(a[d]&&a[d-1]){a[d]-=1;a[d-1]-=1;if((d-2)%10!=0){if(e.indexOf(d-2)<0){e.push(d-2)}}return true}}}}else{if(c==5){if(a[d]>=1){a[d]-=1;if(e.indexOf(d)<0){e.push(d)}return true}}else{if(c==6){if(a[d]>=2){a[d]-=2;if(e.indexOf(d)<0){e.push(d)}return true}}else{if(c==7){if(a[d]>=1&&d<30){a[d]-=1;for(var b=d-2;b<=d+2;b++){if(parseInt(d/10)==parseInt(b/10)){if(e.indexOf(b)<0){if(b%10!=0){e.push(b)}}}}return true}}}}}}}}}return false},getCommonGroupArr:function(e){var a=[];if(e==0){return[]}if(e==1){for(var d=0;d<StaticData.CARD_ALL.length;d++){a.push(StaticData.CARD_ALL[d])}}else{if(e==2){for(var d=0;d<StaticData.CARD_ALL.length;d++){for(var c=0;c<StaticData.CARD_ALL.length;c++){a.push([StaticData.CARD_ALL[d],StaticData.CARD_ALL[c]])}}}else{if(e==3){for(var d=0;d<StaticData.CARD_ALL.length;d++){for(var c=0;c<StaticData.CARD_ALL.length;c++){for(var b=0;b<StaticData.CARD_ALL.length;b++){a.push([StaticData.CARD_ALL[d],StaticData.CARD_ALL[c],StaticData.CARD_ALL[b]])}}}}}}return a},checkListenSub:function(h){this.changeData(h);var e=this.checkIsQiDui(h);if(e){this.tingArr=this.getQiArr(h)}var f=this.makeSureNum(h);var b=h.slice(0);for(var c=0;c<h.length;c++){for(var a=0;a<f.length;a++){var d=b.slice(0);d[c]=f[a];this.changeData(d);this.Jiang=0;if(this.checkIsHu()){var g={huIndex:c,huCard:f[a]};this.tingArr.push(g)}}}},makeSureNum:function(d){var a=[];for(var b=0;b<d.length;b++){a.push(d[b]);if(d[b]<gameclass.HLGC_MAX_TxtCARD_NUM){a.push(d[b]-1);a.push(d[b]+1)}}var c=[];for(var b in a){if(c.indexOf(a[b])==-1){if(a[b]>0&&a[b]%10!=0){c.push(a[b])}}}c.sort(function(f,e){return f-e});return c},checkIsQiDui:function(d){if(d.length!=14){return 0}var a=this.PAI.slice(0);var b=0;for(var c=0;c<=a.length;c++){if(a[c]&&a[c]!=0){if(a[c]==4){return 0}if(a[c]>=2){a[c]-=2;b++}}}if(b==6){for(var c in a){if(a[c]==1){this.tingArr.push(c)}}return 1}else{return 0}},checkIsHu:function(){var a=this.PAI;if(!this.Remain()){return 1}for(var b=1;b<a.length;b++){if(a[b]&&a[b]!=0){if(a[b]>=3){a[b]-=3;if(this.checkIsHu()){return 1}a[b]+=3}if(!this.Jiang&&a[b]>=2){this.Jiang=1;a[b]-=2;if(this.checkIsHu()){return 1}a[b]+=2;this.Jiang=0}if(b%10!=8&&b%10!=9&&a[b+1]&&a[b+2]&&b<gameclass.HLGC_MAX_TxtCARD_NUM){a[b]--;a[b+1]--;a[b+2]--;if(this.checkIsHu()){return 1}a[b]++;a[b+1]++;a[b+2]++}}}return 0},Remain:function(){var b=0;for(var a=1;a<this.PAI.length;a++){if(this.PAI[a]){b+=this.PAI[a]}}return b},showTingLogo:function(){if(this.tingArr.length==0){return}for(var b=0;b<this.tingArr.length;b++){var a=new cc.Sprite(res.img_ting);this.curCardsSP[this.tingArr[b].huIndex].addChild(a);a.setPosition(20,85)}},getQiArr:function(f){if(this.tingArr.length==0){return}var d=[];var g=this.tingArr.toString();for(var b=0;b<f.length;b++){if(g.indexOf(f[b].toString())>-1){for(var a=0;a<this.tingArr.length;a++){if(f[b]==this.tingArr[a]){var e={huIndex:b,huCard:Number(this.tingArr[(a+1)%2])};d.push(e);break}}}}return d},showHuPoke:function(a){var c=gameclass.hlgc.Table.CreateCard(a,this.index,2,0);c.setColor(new cc.color(127,127,127));var b=cc.p(this.drawCardPos);if(this.index==0){b.x+=15;b.y+=(c.height*c.getScale())/2}else{if(this.index==1){}else{if(this.index==2){b.x+=20;b.y+=(c.height*c.getScale())/2}else{if(this.index==3){b.x+=(c.width*c.getScale())/2;b.y+=(c.height*c.getScale())/2}}}}c.setPosition(b);this.handNode.addChild(c)},onChat:function(c){var f=this;var d=[res.chatbg_ld,res.chatbg_rd,res.chatbg_lt,res.chatbg_ld,];if(c.type==1){var k=new ccui.Layout();var e=new cc.Scale9Sprite(d[this.index]);e.setCapInsets(cc.rect(60,10,10,10));e.setAnchorPoint(0,0);e.setPosition(-15,-15);k.addChild(e);k=this.showStringChat(c,k,e);this.node.addChild(k);var h=cc.sequence(cc.delayTime(3),cc.callFunc(function(){k.removeFromParent(true)}));k.runAction(h)}else{if(c.type==2){var g=Number(c.chat);var a=new cc.Sprite();a.initWithFile(g_face[g]);var b=new ccui.Layout();b.setContentSize(a.width+30,a.height+20);b.setBackGroundImage(d[this.index]);b.setBackGroundImageScale9Enabled(true);b.setAnchorPoint(0.5,0.5);b.addChild(a);a.setPosition(0.5*b.getContentSize().width,0.5*b.getContentSize().height);this.node.addChild(b,1111);if(this.index==0){b.setPositionX(this.node.getContentSize().width);b.setPositionY(this.node.getContentSize().height)}else{if(this.index==1){b.setPositionY(this.node.getContentSize().height)}else{if(this.index==2){b.setPositionX(this.node.getContentSize().width);b.setPositionY(50)}else{if(this.index==3){b.setPositionX(this.node.getContentSize().width);b.setPositionY(this.node.getContentSize().height)}}}}var h=cc.sequence(cc.delayTime(2),cc.callFunc(function(){b.removeFromParent(true)}));this.node.runAction(h)}else{if(c.type==3){gameclass.mod_platform.playurl(c.chat);this.voiceSp.setVisible(true);var h=cc.sequence(cc.delayTime(2),cc.callFunc(function(){f.voiceSp.setVisible(false)}));this.node.runAction(h)}}}},showStringChat:function(f,a,e){var b=new cc.LabelTTF(f.chat,"Arial",36);b.setAnchorPoint(cc.p(0,0));b.setPosition(0,5);if(this.index==2){b.setPosition(0,-5)}b.setColor(cc.color(0,0,0));a.addChild(b);var d=[this.node.getContentSize().height,this.node.getContentSize().height/2,-0,this.node.getContentSize().height/2];var c=[0,b.getContentSize().width*-1,50,this.node.getContentSize().width];a.setPosition(cc.p(c[this.index],d[this.index]));e.setContentSize(b.getContentSize().width+30,b.getContentSize().height+30);return a},getConnectPengGangData:function(a){this.pengGangArr=a},showControlAct:function(a){this.operateSp.setVisible(true);var b=this;if(a==0){this.operateSp.setTexture(res.img_peng)}else{if(a==1){this.operateSp.setTexture(res.img_gang)}else{if(a==2){this.operateSp.setTexture(res.img_oneHu)}else{if(a==3){this.operateSp.setTexture(res.img_twoHu)}else{if(a==4){this.operateSp.setTexture(res.img_threeHu)}}}}}this.operateSp.stopAllActions();this.operateSp.runAction(cc.sequence(cc.delayTime(0.8),cc.fadeOut(0.8),cc.callFunc(function(){b.operateSp.setVisible(false);b.operateSp.setOpacity(255)})))},});gameclass.OpBox=cc.Sprite.extend({_cardNums:null,_index:null,_differY:null,_isGray:null,ctor:function(b){this._super();var d=[0,14,0,14];var c=[23,14,13,14];var a=[13,14,13,14];this._cardNums=b.nums;this._index=b.index;this._differY=d[b.index];this.normalUp=c[b.index];this.replayUp=a[b.index];this._isGray=b.isGray||false;switch(b.type){case"peng":this.initPeng(b.state,b.pengbackIndex);break;case"gang":this.initGang(b.gangType,b.state);break}},initPeng:function(b,f){var k=this._cardNums[0];var m=(this._index%2)==0?1:0;var l=(this._index%2)==1?1:0;if(this._index==3){if(f==0){f=2}else{if(f==2){f=0}}}for(var h=0;h<3;h++){var d=null;if(b=="huifang"&&this._index==0){d=gameclass.hlgc.Table.CreateCard(k,2,2,0,b)}else{if(h==f){d=gameclass.hlgc.Table.CreateCard(k,this._index,1,0)}else{d=gameclass.hlgc.Table.CreateCard(k,this._index,2,0)}}if(this._isGray){d.setColor(cc.color(169,169,169))}if(l){d.setLocalZOrder(100-h)}this.addChild(d)}var e=this.getChildren();var c=e[0].getScale();var n=cc.size(e[0].getContentSize().width*c,e[0].getContentSize().height*c);var g,a;for(var h=0;h<e.length;h++){if(this._index==0){e[h].setPosition(h*(n.width-3)*m,h*(n.height-this._differY)*l)}else{if(this._index==1||this._index==3){e[h].setPosition(h*(n.width)*m,h*(n.height-this._differY-3)*l)}else{e[h].setPosition(h*(n.width-2)*m,h*(n.height-this._differY)*l)}}g=e[h].getPositionX()+n.width;a=e[h].getPositionY()+n.height}this.setContentSize(cc.size(g,a))},initGang:function(b,c){var m=[];var k=this._cardNums[0];if(k==StaticData.WIND_GANG){m=StaticData.WIND_GANG_ARR}else{m=[k,k,k,k]}var n=(this._index%2)==0?1:0;var l=(this._index%2)==1?1:0;for(var h=0;h<4;h++){var e=null;if(b==0){if(c=="huifang"&&this._index==0){e=gameclass.hlgc.Table.CreateCard(m[h],2,1,1,c)}else{if(this._index==0){if(h<3){e=gameclass.hlgc.Table.CreateCard(m[h],this._index,1,1)}else{e=gameclass.hlgc.Table.CreateCard(m[h],this._index,2,0)}}else{e=gameclass.hlgc.Table.CreateCard(m[h],this._index,1,1)}}}else{if(c=="huifang"&&this._index==0){e=gameclass.hlgc.Table.CreateCard(m[h],2,2,0,c)}else{e=gameclass.hlgc.Table.CreateCard(m[h],this._index,2,0)}}if(l){e.setLocalZOrder(100-h)}this.addChild(e)}var f=this.getChildren();var d=f[0].getScale();var o=cc.size(f[0].getContentSize().width*d,f[0].getContentSize().height*d);var g,a;for(var h=0;h<f.length;h++){if(h<3){if(this._index==0){f[h].setPosition(h*(o.width-3)*n,h*(o.height-this._differY)*l)}else{if(this._index==1||this._index==3){f[h].setPosition(h*(o.width)*n,h*(o.height-this._differY-3)*l)}else{f[h].setPosition(h*(o.width-2)*n,h*(o.height-this._differY)*l)}}g=f[h].getPositionX()+o.width;a=f[h].getPositionY()+o.height}else{if(c=="huifang"&&this._index==0){f[3].setPosition(f[1].getPosition().x,f[1].getPosition().y+this.replayUp)}else{f[3].setPosition(f[1].getPosition().x,f[1].getPosition().y+this.normalUp)}f[3].setLocalZOrder(100)}}this.setContentSize(cc.size(g,a))},});gameclass.majonLisenter=cc.Class.extend({_isDrag:false,_isSlide:false,_isTouch:false,_isInvalid:false,_callBacks:null,_beginPos:null,_cardsSp:null,_curTarget:null,_planeNode:null,_cardposition:null,_playerc:null,ctor:function(a){this._playerc=a.playerc;this._cardsSp=a.cards||null;if(!this._cardsSp){throw new Error("无效是牌组");return}this._planeNode=a.plane||null;if(!this._planeNode){throw new Error("无效是监听节点");return}this._callBacks={};this.addClickEvent()},on:function(b,a){this._callBacks[b]=a},setCardsArr:function(a){this._cardsSp=a},addClickEvent:function(){var a=this;cc.eventManager.addListener(cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:function(c,b){if(a._isDrag){return false}if(a._isTouch){return false}a._isDrag=a._isSlide=a._isInvalid=false;a._beginPos=c.getLocation();a._isTouch=true;a.checkInvalid();return true},onTouchMoved:function(e,b){if(a._isInvalid){return true}if(a._isDrag){if(a._callBacks.drag){a._callBacks.drag(a._curTarget,e.getLocation())}return true}else{if(a._isSlide){var c=a.getSpWithpos(e.getLocation());if(c){a._curTarget=c}if(a._callBacks.slide){a._callBacks.slide(a._curTarget,e.getLocation())}return true}else{var d=e.getLocation();if(d.y-a._beginPos.y>20){a._isDrag=true;if(a._callBacks.dragBegin){a._cardposition=a._curTarget.getPosition();a._callBacks.dragBegin(a._curTarget,e.getLocation(),a._curTarget.getPosition())}return true}if(!a.checkPosInSp(d,a._curTarget)){if(a.getSpWithpos(d)){if(a._callBacks.slideBegin){a._callBacks.slideBegin(a._curTarget,e.getLocation())}}}return true}}},onTouchEnded:function(b){a._isTouch=false;if(a._isInvalid){return true}if(a._isDrag){if(a._callBacks.dragEnd){a._isDrag=false;a._callBacks.dragEnd(a._curTarget,b.getLocation())}}else{if(a._isSlide){if(a._callBacks.slideEnd){a._isSlide=false;a._callBacks.slideEnd(a._curTarget,b.getLocation())}}else{if(a._callBacks.click){a._callBacks.click(a._curTarget,b.getLocation())}}}},onTouchCancelled:function(b){a._playerc.renderAllCard();return true},}),this._planeNode)},checkInvalid:function(){var a=this.getSpWithpos(this._beginPos);if(a){this._curTarget=a}return this._isInvalid=(a==false)},checkPosInSp:function(d,c,b){var a=c.convertToNodeSpace(d);if(!b){b=cc.rect(0,0,c.getContentSize().width,c.getContentSize().height)}return cc.rectContainsPoint(b,a)},getSpWithpos:function(d){if(!this._cardsSp||this._cardsSp.length==0){return false}if(!this._cardsSp||this._cardsSp.length<1){return false}var c=this._cardsSp[0].getContentSize();var b=cc.rect(0,0,c.width,c.height);for(var a=0;a<this._cardsSp.length;a++){if(this.checkPosInSp(d,this._cardsSp[a],b)){return this._cardsSp[a]}}return false},});gameclass.hlgc=gameclass.hlgc||{};gameclass.hlgc.Table=gameclass.baseui.extend({node:null,mod_hlgc:null,playerHeads:null,roomInfo:null,ciNum:null,uiLayer:null,outPokerLayer:null,arrowSp:null,shineSpArr:[],lastCardNum:null,lastCardSp:null,lastChairNum:null,playerSendNum:null,playerHandCardSp:null,playerPengGangNodeArr:null,playerPengGangArr:null,tishiNode:null,cardNumText:null,cardNum:null,outPokerManager:null,seeObj:null,allSlect:false,curPersons:0,_seatContain:null,_readyBtn:null,_userPosArr:null,_baoContain:null,_tingContain:null,_curTime:30,timeTxt:null,isHaidiLao:null,isSeat:null,ctor:function(){this._super();this.playerHeads=[];this.seeObj={};this._curTime=30;this.isHaidiLao=false;this.isSeat=false},show:function(){var b=this;cc.spriteFrameCache.addSpriteFrames(res.mah_bg_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_text_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_down_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_out_left_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_out_right_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_out_ver_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_back_plist);gameclass.languageType=gameclass.languageType||0;this.node=this.game.uimgr.createnode(res.hlgcTable,true);this.node.setPosition((cc.winSize.width-this.node.getContentSize().width)/2,0);this.addChild(this.node);this.uiLayer=ccui.helper.seekWidgetByName(this.node,"uiLayer");this.controlLayer=ccui.helper.seekWidgetByName(this.node,"controlLayer");this.arrowSp=ccui.helper.seekWidgetByName(this.node,"arrow");ccui.helper.seekWidgetByName(this.node,"director").setScale(1.2);this._tingContain=new ccui.Layout();this.uiLayer.addChild(this._tingContain);this._seatContain=this.uiLayer.getChildByName("seatContain");this._seatContain.setVisible(false);this._cheatBtn=ccui.helper.seekWidgetByName(this.uiLayer,"cheatBtn");this.betLayer=ccui.helper.seekWidgetByName(this.uiLayer,"betLayer");for(var d=0;d<this.betLayer.getChildrenCount();d++){var e=this.betLayer.getChildren()[d];e.index=d;e.addTouchEventListener(function(f,g){if(g!=ccui.Widget.TOUCH_ENDED){return}b.mod_hlgc.sendGetBet(f.index);b.betLayer.setVisible(false)},this)}this._readyBtn=ccui.helper.seekWidgetByName(this.uiLayer,"readyBtn");for(var d=0;d<4;d++){var c=ccui.helper.seekWidgetByName(this.uiLayer,"Button_"+d);c.addTouchEventListener(function(f,g){if(g==ccui.Widget.TOUCH_ENDED){b.mod_hlgc.sendSeat(f.getTag())}})}this.shineSpArr=[];for(var d=0;d<gameclass.HLGC_MAX_USER;d++){var a=ccui.helper.seekWidgetByName(this.node,"d"+d+"Sp");this.shineSpArr.push(a);a.setVisible(false)}this.jushuText=ccui.helper.seekWidgetByName(this.controlLayer,"roundTxt");this.cardNumText=ccui.helper.seekWidgetByName(this.controlLayer,"remainCard");this.timeTxt=ccui.helper.seekWidgetByName(this.controlLayer,"timeTxt");this.timeTxt.setString("");this.arrowSp.setVisible(false);this.cardNumText.setVisible(false);this.outPokerLayer=ccui.helper.seekWidgetByName(this.controlLayer,"outPokerLayer");this.btn_guo=ccui.helper.seekWidgetByName(this.uiLayer,"btn_guo");this.btn_gang=ccui.helper.seekWidgetByName(this.uiLayer,"btn_gang");this.btn_peng=ccui.helper.seekWidgetByName(this.uiLayer,"btn_peng");this.btn_hu=ccui.helper.seekWidgetByName(this.uiLayer,"btn_hu");this.cardCommonNode=ccui.helper.seekWidgetByName(this.uiLayer,"cardCommonNode");this.btn_guo.setName("btn_guo");this.btn_gang.setName("btn_gang");this.btn_peng.setName("btn_peng");this.btn_hu.setName("btn_hu");this.saveArr=[];this.starpointer=ccui.helper.seekWidgetByName(this.controlLayer,"starpointer");this.gangLayer=ccui.helper.seekWidgetByName(this.uiLayer,"gangLayer");this.mahLayer=ccui.helper.seekWidgetByName(this.uiLayer,"mahLayer");this.gangLayer.setVisible(false);this.initBtnState();this._baoContain=new ccui.Layout();this.addChild(this._baoContain)},initBtnState:function(){this.btn_guo.setVisible(false);this.btn_gang.setVisible(false);this.btn_peng.setVisible(false);this.btn_hu.setVisible(false)},listenTest:function(){this.mod_hlgc.gameInfo.Razz=[];this.playerHeads[0].curCards=[1,1,1,2,2,2,3,3,3,4,5,6,7,13];this.playerHeads[0].checkListen()},setmod:function(b){this.mod_hlgc=b;this.mod_hlgc.bindUI(this);var g=this;this.starpointer.setVisible(false);this.maxNum=this.mod_hlgc.maxNum;this._userPosArr=[];for(var e=0;e<gameclass.HLGC_MAX_USER;e++){var f=ccui.helper.seekWidgetByName(this.uiLayer,"head_"+e);this._userPosArr.push(f.getPosition());this.playerHeads[e]=new gameclass.hlgc.Player(f,e,this.uiLayer,this.controlLayer,this);this.playerHeads[e].setGame(this.game)}this.outPokerManager=new gameclass.outPokerLayer({outNode:this.outPokerLayer,parent:this,});gameclass.createbtnpress(g.uiLayer,"btn_invite",function(){g.share()});gameclass.createbtnpress(g.uiLayer,"settingBtn",function(){var n=[1,1,1,1,2,2,2,2,3,3,35,36,37,14];var o={card:n};g.mod_hlgc.Testcard(o);g.game.uimgr.showui("gameclass.FightSetView").setMod(g.mod_hlgc)});if(g.mod_hlgc.roominfo.time!=0){g.game.uimgr.showui("gameclass.exitroom",false);g.game.uimgr.uis["gameclass.exitroom"].setData(g.mod_hlgc,g.mod_hlgc.roominfo)}gameclass.createbtnpress(g.node,"chatbtn",function(){g.game.uimgr.showui("gameclass.chatui");g.game.uimgr.uis["gameclass.chatui"].setmod(g.mod_hlgc)});gameclass.createbtnpress(g.uiLayer,"btn_peng",function(){g.mod_hlgc.sendPeng();g.initBtnState()});gameclass.createbtnpress(g.uiLayer,"btn_gang",function(){var n=g.playerHeads[0].getGangNum(g.lastCardNum);g.initBtnState();if(n.length<1){return false}if(g.lastCardNum){for(var o=0;o<n.length;o++){if(n[o]==g.lastCardNum){g.mod_hlgc.sendGang(g.lastCardNum);return false}}}if(g.playerHeads[0].gangNum){g.mod_hlgc.sendGang(g.playerHeads[0].gangNum);return false}if(n.length>1){g.showClickWindow(n)}else{g.mod_hlgc.sendGang(n[0])}return false});gameclass.createbtnpress(g.uiLayer,"btn_hu",function(){g.mod_hlgc.sendHu();g.initBtnState()});gameclass.createbtnpress(g.uiLayer,"btn_guo",function(){g.sendGuoCallBack()});gameclass.createbtnpress(g.uiLayer,"btn_exitGang",function(){g.gangLayer.setVisible(false);g.gangLayer.getChildByName("mahLayer").removeAllChildren(true);g.resetBtnState(true)});gameclass.createbtnpress(g.uiLayer,"cheatBtn",function(){if(g.mod_hlgc.gameInfo&&g.mod_hlgc.gameInfo.begin){g.game.uimgr.showui("gameclass.hlgc.cheatPlayMo").setmod(g.mod_hlgc)}else{g.game.uimgr.showui("gameclass.hlgc.cheatPrevPlay").setmod(g.mod_hlgc)}});gameclass.createbtnpress(g.uiLayer,"readyBtn",function(){g.mod_hlgc.sendGameReady()});var l=ccui.helper.seekWidgetByName(g.node,"mic");var c=ccui.helper.seekWidgetByName(g.node,"miclayer");c.setVisible(false);var k=ccui.helper.seekWidgetByName(g.node,"imgmic");var a=cc.sequence(cc.scaleTo(0.8,1),cc.scaleTo(0.8,0.8));k.runAction(cc.repeatForever(a));var d=mod_sound.getEffectsVolume();var h=mod_sound.getMusicVolume();var m=function(n,o){switch(o){case ccui.Widget.TOUCH_BEGAN:d=mod_sound.getEffectsVolume();h=mod_sound.getMusicVolume();mod_sound.setEffectsVolume(0);mod_sound.setMusicVolume(0);c.setVisible(true);gameclass.mod_platform.begmic();break;case ccui.Widget.TOUCH_ENDED:c.setVisible(false);gameclass.mod_platform.endmic();mod_sound.setEffectsVolume(Number(d));mod_sound.setMusicVolume(Number(h));break;case ccui.Widget.TOUCH_CANCELED:c.setVisible(false);gameclass.mod_platform.cancelmic();mod_sound.setEffectsVolume(Number(d));mod_sound.setMusicVolume(Number(h));break}};l.addTouchEventListener(m);this.safeLayer=new gameclass.checkSafeLayer(this.node,this.game,null);this.safeLayer.setName("safeLayer");this.node.addChild(this.safeLayer)},chatshowinfo:function(a,c){this.playerHeads[a].onChat(c);if(c.type==1){for(var b=0;b<g_womanTalk.length;b++){if(c.chat==g_chatstr[b]){mod_sound.playeffect(g_womanTalk[b]);break}}}},betCheck:function(){this.betLayer.setVisible(false);for(var b=0;b<this.mod_hlgc.gameInfo.info.length;b++){var a=this.mod_hlgc.gameInfo.info[b];if(a.uid==this.game.modmgr.mod_login.logindata.uid){if(a.piao<0&&!this.mod_hlgc.gameInfo.begin&&this.mod_hlgc.roomSetArr[3]==1&&this.isSeat){this.betLayer.setVisible(true)}}this.gamebets(a.uid,a.piao)}},gamebets:function(b,c){if(this.mod_hlgc.roomSetArr[3]==1){var a=this.mod_hlgc.getPlayerIndexById(b);if(c==0){this.playerHeads[a].betTxt.setString("不跑")}else{if(c==1){this.playerHeads[a].betTxt.setString("跑 x1")}else{if(c==2){this.playerHeads[a].betTxt.setString("跑 x2")}else{this.playerHeads[a].betTxt.setString("")}}}}},checkCardArr:function(a){var c=false;if(a.length!=3){return c}for(var b=0;b<a.length;b++){if(parseInt(a[b]/10)==parseInt(a[b+1]/10)&&parseInt(a[b]/10)==parseInt(a[b+2]/10)){c=true}}return c},showSystemCard:function(){this.playerHeads[0].slectIndex()},sendGangCallBack:function(){this.gangLayer.setVisible(false);this.mahLayer.removeAllChildren()},showClickWindow:function(h){if(this.uiLayer.getChildByTag(112233)){this.uiLayer.removeChildByTag(112233)}var c=80;var g=[];this.gangLayer.setVisible(true);var f=cc.p((this.mahLayer.width-(h.length-1)*100)/2,0);for(var b=0;b<h.length;b++){var k=new ccui.Button();k.loadTextureNormal(res.tishiSpBg,0);var a;if(h[b]==StaticData.WIND_GANG){a=StaticData.WIND_DONG}else{a=h[b]}var l=gameclass.hlgc.Table.getCardTextStr(a);var e=new cc.Sprite();e.initWithSpriteFrameName(l);e.setScale(0.65);e.setPosition(k.getContentSize().width/2,k.getContentSize().height/2);k.addChild(e);k.slectedNum=h[b];g.push(k);k.setAnchorPoint(0,0);k.setScale(0.8);k.setPosition(f.x+b*c,f.y);this.mahLayer.addChild(k)}var d=this;for(var b=0;b<g.length;b++){g[b].addTouchEventListener(function(m,n){switch(n){case ccui.Widget.TOUCH_ENDED:d.mod_hlgc.sendGang(m.slectedNum);break}})}},createTingContinue:function(g){this._tingContain.removeAllChildren();if(g==null||g.length==0){return}var c=5;var l=cc.p(0,0);var a=new ccui.Layout();a.setBackGroundImage(res.tishiBgAlpha);a.setBackGroundImageScale9Enabled(true);a.setAnchorPoint(0,0);a.setPosition(10,c);this._tingContain.addChild(a);var h=new cc.Sprite("res/ui/gxDdz/ting.png");h.setAnchorPoint(cc.p(0,0));a.addChild(h);h.setScale(0.3);var f=h.getContentSize().width*h.getScale()+5;var d=0;var b={};for(var e in this.seeObj){b[e]=this.seeObj[e]}for(var e=0;e<this.playerHeads[0].curCards.length;e++){b[this.playerHeads[0].curCards[e]]++}for(var e=0;e<g.length;e++){var k=gameclass.hlgc.Table.CreateCard(g[e],0,0,0);k.setAnchorPoint(0,0);k.setScale(0.3);if(e==0){k.setPosition(f,c)}else{k.setPosition(f+5,c)}k.setPosition(f+5,c);a.addChild(k);f=k.getPositionX()+k.getContentSize().width*k.getScale();d=k.getPositionY()+k.getContentSize().height*k.getScale()}l=this.setTingWindowSize(g.length,this.creatListenSp(1));a.setContentSize(f+c,d+c)},showTingWindow:function(l){if(l.length==0){return}this.gangLayer.setVisible(false);l.sort(function(r,q){return r-q});var h=this;var n=function(q,r){switch(r){case ccui.Widget.TOUCH_ENDED:if(h.uiLayer.getChildByTag(112233)){h.uiLayer.removeChildByTag(112233)}break}};var p=cc.p(0,0);if(this.uiLayer.getChildByTag(112233)){this.uiLayer.removeChildByTag(112233)}if(!this.uiLayer.getChildByTag(112233)){this.tishiNode=new ccui.Layout();this.tishiNode.setBackGroundImage(res.tishiBg);this.tishiNode.setBackGroundImageScale9Enabled(true);this.tishiNode.setAnchorPoint(0,0);p=this.setTingWindowSize(l.length,this.creatListenSp(1));this.tishiNode.setContentSize(p.y,p.x);var g=(cc.winSize.width-p.y)/2;this.tishiNode.setPosition(g,120);this.tishiNode.setTag(112233);var m=new ccui.Button();m.setContentSize(1136,520);m.setScale9Enabled(true);var b=this.tishiNode.convertToNodeSpace(cc.p(cc.winSize.width/2,520/2+120));m.setPosition(b);m.addTouchEventListener(n);this.tishiNode.addChild(m);this.uiLayer.addChild(this.tishiNode)}var d=25;var k=cc.p(0,0);var a={};for(var c in this.seeObj){a[c]=this.seeObj[c]}for(var c=0;c<this.playerHeads[0].curCards.length;c++){a[this.playerHeads[0].curCards[c]]++}for(var c=0;c<l.length;c++){var o=this.creatListenSp(l[c]);var f=4-a[l[c]];var e=new cc.LabelTTF(f+"张","Arial",30);e.setPosition(o.width/2,100);e.setColor(new cc.color(255,0,0));o.setAnchorPoint(0,0);o.setScale(0.8);o.setPosition(this.setTingSpPos(c,p,o));o.addChild(e);this.tishiNode.addChild(o)}},setTingWindowSize:function(a,d){var e=Math.ceil(a/7);var b=0;if(a<8){b=a%8}else{b=7}var c=cc.p(e*95,b*d.width*0.8+(b-1)*25+2*25);return c},setTingSpPos:function(e,d,b){var f=parseInt(e/7)+1;var c=parseInt(e%7)+1;var a=c*b.width*0.8+(c-1)*25-25;var h=d.x-f*95;var g=cc.p(a,h);return g},creatListenSp:function(c){var b=new cc.Sprite(res.tishiSpBg);var a=new cc.Sprite();a.initWithSpriteFrameName(gameclass.hlgc.Table.getCardTextStr(c));a.setPosition(b.width/2,b.height/2);a.setScale(0.65);b.addChild(a);return b},getSex:function(a){var b=this.playerHeads[a].sex;if(b==1||b==2){return b-1}else{return 0}},initUserBaseView:function(a){this.playerHeads[a].initBaseView()},updateCardCommon:function(){this.cardCommonNode.removeAllChildren();if(this.mod_hlgc.gameInfo.Razz==null){return}for(var c=0;c<this.mod_hlgc.gameInfo.Razz.length;c++){var b=this.mod_hlgc.gameInfo.Razz[c];var a=gameclass.hlgc.Table.CreateCard(b,2,2,0);this.cardCommonNode.addChild(a);a.setPositionX(c*40)}},setPlayerState:function(b){for(var a=0;a<b.length;a++){if(b[a]){if(b[a].line){this.playerHeads[a].offLineImg.setVisible(false)}else{this.playerHeads[a].offLineImg.setVisible(true)}}}},setSeatBtn:function(){for(var b=0;b<4;b++){ccui.helper.seekWidgetByName(this.node,"Button_"+b).setVisible(false);this._seatContain.setVisible(false);var a=this._seatContain.getChildren();a[b].setVisible(false)}},userLineOut:function(a,b){if(this.playerHeads[a].offLineImg==null){cc.log("2")}if(b.line){this.playerHeads[a].offLineImg.setVisible(false)}else{this.playerHeads[a].offLineImg.setVisible(true)}},setPointerAct:function(b,d){this.starpointer.setAnchorPoint(0.5,0.5);this.starpointer.setScale(1);this.starpointer.stopAllActions();var a=[0.35,0.5,0.35,0.5];this.starpointer.x=b.x;this.starpointer.y=b.y+a[d]*b.getContentSize().width;this.starpointer.setVisible(true);this.starpointer.setLocalZOrder(30);var c=cc.repeatForever(cc.sequence(cc.spawn(cc.moveTo(0.5,cc.p(this.starpointer.x,this.starpointer.y+2.5)),cc.fadeTo(0.5,255)),cc.spawn(cc.moveTo(0.5,cc.p(this.starpointer.x,this.starpointer.y-2.5)),cc.fadeTo(0.5,100))));this.starpointer.runAction(c)},sendCard:function(b,d,c,a){this.mod_hlgc.sendCard(b,d,c,a)},onDealCards:function(a){for(var b=0;b<gameclass.HLGC_MAX_USER;b++){if(a[b]!=null&&a[b].length>0){this.playerHeads[b].dealCards(a[b])}}},chuliDataCheckListen:function(){for(var a=0;a<gameclass.HLGC_MAX_USER;a++){if(this.mod_hlgc.persons[a].uid==this.mod_hlgc.myUid&&this.playerHeads[a].curCards.length%3==2){this.playerHeads[a].checkListen();break}}},closeArrow:function(){this.setArrowTowards(-1)},onDrawCard:function(d,c,b){var a={gang:b.gang,hu:b.hu,};this.cardNum--;this.setCardAcount(this.cardNum);this.playerHeads[c].onDrawCard(b.card);if(c==0){this.onOperate(a)}this.setArrowTowards(d);this.updateTime(30)},updateTime:function(b){this._curTime=b;var a=this;a.timeTxt.setString(this._curTime.toString());var c=cc.sequence(cc.delayTime(1),cc.callFunc(function(){a._curTime--;if(a._curTime<0){a._curTime=0}a.timeTxt.setString(a._curTime.toString())}));this.node.stopAllActions();this.node.runAction(cc.repeat(c,this._curTime))},resetBtnState:function(b){if(!this.saveArr){return}for(var a=0;a<this.saveArr.length;a++){this.saveArr[a].setVisible(b)}},showSlectLayout:function(b){for(var a=0;a<gameclass.HLGC_MAX_USER;a++){this.playerHeads[a].showSlectLayout(b[a])}},setSlectVisable:function(a){},showThree:function(b,a){this.playerHeads[b].showSlectLayout(a)},allSlectThree:function(b,a){this.allSlect=true;for(var c=0;c<gameclass.HLGC_MAX_USER;c++){this.playerHeads[c].changeShow();this.playerHeads[c].allSlectThree(b,a)}},changeState:function(b,a){this.playerHeads[b].setQueState(a)},showQue:function(a){this.allSlect=true;for(var b=0;b<gameclass.HLGC_MAX_USER;b++){this.playerHeads[b].setQueState(a[b])}},onSendCard:function(b,d){var a=b<10?"0"+String(b):String(b);var c=String(this.getSex(d)+String(a));if(b>0){if(this.mod_hlgc.isPaoLong){mod_sound.playeffect(g_music.mjClick)}else{var c=String(this.getSex(d)+String(a));mod_sound.playeffect(g_music[c])}}if(!this.seeObj[b]){this.seeObj[b]=0}this.seeObj[b]++;this.lastChairNum=d;this.lastCardNum=b;this.playerHeads[d].onSendCard(b)},checkTableCard:function(a){this.outPokerManager.checkTableCard(a)},onPeng:function(d,c,b,a){this.starpointer.setVisible(false);this.playerHeads[c].onPeng(b,this.lastChairNum,a);this.outPokerManager.removePengGangSp(this.lastChairNum,b);this.lastCardNum=0;this.setArrowTowards(d);if(c==0){this.playerHeads[0].checkListen();this.saveArr=[]}this.seeObj[b]+=2;mod_sound.playeffect(this.getSex(c)==0?g_music.mpeng:g_music.fpeng);this.playerHeads[c].pengDragOne()},onGang:function(c,b,a){this.starpointer.setVisible(false);if(b==StaticData.WIND_GANG){a=1}if(b!=StaticData.WIND_GANG){if(a==1){this.outPokerManager.removePengGangSp(this.lastChairNum,b);this.lastCardNum=0}}if(this.uiLayer.getChildByTag(112233)){this.uiLayer.removeChildByTag(112233)}this.playerHeads[c].onGang(b,a);if(c==0){this.playerHeads[0].checkListen();this.saveArr=[]}mod_sound.playeffect(this.getSex(c)==0?g_music.mgang:g_music.fgang)},onHu:function(g,b,e,f){if(this.playerHeads[g]==null){return}if(g!=0){var c=false;for(var d=0;d<this.saveArr.length;d++){if(this.saveArr[d].getName()=="btn_hu"&&!this.playerHeads[0].isHasHu){c=true}}if(!c){this.initBtnState()}else{this.saveArr=[];this.initBtnState();this.btn_hu.setVisible(true);this.btn_guo.setVisible(true);this.saveArr.push(this.btn_hu);this.saveArr.push(this.btn_guo)}var h=cc.p(1136/2+250-(this.saveArr.length-1)*50,180);var a=150;for(var d=0;d<this.saveArr.length;d++){this.saveArr[d].setPosition(h.x+d*a,h.y)}}else{this.saveArr=[]}this.playerHeads[g].onHu(b,e,f);if(e==1){mod_sound.playeffect(this.getSex(whoIndex)==0?g_music.mhu:g_music.fhu)}else{mod_sound.playeffect(this.getSex(whoIndex)==0?g_music.mhu:g_music.fhu)}},setCardAcount:function(a){this.cardNum=a;this.cardNumText.setString("剩余"+this.cardNum+"张")},onOperate:function(c){if(c.huType&&parseInt(c.huType/10)>0){return}var e=c.gang&&c.gang==1;this.btn_hu.setVisible(c.hu);this.btn_gang.setVisible(e);this.btn_peng.setVisible(c.peng);this.btn_guo.setVisible(c.hu||e||c.peng);this.playerHeads[0].specialOperate=(c.hu||e||c.peng);this.saveArr=[];if(c.hu){this.saveArr.push(this.btn_hu)}if(e){this.saveArr.push(this.btn_gang)}if(c.peng){this.saveArr.push(this.btn_peng)}if(c.hu||e||c.peng){this.saveArr.push(this.btn_guo)}var d=cc.p(1136/2+250-(this.saveArr.length-1)*50,180);var a=120;for(var b=0;b<this.saveArr.length;b++){this.saveArr[b].setPosition(d.x+b*a,d.y)}this.updateTime(15)},sendGuoCallBack:function(){this.playerHeads[0].haveOutPoke=false;this.playerHeads[0].specialOperate=false;this.mod_hlgc.sendGuo();this.initBtnState()},gameBye:function(){if(this.roomInfo.step==this.roomInfo.maxStep){return}var c=this;c.game.uimgr.closeui("gameclass.hlgcResultAllUi");var b=c.game.uimgr.showui("gameclass.hlgcResultAllUi");b.setData(c.mod_hlgc);var a=c.game.uimgr.getui("gameclass.hlgcResultOneUi");if(a!=null){b.setLocalZOrder(a.getLocalZOrder()-1)}},showGameBye:function(){},onSimpleEnd:function(){for(var c=0;c<gameclass.HLGC_MAX_USER;c++){var b=this.shineSpArr[c];b.setVisible(false);b.stopAllActions();this.playerHeads[c].initData()}var d=this;for(var c=0;c<4;c++){this.mod_hlgc.gameInfo.info[c].piao=-1}var a=d.game.uimgr.showui("gameclass.hlgcResultOneUi");a.setDjjsMod(d.mod_hlgc);a.setVisible(false);this.node.scheduleOnce(function(){d.initDeskView();d.updateReadyView();d._baoContain.removeAllChildren();a.setVisible(true)},1.5)},setArrowTowards:function(c){for(var b=0;b<gameclass.HLGC_MAX_USER;b++){var a=this.shineSpArr[b];a.setVisible(false);a.stopAllActions()}if(c<=this.shineSpArr.length-1&&c>=0){this.shineSpArr[c].setVisible(true)}},updateDirect:function(m){this.arrowSp.setVisible(true);var h=0;cc.log("玩家数据",m);var a=1;var b=1;var l=0;var g=[null,null,null,null];for(var e=0;e<m.length;e++){if(!m[e]||m[e].seat<0){continue}g[(m[e].seat-this.mod_hlgc._mySeat+4)%4]=gameclass.mod_base.deepCopy(m[e])}var k=m.length;for(var e=0;e<k;e++){var f=g[e];if(f!=null&&f.deal){l=e;b=l-a;break}}var d=l*90;cc.log("旋转的角度",-d);this.arrowSp.setRotation(-d);for(var e=0;e<gameclass.HLGC_MAX_USER;e++){var n=this.shineSpArr[e];n.setVisible(false);var c=(e-b+gameclass.HLGC_MAX_USER)%gameclass.HLGC_MAX_USER;cc.log("urlIndex="+c);if(c==0){c=3}else{c-=1}n.setTexture("res/ui/gxDdz/13-room/TimePoint"+c+".png")}},_runBeginAction:function(d){for(var c=0;c<gameclass.HLGC_MAX_USER;c++){this.playerHeads[c].initData();this.playerHeads[c].renderAllCard();this.playerHeads[c]._headContain.setScale(0.8);this.playerHeads[c].scoreBg.setScale(0.5);var a=this.mod_hlgc.getserverchair(c);this.playerHeads[c].updateRead(false)}this.scheduleOnce(function(){d()},1);var b=(this.mod_hlgc.curPlayerIndex-1)*90;this.arrowSp.runAction(cc.rotateBy(1,b))},initDeskView:function(){if(this.uiLayer.getChildByTag(112233)){this.uiLayer.removeChildByTag(112233)}this._tingContain.removeAllChildren();this.initBtnState();this.cardNumText.setVisible(false);this.outPokerManager.removeTableCard();this.starpointer.setVisible(false);for(var b=0;b<gameclass.HLGC_MAX_USER;b++){this.playerHeads[b].initData();this.playerHeads[b].renderAllCard();this.playerHeads[b]._headContain.setScale(0.8);this.playerHeads[b].scoreBg.setScale(0.5);var a=this.mod_hlgc.getserverchair(b);var c=this.mod_hlgc.gameInfo.info[b].seat;if(a==0){this.playerHeads[b]._masterIcon.setVisible(true)}else{this.playerHeads[b]._masterIcon.setVisible(false)}this.playerHeads[b].updateRead(false)}},gameReady:function(e,c,b){this.roomInfo=c;if(this.roomInfo.step==0){this.roomInfo.step=1}this.seeObj={};for(var a=0;a<=gameclass.HLGC_MAX_CARD_NUM;a++){if(a%10!=0){this.seeObj[a]=0}}this.initDeskView();this.cardNumText.setVisible(true);this.cardNum=b;this.setCardAcount(b);ccui.helper.seekWidgetByName(this.uiLayer,"btn_invite").setVisible(false);if(this.roomInfo.hsz){this.allSlect=false}var d=this;cc.each(this.playerHeads,function(g,f){if(e[f]){g.setVisible(true);if(e[f].deal){g.zhuang_img.setVisible(true)}else{g.zhuang_img.setVisible(false)}g.score_text.setString(e[f].total)}else{g.setVisible(false)}});this.updateDirect(e);this._readyBtn.setVisible(false);for(var a=0;a<4;a++){this.playerHeads[a].betTxt.setString("")}},reflashScore:function(b){for(var a=0;a<gameclass.HLGC_MAX_USER;a++){this.playerHeads[a].reflashScore(b[a])}},updateRound:function(){this.jushuText.setString(this.roomInfo.step+"/"+this.roomInfo.maxStep+"局")},setRoomInfo:function(b){this.roomInfo=b;ccui.helper.seekWidgetByName(this.controlLayer,"roomIdTxt").setString("房号:"+b.roomid);this.updateRound();if(this.roomInfo.step==0){this.cardNumText.setVisible(false)}else{ccui.helper.seekWidgetByName(this.uiLayer,"btn_invite").setVisible(false)}var d=StaticData.getRoomSetArrFromParam(this.roomInfo.type,this.roomInfo.param1,this.roomInfo.param2,1);if(d[5]=="扣牌打"){this.mod_hlgc.isPaoLong=true}if(d[3]=="带跑龙"){this.mod_hlgc.isDaiPaoLong=true}var c=ccui.helper.seekWidgetByName(this.controlLayer,"wanfaTxt");var a=ccui.helper.seekWidgetByName(this.controlLayer,"wanfaTxt_1");c.setString(d[1]);if(d[5]){a.setString(d[5])}else{a.setString("")}},share:function(){if(this.roomInfo==null){return}var a=StaticData.getRoomSetStrFromParam(this.roomInfo.type,this.roomInfo.param1,this.roomInfo.param2,1);var b="我在["+StaticData.GAME_NAME+"]开了"+this.roomInfo.maxStep+"局,"+a+",";b+="快来一起玩吧!";gameclass.mod_platform.invitefriend(b,gameclass.download,"摸 "+StaticData.GAME_NAME+" 房号【"+this.roomInfo.roomid+"】")},setSeatState:function(){for(var a=0;a<4;a++){ccui.helper.seekWidgetByName(this.node,"Button_"+a).setVisible(false)}},updatePlayerinfo:function(c){this.curPersons=0;this._readyBtn.setVisible(false);var f=this;for(var b=0;b<4;b++){if(!f.mod_hlgc.gameInfo.begin){ccui.helper.seekWidgetByName(this.node,"Button_"+b).setVisible(true);this.playerHeads[b].setVisible(false)}this._seatContain.setVisible(true);var a=this._seatContain.getChildren();a[b].setVisible(false)}var d=c.info;if(!f.mod_hlgc.gameInfo.begin){cc.each(d,function(h,n){if(!h){return}if(h.seat!=-1){var r=f.mod_hlgc._getPersonDataByUid(h.uid);if(h.seat>=0){ccui.helper.seekWidgetByName(f.node,"Button_"+h.seat).setVisible(false)}var g=h.seat>=0?h.seat:0;if(h.uid==f.game.modmgr.mod_login.logindata.uid&&f.mod_hlgc.isDaiPaoLong){f.isSeat=true;ccui.helper.seekWidgetByName(f.uiLayer,"betLayer").setVisible(true)}var q=f._seatContain.getChildren()[g];q.setVisible(true);var m=q.getChildren();for(var l=0;l<m.length;l++){m[l].setVisible(false)}var p=ccui.helper.seekWidgetByName(q,"headContain");p.setVisible(true);var s=ccui.helper.seekWidgetByName(q,"headBg");s.setVisible(true);if(r.imgurl){gameclass.mod_base.showtximg(s,r.imgurl||"",0,0,"",!d.line)}else{s.removeAllChildren()}ccui.helper.seekWidgetByName(q,"playerName").setVisible(true);ccui.helper.seekWidgetByName(q,"playerName").setString(r.name)}});return}if(f.mod_hlgc.isHaveingSeat){var e=[null,null,null,null];for(var b=0;b<c.info.length;b++){if(!c.info[b]||c.info[b].seat<0){continue}e[(c.info[b].seat-f.mod_hlgc._mySeat+4)%4]=gameclass.mod_base.deepCopy(c.info[b])}f._seatContain.setVisible(false);cc.each(e,function(l,h){if(l){var k=l.seat;if(h>=0){var g=f.mod_hlgc._getPersonDataByUid(l.uid);f.curPersons++;f.playerHeads[h].setBaseInfo({name:g.name,id:g.uid,head:g.imgurl,uip:g.ip,uid:g.uid,sex:g.sex,address:g.address,ready:g.ready,line:g.line,total:0,});f.playerHeads[h].setVisible(true)}else{}}})}},updateReadyView:function(){this._readyBtn.setVisible(true);for(var b=0;b<this.mod_hlgc.persons.length;b++){var a=this.mod_hlgc.persons[b];if(a==null){continue}var c=this.mod_hlgc.getUserRead(a.uid);this.playerHeads[b].updateRead(c);if(c&&a.uid==this.mod_hlgc.myUid){this._readyBtn.setVisible(false);this.playerHeads[b].betTxt.setString("")}}},reconnectionShow:function(b,c,a){var d=this;cc.each(this.playerHeads,function(f,e){if(b[e]&&b[e].card){f.setVisible(true);if(b[e].dealer){f.zhuang_img.setVisible(true)}f.score_text.setString(b[e].total)}})},connect_showTableCard:function(a){this.outPokerManager.getConnectTableData(a);for(var c=0;c<gameclass.HLGC_MAX_USER;c++){this.outPokerManager.renderCards(c)}for(var c=0;c<a.length;c++){for(var b=0;b<a[c].length;b++){if(!this.seeObj[a[c][b]]){this.seeObj[a[c][b]]=0}this.seeObj[a[c][b]]++}}},connect_showPengGangCard:function(a){for(var c=0;c<a.length;c++){for(var b=0;b<a[c].length;b++){if(!this.seeObj[a[c][b].nums[0]]){this.seeObj[a[c][b].nums[0]]=0}if(a[c][b].type=="peng"){this.seeObj[a[c][b].nums[0]]+=3}}}for(var c=0;c<gameclass.HLGC_MAX_USER;c++){this.playerHeads[c].getConnectPengGangData(a[c]);this.playerHeads[c].renderAllCard(0)}},connect_isHaveOutPoke:function(b,a){this.playerHeads[b].haveOutPoke=a},connet_setLastInfo:function(a,b){this.lastChairNum=a;this.lastCardNum=b},whoHasHu:function(a){for(var b=0;b<gameclass.HLGC_MAX_USER;b++){this.playerHeads[b].isHasHu=(a[b]/10>0)}},showHuPoke:function(a){for(var b=0;b<gameclass.HLGC_MAX_USER;b++){if(a[b]>0){this.playerHeads[b].showHuPoke(a[b])}}},showBao:function(b){this._baoContain.removeAllChildren();for(var a=0;a<b.length;a++){var c=gameclass.hlgc.Table.CreateCard(b[a],0,2);c.setAnchorPoint(cc.p(0,0));c.setScale(1.5);this._baoContain.addChild(c);c.setPositionX(a*(c.getContentSize().width*c.getScale()));this._baoContain.setContentSize(cc.size(c.getPositionX()+c.getContentSize().width*c.getScale(),c.getContentSize().height*c.getScale()))}this._baoContain.setPositionX((cc.winSize.width-this._baoContain.getContentSize().width)/2);this._baoContain.setPositionY((cc.winSize.height-this._baoContain.getContentSize().height)/2)},});gameclass.hlgc.Table.CreateCard=function(f,h,d,a,e){var b="";var g=1;if(d==0){if(h==0){b="down_"+f+".png";g=0.92}else{if(h==1){b="hand_right.png";g=0.95}else{if(h==2){b="hand_top.png";g=0.8}else{b="hand_left.png";g=0.95}}}}else{if(d==1){if(h==0){b="heap_out.png";g=0.8}else{if(h==1){b="heap_right.png";g=0.99}else{if(h==2){b="heap_out.png";g=0.55}else{b="heap_left.png";g=0.99}}}}else{if(d==2){if(h==0){b="out_ver_"+f+".png";g=0.8}else{if(h==1){b="right_"+f+".png";g=0.99}else{if(h==2){b="out_ver_"+f+".png";g=0.55}else{b="left_"+f+".png";g=0.99}}}}else{if(d==3){if(h==0){b="out_ver_"+f+".png";g=0.55}else{if(h==1){b="right_"+f+".png";g=0.99}else{if(h==2){b="out_ver_"+f+".png";g=0.55}else{b="left_"+f+".png";g=0.99}}}}}}}var c=new cc.Sprite();c.initWithSpriteFrameName(b);c.setScale(g-0.1);return c};gameclass.hlgc.Table.prototype.checkSafe=function(b){if(this.mod_hlgc.roomSetArr[2]==0){return}var a=this.safeLayer.checkSafe(b);if(a){this.safeLayer.showSafeWindow(b)}};gameclass.hlgc.Table.CreateCardText=function(a,e,k,l,f,b){if(l==1){return}var c=[];var g=[];var d=[0,270,0,90];if(k==0){c=[1,1,1,1];g=[-10,0,0,0]}else{if(k==3){c=[0.5,0.5,0.5,0.5];g=[6,8,6,8]}else{if(k==2){c=[1,0.5,0.5,0.5];g=[10,8,6,8]}}}var m="card_"+a+".png";var h=new cc.Sprite();h.initWithSpriteFrameName(m);if(b=="huifang"){h.setRotation(0)}else{h.setRotation(d[e])}h.setScale(c[e]);h.setPosition(f.getContentSize().width/2,f.getContentSize().height/2+g[e]);f.addChild(h);return h},gameclass.hlgc.Table.getCardStr=function(f,h,d,a){var b="";var e=["_p0","_p1","_p2","_p3"];var g=["_hand","_oper","_oper","_push"];var c=["_f","_b"];b="bg"+e[h]+g[d]+c[a]+".png";return b},gameclass.hlgc.Table.getCardTextStr=function(a){return"down_"+a+".png"};gameclass.hlgcResultOneUi=gameclass.baseui.extend({node:null,mod_hlgc:null,leftCardListView:null,title:null,_baoContain:null,stateEnum:{win:0,lost:1,draw:2,liuju:3},ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.hlgcResultOne,true);this.addChild(this.node);this.leftCardListView=ccui.helper.seekWidgetByName(this.node,"leftCardListView");this.title=ccui.helper.seekWidgetByName(this.node,"title");this._baoContain=ccui.helper.seekWidgetByName(this.node,"baoContain")},setDjjsMod:function(f){this.mod_hlgc=f;var g=this;var O=[];var t=g.mod_hlgc.roominfo.person;var S=g.mod_hlgc.gameEndInfo.info;var n=0;var L=0;for(var N=0;N<S.length;N++){if(S[N].uid==this.game.modmgr.mod_login.logindata.uid){n=N}if(S[N].deal){L=N}}var d=0;for(var N=L;N<S.length;N++){S[N].director=d++;if(S.length==3&&S[N].director==2){S[N].director=3}}for(var N=0;N<L;N++){S[N].director=d++;if(S.length==3&&S[N].director==2){S[N].director=3}}var h=[];var z=0;for(var N=n;N<t.length;N++){h[z++]=t[N]}for(var N=0;N<n;N++){h[z++]=t[N]}var p=[];z=0;for(var N=n;N<S.length;N++){p[z++]=S[N]}for(var N=0;N<n;N++){p[z++]=S[N]}var Q=g.mod_hlgc.gameEndInfo.lastcard;var F=[];var v=[];var J=[];var c=[];var x=["","平胡X1","门前清X2","素胡X2","飘胡X2","混吊X2","混吊混X4","双清X4","七对胡X4","大吊车X4","天胡X10","地胡X10","混杠X10","天地胡七对X10","地胡七对X10","杠上开花X2","海底捞X2"];var B=[];if(g.mod_hlgc.gameEndInfo.bao!=null){B=g.mod_hlgc.gameEndInfo.bao}for(var N=0;N<gameclass.HLGC_MAX_USER;N++){O[N]=ccui.helper.seekWidgetByName(this.node,"player"+N);if(N>=p.length){O[N].setVisible(false);continue}var q=p[N].card.card1;if(p[N].huid>0){if(p[N].card.cardm>0){Q=p[N].card.cardm;var z=q.indexOf(Q);if(z>=0){q.splice(z,1)}}}F.push(q);J.push(p[N].state);v[N]=[];c.push(cc.p(0,30));for(var M=0;M<p[N].card.cardp.length;M++){var l=p[N].card.cardp[M];if(p[N].peng_uids!=null){var D=g.mod_hlgc.getPengBackIndex(p[N].uid,p[N].peng_uids[l]);v[N].push({type:"peng",index:2,nums:[p[N].card.cardp[M]],pengbackIndex:D})}else{v[N].push({type:"peng",index:2,nums:[p[N].card.cardp[M]],pengbackIndex:0})}}var a=p[N].card.cardmg.concat(p[N].card.cardcg);for(var M=0;M<a.length;M++){v[N].push({type:"gang",index:2,nums:[a[M]],gangType:1})}for(var M=0;M<p[N].card.cardag.length;M++){v[N].push({type:"gang",index:2,nums:[p[N].card.cardag[M]],gangType:0})}for(var M=0;M<p[N].card.cardxfg.length;M++){v[N].push({type:"gang",index:2,nums:[StaticData.WIND_GANG],gangType:1});M+=3}}var H;for(var N=0;N<p.length;N++){O[N].getChildByName("name").setString(h[N].name);O[N].getChildByName("zongfenNum").setString(p[N].curscore);O[N].getChildByName("img_zhuang").setVisible(p[N].deal);O[N].getChildByName("cardType").setString(this.getTotalStr(J[N]));O[N].getChildByName("huLogo").setVisible(false);O[N].getChildByName("director"+p[N].director).setVisible(true);var m="";if(p[N].piao==0){m="不跑"}else{if(p[N].piao==1){m="跑1"}else{if(p[N].piao==2){m="跑2"}}}O[N].getChildByName("paoText").setString(m);if(p[N].uid==this.game.modmgr.mod_login.logindata.uid){if(p[N].curscore>0&&p[N].huid>0){H=this.stateEnum.win}else{if(p[N].curscore<0){H=this.stateEnum.lost}else{H=this.stateEnum.draw}}}F[N].sort(function(U,k){return U-k});for(var M=0;M<v[N].length;M++){var b=v[N][M];var e=new gameclass.OpBox(b);if(b.type=="gang"&&b.gangType==0){e.setScale(0.55)}e.setAnchorPoint(0,0);O[N].getChildByName("majiangLayout").addChild(e);e.setPosition(c[N]);c[N].x+=e.getContentSize().width*e.getScale()+15}for(var M=0;M<F[N].length;M++){var s=gameclass.hlgc.Table.CreateCard(F[N][M],2,2,0);O[N].getChildByName("majiangLayout").addChild(s);s.setPosition(c[N]);c[N].x+=(s.getContentSize().width*s.getScale())}if(p[N].huid>0){var r=gameclass.hlgc.Table.CreateCard(Q,2,2,0);O[N].getChildByName("majiangLayout").addChild(r);r.setPosition(c[N].x+25,c[N].y)}var y=[];if(p[N].huid==1){y.push("自摸")}for(var K=0;K<p[N].state.length;K++){var G=p[N].state[K];var T=G.id;y.push(x[T])}O[N].getChildByName("cardType").setString(y.toString())}this._baoContain.removeAllChildren();for(var N=0;N<B.length;N++){var R=B[N];var w=gameclass.hlgc.Table.CreateCard(R,2,2,0);w.setAnchorPoint(0,0);this._baoContain.addChild(w);w.setPositionX(N*(w.getContentSize().width*w.getScale()+10))}gameclass.createbtnpress(this.node,"nexttbtn",function(){g.game.uimgr.closeui("gameclass.hlgcResultOneUi");if(g.mod_hlgc.isOver){g.game.uimgr.showui("gameclass.hlgcResultAllUi").setData(g.mod_hlgc)}else{g.mod_hlgc.sendGameReady();g.mod_hlgc.view.betCheck()}});gameclass.createbtnpress(this.node,"closeBtn",function(){g.game.uimgr.closeui("gameclass.hlgcResultOneUi");if(g.mod_hlgc.isOver){g.game.uimgr.showui("gameclass.hlgcResultAllUi").setData(g.mod_hlgc)}else{g.mod_hlgc.sendGameReady();g.mod_hlgc.view.betCheck()}});gameclass.createbtnpress(this.node,"shareBtn",function(){gameclass.mod_platform.savescreen(function(k){if(window.wx){k=JSON.parse(k);if(k.error==0){g.share(k.url)}}})});if(g.mod_hlgc.gameEndInfo.hz){H=this.stateEnum.liuju}if(H==this.stateEnum.win){this.title.setTexture("res/ui/qhqp/13-djjs/qh_title_win@2x.png")}else{if(H==this.stateEnum.lost){this.title.setTexture("res/ui/qhqp/13-djjs/qh_title_fail@2x.png")}else{if(H==this.stateEnum.draw){this.title.setTexture("res/ui/qhqp/13-djjs/qh_title_draw@2x.png")}else{this.title.setTexture("res/ui/qhqp/13-djjs/qh_title_draw@2x.png")}}}var P=new Date();var I=P.Format("yyyy-MM-dd hh:mm");ccui.helper.seekWidgetByName(this.node,"maxstep_Text").setString("局数:"+this.mod_hlgc.roominfo.step+"/"+this.mod_hlgc.roominfo.maxStep);ccui.helper.seekWidgetByName(this.node,"infoRight").setString(I);if(this.mod_hlgc.leftCardArr==null){return}var C=6;var E=0;var A=new ccui.Layout();var o=this.mod_hlgc.leftCardArr.length;for(var N=0;N<o;N++){var l=this.mod_hlgc.leftCardArr[N];var u=gameclass.hlgc.Table.CreateCard(l,2,2,0);A.addChild(u);u.setAnchorPoint(cc.p(0,1));u.setPositionX(E*41);E++;if((N+1)%C==0){E=0;A=new ccui.Layout();A.setContentSize(cc.size(1195,50))}else{if(N%(C-1)==0){this.leftCardListView.addChild(A)}}}},getTotalStr:function(a){var c="";for(var b=0;b<a.length;b++){c+=a[b]}return c}});gameclass.hlgcResultAllUi=gameclass.baseui.extend({sprite:null,node:null,sharelayer:null,chulitu:null,shareing:null,round:null,curtime:null,mod_hlgc:null,playerInfo:null,majiangLayout:null,last_card:null,typeString:null,nScore:null,paoText:null,ctor:function(){this._super();this.shareing=false},show:function(){var b=this;this.node=this.game.uimgr.createnode(res.hlgcResultAll,true);this.addChild(this.node);this.playerInfo=[];this.last_card=null;this.majiangLayout=ccui.helper.seekWidgetByName(this.node,"majiangLayout");this.typeString=ccui.helper.seekWidgetByName(this.node,"typeText");this.nScore=ccui.helper.seekWidgetByName(this.node,"scoreText");this.paoText=ccui.helper.seekWidgetByName(this.node,"paoText");this.typeString.setVisible(false);this.nScore.setVisible(false);for(var a=0;a<gameclass.HLGC_MAX_USER;a++){this.playerInfo[a]=ccui.helper.seekWidgetByName(this.node,"playerInfo"+a);ccui.helper.seekWidgetByName(this.playerInfo[a],"winerImg").setVisible(false);ccui.helper.seekWidgetByName(this.playerInfo[a],"fangzhu").setVisible(false)}gameclass.createbtnpress(this.node,"back",function(){b.game.uimgr.showui("gameclass.hallui");b.game.uimgr.closeui("gameclass.hlgcResultAllUi")});gameclass.createbtnpress(this.node,"backBtn",function(){b.game.uimgr.showui("gameclass.hallui");b.game.uimgr.closeui("gameclass.hlgcResultAllUi")});gameclass.createbtnpress(this.node,"share",function(){gameclass.mod_platform.savescreen(function(c){if(window.wx){c=JSON.parse(c);if(c.error==0){b.share(c.url)}}})})},setData:function(h){this.mod_hlgc=h;var k=this.mod_hlgc.gameEndAllInfo.info;var d=this.mod_hlgc.roominfo;ccui.helper.seekWidgetByName(this.node,"infoLeft").setString("房号ID："+d.roomid);ccui.helper.seekWidgetByName(this.node,"masterTxt").setString("房主ID："+this.mod_hlgc.bankerUid);var f=new Date();var a=f.Format("yyyy-MM-dd hh:mm");var b=d.step;if(b>d.maxStep){b=d.maxStep}ccui.helper.seekWidgetByName(this.node,"maxstep_Text").setString("局数:"+b+"/"+d.maxStep);ccui.helper.seekWidgetByName(this.node,"infoRight").setString(a);ccui.helper.seekWidgetByName(this.playerInfo[0],"fangzhu").setVisible(true);cc.log(d.person);cc.each(k,function(n,m){if(n.uid==d.person[m].uid){k[m]["name"]=d.person[m]["name"];k[m]["imgurl"]=d.person[m]["imgurl"]}});var c=[];for(var e=0;e<gameclass.HLGC_MAX_USER;e++){if(e>=k.length){this.playerInfo[e].setVisible(false);continue}ccui.helper.seekWidgetByName(this.playerInfo[e],"name").setString(k[e]["name"]);ccui.helper.seekWidgetByName(this.playerInfo[e],"id").setString("ID:"+k[e]["uid"]);ccui.helper.seekWidgetByName(this.playerInfo[e],"mingci").setString("自摸次数 "+k[e]["zm"]);ccui.helper.seekWidgetByName(this.playerInfo[e],"anci").setString("接炮次数 "+(k[e]["Hu"]-k[e]["zm"]));ccui.helper.seekWidgetByName(this.playerInfo[e],"pici").setString("点炮次数 "+k[e]["fp"]);ccui.helper.seekWidgetByName(this.playerInfo[e],"zimo").setString("暗杠次数 "+k[e]["ag"]);ccui.helper.seekWidgetByName(this.playerInfo[e],"baoci").setString("明杠次数 "+(k[e]["mg"]+k[e]["cg"]));ccui.helper.seekWidgetByName(this.playerInfo[e],"fenshu").setString(k[e]["score"]);var l=ccui.helper.seekWidgetByName(this.playerInfo[e],"headImg");gameclass.mod_base.showtximg(l,k[e]["imgurl"],0,0,"im_headbg2");c[e]=k[e]["score"];ccui.helper.seekWidgetByName(this.playerInfo[e],"paoIcon").setVisible(false)}var g=c.indexOf(Math.max.apply(null,c));if(g>=0&&c[g]>0){ccui.helper.seekWidgetByName(this.playerInfo[g],"winerImg").setVisible(true)}if(this.mod_hlgc.gameEndInfo){this.last_card=this.mod_hlgc.gameEndInfo.lastcard}for(var e=0;e<k.length;e++){if(k[e].uid==this.game.modmgr.mod_login.logindata.uid&&this.mod_hlgc.gameEndInfo){this._myCard(k[e].max_card)}}},_myCard:function(e){var r=[];var f=[];var n=[];var A=cc.p(200,75);var z=["","平胡X1","门前清X2","素胡X2","飘胡X2","混吊X2","混吊混X4","双清X4","七对胡X4","大吊车X4","天胡X10","地胡X10","混杠X10","天地胡七对X10","地胡七对X10","杠上开花X2","海底捞X2"];r=e.card1;if(r){if(e.cardm>0){this.last_card=e.cardm;var g=r.indexOf(this.last_card);if(g>=0){r.splice(g,1)}}}if(e.state){n.push(e.state)}f=[];var s=e.cardp;if(s){for(var v=0;v<s.length;v++){f.push({type:"peng",index:2,nums:[s[v]],gangType:0})}}var y=e.cardmg;if(y){for(var v=0;v<y.length;v++){f.push({type:"gang",index:2,nums:[y[v]],gangType:1})}}if(e.cardag){for(var v=0;v<e.cardag.length;v++){f.push({type:"gang",index:2,nums:[e.cardag[v]],gangType:0})}}if(e.cardxfg){for(var v=0;v<e.cardxfg.length;v++){f.push({type:"gang",index:2,nums:[StaticData.WIND_GANG],gangType:1});v+=3}}if(r){r.sort(function(m,k){return m-k})}if(f){for(var v=0;v<f.length;v++){var p=f[v];var h=new gameclass.OpBox(p);if(p.type=="gang"&&p.gangType==0){h.setScale(0.55)}h.setAnchorPoint(0,0);this.majiangLayout.addChild(h);h.setPosition(A);A.x+=h.getContentSize().width*h.getScale()+15}}if(r){for(var t=0;t<r.length;t++){var a=gameclass.hlgc.Table.CreateCard(r[t],2,2,0);this.majiangLayout.addChild(a);a.setPosition(A);A.x+=(a.getContentSize().width*a.getScale())}}var o=[];var w=1;this.typeString.setVisible(true);this.nScore.setVisible(true);var c=e.state.length;if(c>0){for(var u=0;u<c;u++){var b=e.state[u];var d=b.id;o.push(z[d])}var x=e.state[c-1];w=x.score*3;w="+"+w;this.typeString.setString(o.toString());this.nScore.setString(w)}else{this.typeString.setString("");this.nScore.setString("+0")}var l=e.piao;if(l>0){var q="";if(l==0){q="不跑"}else{if(l==1){q="跑1"}else{if(l==2){q="跑2"}}}this.paoText.setVisible(true);this.paoText.setString(q)}else{this.paoText.setVisible(false);this.paoText.setString("")}}});gameclass.resultui.prototype.share=function(a){gameclass.mod_platform.wxsharelink(StaticData.GAME_NAME+"结算","战绩",a)};gameclass.ReplayWindow=gameclass.baseui.extend({node:null,isQiPai:false,curCards:null,curCardsSP:null,pengGangArr:null,pengGangNodeArr:null,lastPlayedCard:null,deskCardsNum:null,handNode:null,lastOrderNum:-1,isPause:false,speed:1.5,stepIndex:0,ctor:function(){this._super();this.deskCardsNum=[];this.handNode=[];this.queType=[];this.isHasHu=[];this.isQue=[];this.huLogoSP=[]},show:function(){this.node=this.game.uimgr.createnode(res.hlgcReplayUI,true);for(var e=0;e<4;e++){this.huLogoSP[e]=ccui.helper.seekWidgetByName(this.node,"hulogo"+e);this.huLogoSP[e].setVisible(false)}cc.spriteFrameCache.addSpriteFrames(res.mah_bg_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_text_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_down_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_out_left_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_out_right_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_out_ver_plist);cc.spriteFrameCache.addSpriteFrames(res.mah_back_plist);this.node.setContentSize(1080,540);this.addChild(this.node);var b=ccui.helper.seekWidgetByName(this.node,"playbtn");b.addTouchEventListener((function(h,k){if(k!=ccui.Widget.TOUCH_ENDED){return false}this.isPause=!this.isPause;h.loadTextureNormal(this.isPause?res.btn_bofang:res.btn_zanting)}).bind(this));var g=ccui.helper.seekWidgetByName(this.node,"close");g.addTouchEventListener((function(h,k){if(k!=ccui.Widget.TOUCH_ENDED){return false}this.unscheduleAllCallbacks();this.game.uimgr.showui("gameclass.hallui");this.game.uimgr.closeui("gameclass.ReplayWindow")}).bind(this));var d=ccui.helper.seekWidgetByName(this.node,"btn_qianJin");d.addTouchEventListener((function(h,k){this.unscheduleAllCallbacks();this.speed=this.speed<1?1.5:0.8;this.startReplay(this.speed)}).bind(this));var c=ccui.helper.seekWidgetByName(this.node,"btn_houTui");c.addTouchEventListener((function(h,k){if(k!=ccui.Widget.TOUCH_ENDED){return false}this.playerNextRecord(0)}).bind(this));var f=ccui.helper.seekWidgetByName(this.node,"btn_shangJu");f.addTouchEventListener((function(h,k){if(k!=ccui.Widget.TOUCH_ENDED){return false}this.playerNextRecord(-1)}).bind(this));var a=ccui.helper.seekWidgetByName(this.node,"btn_xiaJu");a.addTouchEventListener((function(h,k){if(k!=ccui.Widget.TOUCH_ENDED){return false}this.playerNextRecord(1)}).bind(this))},initReplayData:function(){this.stepUid=[];this.curCards=[[],[],[],[]];this.curCardsSP=[[],[],[],[]];this.stepCards=[];this.handNode=[];this.queType=[-1,-1,-1,-1];this.isHasHu=[false,false,false,false];for(var c=0;c<4;c++){this.huLogoSP[c].setVisible(false)}this.isQue=[true,true,true,true];this.tableNode=new cc.Layer();this.node.addChild(this.tableNode);for(var c=0;c<4;c++){var b=new cc.Layer();this.handNode[c]=b;this.node.addChild(b)}for(var a=0;a<4;a++){this.deskCardsNum[a]=0}this.startPosArr=[cc.p(320,30),cc.p(960,100),cc.p(800,500),cc.p(140,470)];this.pengGangPosArr=[cc.p(340,60),cc.p(987,100),cc.p(760,529),cc.p(163,470)];this.CONST_STARTPOS=this.startPosArr.slice(0);this.CONST_PENGGANGPOS=this.pengGangPosArr.slice(0);this.outPokerPosArr=[cc.p(400,210),cc.p(820,180),cc.p(750,400),cc.p(320,410)];this.drawCardPosArr=[cc.p(830,30),cc.p(960,500),cc.p(290,500),cc.p(140,60)];this.pengGangArr=[[],[],[],[]];this.pengGangNodeArr=[[],[],[],[]]},setMod:function(b){this.mod_record=b;this.initReplayData();var a=[res.img_tiao,res.img_tong,res.img_wan];this.mod_record.getRecordBureau(function(g){if(g.info==null||g.info==""){return}this.record_info=JSON.parse(g.info);ccui.helper.seekWidgetByName(this.node,"record_id").setString("战绩回放码："+this.record_info.roomid.toString()+this.game.modmgr.mod_login.logindata.uid.toString());var d=this.record_info.roomid.toString().slice(-2);ccui.helper.seekWidgetByName(this.node,"jushu").setString("第"+d+"局");for(var f=0;f<gameclass.HLGC_MAX_USER;f++){var c=ccui.helper.seekWidgetByName(this.node,"userhead"+f);var m=c.getChildByName("username");var k=c.getChildByName("userscore");var l=ccui.helper.seekWidgetByName(this.node,"queLogo"+f);var h=ccui.helper.seekWidgetByName(this.node,"head"+f);if(this.record_info.person.length<=f){c.setVisible(false);m.setVisible(false);k.setVisible(false);l.setVisible(false);h.setVisible(false);break}this.curCards[f]=this.record_info.person[f].card;this.stepUid[f]=this.record_info.person[f].uid;this.queType[f]=this.record_info.person[f].que;this.mySort(f);var e=this.record_info.person[f].name;if(e==""){e="游客"}m.setString(e);if(this.queType[f]<0){l.setVisible(false)}else{l.setTexture(a[this.queType[f]])}var o=this.record_info.person[f].score;k.setString(o);gameclass.mod_base.showtximg(c,this.record_info.person[f].head,0,0,"im_headbg2");this.renderAllCard(f)}if(this.stepCards){this.stepCards=this.record_info.step;this.caishen=this.stepCards[0].card;var n="card_"+this.caishen[0]+".png";ccui.helper.seekWidgetByName(this.node,"caishen").initWithSpriteFrameName(n);this.stepCards.shift();this.startReplay(this.speed)}}.bind(this))},renderAllCard:function(a){for(var b=0;b<4;b++){this.startPosArr[a]=cc.p(this.CONST_STARTPOS[a]);this.pengGangPosArr[a]=cc.p(this.CONST_PENGGANGPOS[a])}this.handNode[a].removeAllChildren();this.renderPengGangCard(a);this.renderHandCard(a)},renderPengGangCard:function(a){for(var b=0;b<this.pengGangArr[a].length;b++){var c=new gameclass.OpBox(this.pengGangArr[a][b]);c.setAnchorPoint(0,0);c.setPosition(this.pengGangPosArr[a]);switch(a){case 0:this.startPosArr[a].x+=(c.getContentSize().width+0);this.pengGangPosArr[a].x+=c.getContentSize().width;break;case 1:this.startPosArr[a].y+=(c.getContentSize().height-20);this.pengGangPosArr[a].y+=(c.getContentSize().height-20);c.setLocalZOrder(20-b);break;case 2:this.startPosArr[a].x-=c.getContentSize().width;this.pengGangPosArr[a].x-=c.getContentSize().width;break;case 3:this.startPosArr[a].y=this.startPosArr[a].y-c.getContentSize().height+10;this.pengGangPosArr[a].y=this.pengGangPosArr[a].y-c.getContentSize().height+10;break}this.handNode[a].addChild(c)}},renderHandCard:function(b){if(b==0){this.startPosArr[b].x+=10}else{if(b==1){}else{if(b==3){}else{if(b==4){}}}}this.creatPokerWithArr(b,this.curCards[b]);var a=this.curCardsSP[b].length;for(var c=0;c<a;c++){var d=this.curCardsSP[b][c];d.setAnchorPoint(0,0);d.setPosition(this.startPosArr[b]);switch(b){case 0:this.startPosArr[b].x+=((d.getContentSize().width*d.getScale())-2);this.pengGangPosArr[b].x+=((d.getContentSize().width*d.getScale())-2);break;case 1:this.startPosArr[b].y+=29;this.pengGangPosArr[b].y+=29;d.setLocalZOrder(20-c);break;case 2:this.startPosArr[b].x-=((d.getContentSize().width*d.getScale())-2);this.pengGangPosArr[b].x-=((d.getContentSize().width*d.getScale())-2);break;case 3:this.startPosArr[b].y-=30;this.pengGangPosArr[b].y-=30;d.setLocalZOrder(c);break}if(this.isQiPai&&c==a-1){d.setPosition(this.drawCardPosArr[b])}this.handNode[b].addChild(d)}},creatPokerWithArr:function(b,a){this.curCardsSP[b]=[];for(var c=0;c<a.length;c++){var d=gameclass.hlgc.Table.CreateCard(a[c],b,3,0);if(this.isHasHu[b]){d.setColor(new cc.color(127,127,127));this.huLogoSP[b].setVisible(true);this.huLogoSP[b].setLocalZOrder(8888)}if(this.isQue[b]&&this.queType[b]>=0){if(a[c]<this.queType[b]*10||a[c]>(this.queType[b]+1)*10){d.setColor(new cc.color(127,127,127))}}this.curCardsSP[b][c]=d}},onDrawCard:function(a,b){this.isQiPai=true;if(b>this.queType[a]*10&&b<(this.queType[a]+1)*10){this.isQue[a]=true}this.curCards[a].push(b);this.renderAllCard(a)},onSendCard:function(a,c){this.isQiPai=false;for(var b=0;b<this.curCards[a].length;b++){if(this.curCards[a][b]==c){this.curCards[a].splice(b,1);break}}this.mySort(a);this.renderAllCard(a);staticFunction.playUserTalk("m"+c,0)},onPeng:function(a,c){this.pengGangArr[a].push({type:"peng",index:a,nums:[c],state:"huifang"});for(var b=0;b<this.curCards[a].length;b++){if(this.curCards[a][b]==c){this.curCards[a].splice(b,2);break}}this.renderAllCard(a);staticFunction.playUserTalk("peng",0)},onGang:function(a,c,d){if(d!=2){this.pengGangArr[a].push({type:"gang",index:a,nums:[c],gangType:d,state:"huifang"})}else{if(d==2){var f=false;for(var b=0;b<this.pengGangArr[a].length;b++){if(this.pengGangArr[a][b].nums[0]==c){this.pengGangArr[a].splice(b,1,{type:"gang",index:a,nums:[c],gangType:2});f=true;break}}if(!f){this.onGang(a,c,1);return}}}this.mySort(a);var e=null;if(d==0){e=4}else{if(d==1){e=3}else{if(d==2){e=1}}}e=staticFunction.numCheck(this.curCards[a],c);for(var b=0;b<this.curCards[a].length;b++){if(this.curCards[a][b]==c){this.curCards[a].splice(b,e);break}}this.renderAllCard(a);staticFunction.playUserTalk("gang",0)},startReplay:function(a){var b=this;this.schedule(function(){if(b.isPause){return}b.ReplayStep(b.stepIndex);b.stepIndex++;if(this.stepCards){if(b.stepIndex>=b.stepCards.length||b.stepIndex<=0){b.unscheduleAllCallbacks()}}},a)},playerNextRecord:function(c){var a=0;for(var b=0;b<this.mod_record.maxJu.length;b++){if(this.mod_record.maxJu[b].roomId==parseInt(this.record_info.roomid/100)){a=this.mod_record.maxJu[b].maxJu;break}}if(parseInt(this.mod_record.curBureauid%100)+c>a){return}if(parseInt(this.mod_record.curBureauid%100)+c<=0){return}cc.log("maxJu:"+a);this.stepIndex=0;if(this.stepCards){this.stepCards.length=0}this.unscheduleAllCallbacks();for(var b=0;b<4;b++){this.handNode[b].removeFromParent(true)}this.tableNode.removeFromParent(true);this.isQiPai=false;this.mod_record.setCurBureauid(this.mod_record.curBureauid+c);this.setMod(this.mod_record)},UidToOrder:function(b){for(var a=0;a<this.stepUid.length;a++){if(b==this.stepUid[a]){return a}}},playAnim:function(a,c){var b=ccui.helper.seekWidgetByName(this.node,"operateSp"+a);var d="";if(c==2){d=res.img_peng}else{if(c==3){d=res.img_hu}else{if(c==4||c==5||c==6){d=res.img_gang}}}b.setTexture(d);b.setVisible(true);b.setLocalZOrder(11111);b.runAction(cc.sequence(cc.spawn(cc.scaleTo(0.7,1.25),cc.fadeOut(0.7)),cc.callFunc(function(){b.setVisible(false)})))},mySort:function(b){var a=[];this.curCards[b].sort(function(e,d){return e-d});if(this.queType[b]>=0){for(var c=0;c<this.curCards[b].length;c++){if(this.curCards[b][c]>this.queType[b]*10&&this.curCards[b][c]<(this.queType[b]+1)*10){a.push(this.curCards[b][c])}}}if(a.length>0){this.isQue[b]=true}else{this.isQue[b]=false}for(var c=0;c<this.curCards[b].length;c++){if(this.curCards[b][c]>this.queType[b]*10&&this.curCards[b][c]<(this.queType[b]+1)*10){this.curCards[b].splice(c,a.length);break}}for(var c=0;c<a.length;c++){this.curCards[b].push(a[c])}},onHu:function(a){this.isHasHu[a]=true;this.renderAllCard(a)},});gameclass.ReplayWindow.prototype.ReplayStep=function(c){if(!this.stepCards){return}if(c>=this.stepCards.length){return}var b=this.UidToOrder(this.stepCards[c].uid);switch(this.stepCards[c].type){case 0:this.onDrawCard(b,this.stepCards[c].card[0]);break;case 1:this.onSendCard(b,this.stepCards[c].card[0]);var a=gameclass.hlgc.Table.CreateCard(this.stepCards[c].card[0],b,3,0);if(b==0){a.setPosition(this.outPokerPosArr[0].x+(a.getContentSize().width*a.getScale()-1)*(this.deskCardsNum[0]%10),this.outPokerPosArr[0].y-Math.floor(this.deskCardsNum[0]/10)*44);a.setLocalZOrder(this.deskCardsNum[0])}else{if(b==1){a.setPosition(this.outPokerPosArr[1].x+Math.floor(this.deskCardsNum[1]/10)*47,this.outPokerPosArr[1].y+30*(this.deskCardsNum[1]%10));a.setLocalZOrder(1000-this.deskCardsNum[1])}else{if(b==2){a.setPosition(this.outPokerPosArr[2].x-(a.getContentSize().width*a.getScale()-1)*(this.deskCardsNum[2]%10),this.outPokerPosArr[2].y+Math.floor(this.deskCardsNum[2]/10)*44);a.setLocalZOrder(1000-this.deskCardsNum[2])}else{if(b==3){a.setPosition(this.outPokerPosArr[3].x-Math.floor(this.deskCardsNum[3]/10)*47,this.outPokerPosArr[3].y-30*(this.deskCardsNum[3]%10));a.setLocalZOrder(this.deskCardsNum[3])}}}}this.tableNode.addChild(a);this.deskCardsNum[b]++;this.lastOrderNum=b;this.lastPlayedCard=a;break;case 2:this.deskCardsNum[this.lastOrderNum]--;if(this.lastPlayedCard){this.lastPlayedCard.removeFromParent()}this.onPeng(b,this.stepCards[c].card[0]);this.playAnim(b,2);break;case 3:this.onGang(b,this.stepCards[c].card[0],0);this.playAnim(b,4);break;case 4:this.deskCardsNum[this.lastOrderNum]--;if(this.lastPlayedCard){this.lastPlayedCard.removeFromParent()}this.onGang(b,this.stepCards[c].card[0],1);this.playAnim(b,4);break;case 5:this.onGang(b,this.stepCards[c].card[0],2);this.playAnim(b,4);break;case 6:this.onHu(b);this.playAnim(b,3);staticFunction.playUserTalk("zimo",0);break;case 7:this.onHu(b);this.playAnim(b,3);staticFunction.playUserTalk("dianpao",0);break}};gameclass.recommendUI=gameclass.baseui.extend({node:null,isInvite:false,inviteInfo:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.recommendUi,true);this.addChild(this.node);this.layoutOne=ccui.helper.seekWidgetByName(this.node,"Panel_1");this.layoutTwo=ccui.helper.seekWidgetByName(this.node,"Panel_2");this.btn_ok=ccui.helper.seekWidgetByName(this.layoutOne,"btn_ok");this.btnEvent();this.isInvite=this.game.modmgr.mod_login.inviteData.isinvite;this.inviteInfo=this.game.modmgr.mod_login.inviteData.invite;ccui.helper.seekWidgetByName(this.layoutOne,"Text_5").setString(this.game.modmgr.mod_login.logindata.uid);if(this.isInvite){this.setNoSend()}},btnEvent:function(){var a=this;gameclass.createbtnpress(this.node,"btn_close",function(){a.game.uimgr.closeui("gameclass.recommendUI")});gameclass.createbtnpress(this.layoutOne,"btn_record",function(){a.layoutOne.setVisible(false);a.layoutTwo.setVisible(true);a.showInviteRecord()});gameclass.createbtnpress(this.layoutOne,"btn_ok",function(){var b=ccui.helper.seekWidgetByName(a.layoutOne,"inputBox").getString();a.game.modmgr.mod_center.sendInviteCode(b)});gameclass.createbtnpress(this.layoutOne,"btn_copy",function(){})},setNoSend:function(){var a=ccui.helper.seekWidgetByName(this.layoutOne,"inputBox");a.setString("你已经使用过邀请码");a.setTouchEnabled(false);this.btn_ok.setEnabled(false);this.btn_ok.setBright(false)},showInviteRecord:function(){ccui.helper.seekWidgetByName(this.layoutTwo,"friendNum").setString(this.inviteInfo.length);ccui.helper.seekWidgetByName(this.layoutTwo,"fangkaNum").setString(this.inviteInfo.length*5);var b=ccui.helper.seekWidgetByName(this.layoutTwo,"listView");b.removeAllChildren();cc.log(this.inviteInfo.length);for(var c=0;c<this.inviteInfo.length;c++){var e=new ccui.Layout();e.setContentSize(cc.size(500,30));var d=this.inviteInfo[c].name||"游客";var f=new cc.LabelTTF(d,"Arial",24);f.setColor(cc.color(73,85,96));f.setPosition(500,0);var g=this.getDate(this.inviteInfo[c].time);var a=new cc.LabelTTF(g,"Arial",24);a.setColor(cc.color(73,85,96));a.setPosition(150,0);e.addChild(f);e.addChild(a);b.pushBackCustomItem(e)}},getDate:function(a){var b=new Date(a*1000);var a=(b.getFullYear())+"年"+(b.getMonth()+1)+"月"+(b.getDate())+"日";return a},});var clipping={getClipnode:function(d,b,e){e=e||1.3;var c=this._cliper(d._normalFileName);d.parent.removeChild(b,false);var a=cc.p(d.getContentSize().width+110,0);b.setPosition(a);b.runAction(cc.repeatForever(cc.sequence(cc.moveTo(e,cc.p(0,0)),cc.moveTo(0,a))));c.addChild(b);c.setPosition(d.getPosition());return c},_cliper:function(a){var c=new cc.Sprite(a);var b=new cc.ClippingNode();b.attr({stencil:c,anchorX:0.5,anchorY:0.5,alphaThreshold:1,});return b},};cc.PageTurn=cc.Grid3D.extend({mHOffsetX:0,mHOffsetY:0,ctor:function(a,b,c){cc.Grid3D.prototype.ctor.call(this);if(a!==undefined){this.initWithSize(a,b,c)}},calculateHorizontalVertexPoints:function(k,f){var d=100;var m=700;var b=640-k;var n=this.getGridSize().width;for(var h=0;h<=n;++h){cc.log("cccccccccccccccccc");for(var g=0;g<=this.getGridSize().height;++g){var a=this.getOriginalVertex(cc.p(h,g));cc.log("qqqqqqqqqqqqqqqqqqqqqqqqq"+a);cc.log(a);var c=a.y-b;var e=c/d;if(c>=0){if(e>Math.PI){a.y=0+b-d*(e-Math.PI);a.z=2*d/9;a.x=a.x+1}else{if(e<=Math.PI){a.y=0+b+d*Math.sin(e);a.z=(d-d*Math.cos(e))/9;a.x=a.x+0}}}else{a.x=a.x+0;a.y=a.y+0;a.z=a.z+f}cc.log("wwwwwwwwwwwwwwwwwwwwwwwwwww");this.setVertex(cc.p(h,g),a);cc.log("ddddddddddddddddddddddddd")}}},create1:function(a){var b=new PageTurn();b.initWithSize(a);return b},});gameclass.baseButtonControl=cc.Class.extend({_btnNode:null,_normalChildArr:null,_selectChildArr:null,_isSelect:false,ctor:function(c,b,a){this._btnNode=c;this._normalChildArr=b;this._selectChildArr=a;this._isSelect=false},setSelect:function(d){this._isSelect=d;var a=this._normalChildArr.length;for(var c=0;c<a;c++){var e=this._btnNode.getChildByName(this._normalChildArr[c]);if(!e){continue}e.setVisible(!d)}var b=this._selectChildArr.length;for(var c=0;c<b;c++){var e=this._btnNode.getChildByName(this._selectChildArr[c]);if(!e){continue}e.setVisible(d)}},destroy:function(){this._btnNode=null;this._normalChildArr=null;this._selectChildArr=null;this._isSelect=false}});gameclass.buttonGroupControl=cc.Class.extend({_callback:null,_btnControlArr:null,_selectIndex:0,ctor:function(a){this._callback=a},initListen:function(){if(!this._btnControlArr){return}var a=this._btnControlArr.length;for(var c=0;c<a;c++){var d=this._btnControlArr[c];var b=d._btnNode;b.addTouchEventListener(this.btnClickHandle.bind(this))}},initData:function(a){this._btnControlArr=a;this.initListen()},setSelectIndex:function(a){this._selectIndex=a;this.updateSelect()},updateSelect:function(){var a=this._btnControlArr.length;for(var c=0;c<a;c++){var d=this._btnControlArr[c];var b=d._btnNode;if(c===this._selectIndex){d.setSelect(true)}else{d.setSelect(false)}}},btnClickHandle:function(d,e){if(e!=ccui.Widget.TOUCH_ENDED){return}var a=this._btnControlArr.length;for(var c=0;c<a;c++){var f=this._btnControlArr[c];var b=f._btnNode;if(b===d&&!f._isSelect){this.setSelectIndex(c);if(this._callback){this._callback(c)}break}}},destroy:function(){this._btnControlArr=null}});gameclass.buttonGroupControl.prototype.switchBtnControl=function(d,b,c){var e=[];var a=d.length;for(var f=0;f<a;f++){var g=new gameclass.baseButtonControl(d[f],b,c);e.push(g)}return e};gameclass.buttonGroupControl.prototype.createStand=function(e,a){var b=[];for(var d=0;d<a;d++){var c=e.getChildByName("btn"+d);b.push(new gameclass.baseButtonControl(c,["normal"],["select"]))}this.initData(b)};gameclass.GameRuleView=gameclass.baseui.extend({node:null,closeBtn:null,listView:null,btnGroupCtr:null,btnStyle:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.gameRuleJson,true);this.addChild(this.node);this.closeBtn=ccui.helper.seekWidgetByName(this.node,"backBtn");this.listView=ccui.helper.seekWidgetByName(this.node,"listView");this.ruleContain=ccui.helper.seekWidgetByName(this.node,"ruleInfoContain");this.btnStyle=this.listView.getChildByName("btnStyle");var g=this;gameclass.createbtnpress(this.node,"backBtn",function(){g.game.uimgr.closeui("gameclass.GameRuleView")});this.btnGroupCtr=new gameclass.buttonGroupControl(this.updateRight.bind(this));this.listView.removeAllChildren();var d=[];var a=StaticData.roomSetArr.length;for(var f=0;f<a;f++){var e=this.btnStyle.clone();var b=staticFunction.addTabBtn(e,StaticData.roomSetArr[f].normalImg,StaticData.roomSetArr[f].selectImg);var c=b[1];c.setPositionX(c.getPositionX()-4);c.setPositionY(c.getPositionY()+7);this.listView.addChild(e);d.push(new gameclass.baseButtonControl(e,["normal"],["select"]))}this.btnGroupCtr.initData(d);this.btnGroupCtr.setSelectIndex(0);this.updateRight()},updateRight:function(){for(var a=0;a<this.ruleContain.getChildrenCount();a++){var b=this.ruleContain.getChildren()[a];if(a==this.btnGroupCtr._selectIndex){b.setVisible(true)}else{b.setVisible(false)}}},showTypeSet:function(a){var d=null;for(var c=0;c<this._rightContain.getChildrenCount();c++){var e=this._rightContain.getChildren()[c];var b=e.getName();var f=parseInt(b.substr(3,b.length));if(f==a){e.setVisible(true);d=e}else{e.setVisible(false)}}return d},destroy:function(){this.btnGroupCtr.destroy()},});var StaticData=StaticData||{};StaticData.ROOM_SET_STORAGE_KEY="ROOM_SET_STORAGE_KEY";StaticData.ROOM_SELECT_GAMETYPE="selectGameType";StaticData.ROOM_GAMETYPE_PREV="gameTypeSets";StaticData.HALL_CASH="hallCash";StaticData.GAME_DEFAUL="gameDefault";StaticData.GAME_NAME="秦皇棋牌";StaticData.roomSetArr=[{name:"秦皇岛麻将",gameType:gameclass.gamehlgc,nameIcon:"res/ui/qhqp/2-hall/qh_txt_mj@2x.png",normalImg:"res/ui/qhqp/6-rule/qh_txt_qhdmj2@2x.png",selectImg:"res/ui/qhqp/6-rule/qh_txt_qhdmj1@2x.png",TxtArr:[["8局x1个房钻","16局x2房钻"],["4人平摊","房主支付"],["同IP提示"],["带跑龙"],["七个混"],["扣牌打"],["可碰可杠","不可碰可杠","不可碰不可杠"]],param1Arr:[[1,2],[1,0],[0,1],[0,1],[0,1],[0,1],[0,1,2]],default1Arr:[0,0,0,0,0,0,1],param2Arr:["底分"]},{name:"秦皇岛斗地主",nameIcon:"res/ui/qhqp/2-hall/qh_txt_ddz@2x.png",gameType:gameclass.gameddz,normalImg:"res/ui/qhqp/6-rule/qh_txt_qhdddz2@2x.png",selectImg:"res/ui/qhqp/6-rule/qh_txt_qhdddz1@2x.png",TxtArr:[["6局x1房卡","12局x2房卡"],["叫分","不叫分"],["双王可拆"],["可选加倍"],["3炸","4炸","5炸"]],param1Arr:[[1,2],[0,1],[1,0],[0,1],[0,1,2]],default1Arr:[0,0,0,0,0],param2Arr:[]}];StaticData.getRoomSetFromType=function(b){var a=StaticData.roomSetArr.length;for(var c=0;c<a;c++){var d=StaticData.roomSetArr[c];if(d.gameType==b){return d}}return null};StaticData.getRoomSetIndexFromType=function(b){var a=StaticData.roomSetArr.length;for(var c=0;c<a;c++){var d=StaticData.roomSetArr[c];if(d.gameType==b){return c}}return -1};StaticData.getSetObj=function(b){var a=StaticData.roomSetArr.length;for(var c=0;c<a;c++){var d=StaticData.roomSetArr[c];if(d.gameType==b){return d}}return{}};StaticData.getRoomSetStrFromParam=function(l,c,b,a){var m="";var e=StaticData.getSetObj(l);var f=StaticData.roomParamAnalyze(l,c,b,a,e.param1Arr);for(var d=0;d<f.length;d++){var g=f[d];var h=e.TxtArr[d];var k=e.param1Arr;if(h.length==k[d].length){m=m+h[g]+" "}else{if(g==1){m=m+h[0]+" "}}}return m};StaticData.getRoomSetArrFromParam=function(l,c,b,a){var m=[];var e=StaticData.getSetObj(l);var f=StaticData.roomParamAnalyze(l,c,b,a,e.param1Arr);for(var d=0;d<f.length;d++){var g=f[d];if(g>=0){var h=e.TxtArr[d];var k=e.param1Arr;if(h.length==k[d].length){m.push(e.TxtArr[d][g])}else{if(g==1){m.push(e.TxtArr[d][0])}else{m.push("")}}}}return m};StaticData.roomParamAnalyze=function(c,f,e,d,b){var a=[];if(c==gameclass.gamehlgc){a.push(b[0].indexOf(d));a.push(b[1].indexOf(f%10));a.push(b[2].indexOf(e));a.push(b[3].indexOf(parseInt(f/10%10)));a.push(b[4].indexOf(parseInt(f/100%10)));a.push(b[5].indexOf(parseInt(f/1000%10)));a.push(b[6].indexOf(parseInt(f/10000%10)))}else{if(c==gameclass.gameddz){a.push(b[0].indexOf(d));a.push(b[1].indexOf(parseInt(f/10%10)));a.push(b[2].indexOf(parseInt(f/100%10)));a.push(b[3].indexOf(parseInt(f/1000%10)));a.push(b[4].indexOf(f%10))}else{if(c==gameclass.gamelzddz){a.push(b[0].indexOf(d));a.push(b[1].indexOf(parseInt(f/10%10)));a.push(b[2].indexOf(parseInt(f/100%10)));a.push(b[3].indexOf(parseInt(f/1000%10)));a.push(b[4].indexOf(f%10))}}}return a};StaticData.JIANG_ARR=[2,5,8,12,15,18,22,25,28];StaticData.WIND_DONG=31;StaticData.WIND_NAN=32;StaticData.WIND_XI=33;StaticData.WIND_BEI=34;StaticData.WIND_GANG=30;StaticData.WIND_GANG_ARR=[32,33,34,31];StaticData.ALL_CARD=[1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36,37];var staticFunction=staticFunction||{};staticFunction.getStorages=function(c){var b=cc.sys.localStorage.getItem(c);if(b){var a=JSON.parse(b);return a}return{}};staticFunction.getStorage=function(d,a){var c=cc.sys.localStorage.getItem(d);if(c){var b=JSON.parse(c);if(b[a]||b[a]==0){return b[a]}}return null};staticFunction.setStorages=function(b,a){cc.sys.localStorage.setItem(b,JSON.stringify(a))};staticFunction.setStorage=function(d,a,b){var c=staticFunction.getStorages(d);c[a]=b;staticFunction.setStorages(d,c)};staticFunction.getStandardTime=function(b){var f=new Date(b*1000);var a=f.getHours();if(a<10){a="0"+a}var c=f.getMinutes();if(c<10){c="0"+c}var e=f.getSeconds();if(e<10){e="0"+e}var b=(f.getFullYear())+"-"+(f.getMonth()+1)+"-"+(f.getDate())+" "+a+":"+c+":"+e;return b};staticFunction.initZeroArray=function(b){var a=[];for(var c=0;c<b;c++){a[c]=0}return a};staticFunction.playUserTalk=function(b,c,a){staticFunction.playMp3Check(b,c,a)},staticFunction.playMp3Check=function(c,f,b){var h=g_music[c];if(f==0){}else{if(f==1){var e=h.split(",");if(e.length>1){var d=parseInt(e[1]);var g=parseInt(Math.random()*d);var a=e[0]+"_"+g+".mp3";mod_sound.playeffect(a)}else{if(b){mod_sound.playeffect(g_music.mjClick)}else{mod_sound.playeffect(h)}}}}};staticFunction.addTabBtn=function(a,c,b,h,g){a.setTouchEnabled(true);var e=a.getChildByName("normal");var k=staticFunction.addSpriteToSprite(e,c);k.setName("normalTxt");var d=a.getChildByName("select");var f=staticFunction.addSpriteToSprite(d,b);f.setName("selectTxt");return[k,f]};staticFunction.addSpriteToSprite=function(b,a){var c=new cc.Sprite(a);b.addChild(c);c.setPosition(cc.p(b.getContentSize().width/2,b.getContentSize().height/2));return c};staticFunction.numCheck=function(d,b){var a=0;for(var c=0;c<d.length;c++){if(d[c]==b){a++}}return a};staticFunction.getArrayNumObj=function(e){var d={};var a=e.length;for(var c=0;c<a;c++){var b=e[c];if(!d[b]){d[b]=0}d[b]++}return d};staticFunction.delElementFromArr=function(e,d,b){for(var c=0;c<b;c++){var a=e.indexOf(d);if(a>=0){e.splice(a,1)}}return e};staticFunction.getCardNumFromObj=function(c,a){for(var b in c){if(b==a){return c[b]}}return 0};staticFunction.checkIsJiang=function(b){var a=StaticData.JIANG_ARR.indexOf(b);if(a>=0){return 1}return 0};staticFunction.checkHuRecursion=function(b,e,h,a){var k=b.length;if(k==0){return 1}for(var g=0;g<k;g++){var f=b[g];if(f<gameclass.HLGC_MAX_TxtCARD_NUM){if(b[g+1]!=null&&b[g+2]!=null&&b[g]+1==b[g+1]&&b[g+1]+1==b[g+2]){var c=b[g+1];var d=b[g+2];e[f]--;e[c]--;e[d]--;b=staticFunction.delElementFromArr(b,f,1);b=staticFunction.delElementFromArr(b,c,1);b=staticFunction.delElementFromArr(b,d,1);return staticFunction.checkHuRecursion(b,e,h,a)}}if(e[f]==2&&!a){if(h){var l=staticFunction.checkIsJiang(f);if(l){a=true;e[f]=0;b=staticFunction.delElementFromArr(b,f,2);return staticFunction.checkHuRecursion(b,e,h,a)}}else{a=true;e[f]=0;b=staticFunction.delElementFromArr(b,f,2);return staticFunction.checkHuRecursion(b,e,h,a)}}else{if(e[f]==3){e[f]=0;b=staticFunction.delElementFromArr(b,f,3);return staticFunction.checkHuRecursion(b,e,h,a)}}}return 0};staticFunction.getScaleSize=function(){var b=new cc.size(0,0);var e=cc.winSize.width/1136;var a=cc.winSize.height/640;var c=cc.winSize.width;var d=cc.winSize.height;cc.log("fw="+e+",fh="+a);if(e>=a){}else{}};staticFunction.loadNetIcon=function(d,b,a){var c=new cc.Sprite();c.retain();cc.loader.loadImg(b,{isCrossOrigin:true},function(g,e){if(typeof(e)!="undefined"&&e!=null){var h=e;if(!cc.sys.isNative){var k=new cc.Texture2D();k.initWithElement(e);k.handleLoadedTexture();h=k}var f=h.getContentSize();c.initWithTexture(h);c.setPosition(cc.p(d.getContentSize().width/2,d.getContentSize().height/2));d.addChild(c);if(a){a()}c.release()}else{if(typeof(g)!="undefined"){}}})};gameclass.FightSetView=gameclass.baseui.extend({sprite:null,node:null,musicSlider:null,soundSlider:null,btn_change:null,sliderMusic:null,sliderEffects:null,mod:null,ctor:function(){this._super()},setMod:function(a){this.mod=a},show:function(){this.node=this.game.uimgr.createnode(res.fightSetJson,true);this.musicSlider=ccui.helper.seekWidgetByName(this.node,"musicSlider");this.soundSlider=ccui.helper.seekWidgetByName(this.node,"effectSlider");this.addChild(this.node);var c=this;gameclass.createbtnpress(this.node,"root",function(){c.game.uimgr.closeui("gameclass.FightSetView")});gameclass.createbtnpress(this.node,"exitLogin",function(){var d={yinyue:c.sliderMusic,yinxiao:c.sliderEffects};d=JSON.stringify(d);cc.log("设置:"+d);c.saveSetting(d);c.game.uimgr.closeui("gameclass.FightSetView")});gameclass.createbtnpress(this.node,"dissmissBtn",function(){c.game.uimgr.showui("gameclass.msgboxui").setString("是否想要解散房间？",function(){c.mod.dissmissroom(1)})});this.btn_change=ccui.helper.seekWidgetByName(this.node,"change");this.btn_change.setVisible(false);gameclass.createbtnpress(this.node,"change",function(){mod_userdefault.globaldata.code="";mod_userdefault.writeglobaljson();c.game.uimgr.showui("gameclass.loginui");c.game.uimgr.closeui("gameclass.hallui");c.game.uimgr.closeui("gameclass.FightSetView")});var b=function(e,f){switch(f){case ccui.Slider.EVENT_PERCENT_CHANGED:var h=e;var g=h.getPercent();var d=g.toFixed(0)/100;c.sliderMusic=d;mod_sound.setMusicVolume(d);break;default:break}};var a=function(e,f){switch(f){case ccui.Slider.EVENT_PERCENT_CHANGED:var h=e;var g=h.getPercent();c.sliderEffects=g;var d=g.toFixed(0)/100;c.sliderEffects=d;mod_sound.setEffectsVolume(d);break;default:break}};this.sliderMusic=mod_sound.getMusicVolume();this.sliderEffects=mod_sound.getEffectsVolume();this.musicSlider.setPercent(this.sliderMusic*100);this.musicSlider.addEventListener(b);this.soundSlider.setPercent(this.sliderEffects*100);this.soundSlider.addEventListener(a)},saveSetting:function(a){cc.sys.localStorage.setItem("saveSetting",a)},getSetting:function(){return cc.sys.localStorage.getItem("saveSetting")},});gameclass.settingui.gmusic=50;gameclass.settingui.gamesound=50;gameclass.numSetSimpleCtr=cc.Class.extend({_node:null,_isImgShow:false,_maxLen:-1,_resetBtn:null,_delBtn:null,_numArr:null,_curFillIndex:-1,_numBtnArr:null,_numBgArr:null,_numShowContain:null,_operateLayer:null,_EVENT_CLOSE:gameclass.NUMSET_CLOSE_DEFAULT,_EVENT_OK:gameclass.NUMSET_OK_DEFAULT,_EVENT_FULL:gameclass.NUMSET_FULL_DEFAULT,_fillFullCallback:null,ctor:function(c,b,a){this._node=c;this._isImgShow=b;this._maxLen=a;this.init();this.initView();this.initListen();this.initialize()},init:function(){if(!this._maxLen){this._maxLen=gameclass.numSetControl.defaultMaxLen}this._curFillIndex=0;this._operateLayer=this._node.getChildByName("operateLayer");var c=this._node.getChildByName("dynamicLayer");this.staticLayer=this._node.getChildByName("staticLayer");this._resetBtn=this._operateLayer.getChildByName("cs");this._delBtn=this._operateLayer.getChildByName("sc");this._numShowContain=new ccui.Layout();this._numBgArr=new Array(this._maxLen);this._numArr=new Array(this._maxLen);this._numBtnArr=new Array(10);var b;for(var a=0;a<10;a++){b=this._operateLayer.getChildByName("btn"+a);this._numBtnArr[a]=b}for(var a=0;a<this._maxLen;a++){this._numArr[a]=""}},initView:function(){this._node.addChild(this._numShowContain);var a;for(var b=0;b<this._maxLen;b++){this._numBgArr[b]=this.staticLayer.getChildByName("num"+b);if(this._isImgShow){a=new cc.Sprite()}else{a=new cc.LabelTTF("","Arial",42)}this._numShowContain.addChild(a)}},initListen:function(){var a=this._numBtnArr.length;for(var b=0;b<a;b++){this._numBtnArr[b].addTouchEventListener(this.clickNumHandle,this)}this._resetBtn.addTouchEventListener(this.clickResetHandle,this);this._delBtn.addTouchEventListener(this.clickDelHandle,this)},initialize:function(){},setFont:function(c,a){for(var b=0;b<this._numShowContain.getChildrenCount();b++){var d=this._numShowContain.getChildren()[b];d.setFontSize(c);d.setColor(a)}},clickNumHandle:function(b,c){if(c!=ccui.Widget.TOUCH_ENDED){return}var a=b.getName();this.updateNext(a.substr(3,a.length-1))},updateNext:function(a){if(this._curFillIndex>=this._maxLen){return}if(this._curFillIndex<0){this._curFillIndex=0}this.updateNumChild(this._curFillIndex,a);this._curFillIndex++;if(this._curFillIndex>=this._maxLen){if(this._fillFullCallback){this._fillFullCallback(this.getNumber())}else{cc.eventManager.dispatchCustomEvent(this._EVENT_FULL,{number:this.getNumber()})}}},clickResetHandle:function(a,b){if(b!=ccui.Widget.TOUCH_ENDED){return}this.resetNumber()},clickDelHandle:function(a,b){if(b!=ccui.Widget.TOUCH_ENDED){return}if(this._curFillIndex<=0){return}this.updateNumChild(this._curFillIndex-1,-1);this._curFillIndex--},getNumber:function(){var c="";for(var a=0;a<this._maxLen;a++){c+=this._numArr[a]}if(c==""){return 0}var b=parseInt(c);if(b==0){return 0}return b},updateNumChild:function(c,b){if(!this._numShowContain){return}var a=this._numShowContain.getChildren()[c];if(b<0){this._numArr[c]="";if(this._isImgShow){a.setTextureRect(cc.rect(0,0,0,0))}else{a.setString("")}}else{this._numArr[c]=b;if(this._isImgShow){a.setTexture(res["wzqNum"+b])}else{a.setString(b.toString())}}a.setPosition(this._numBgArr[c].getPosition())},destroy:function(){this._node=null;this._resetBtn=null;this._delBtn=null;this._numArr=null;this._numBtnArr=null;this._numBgArr=null;this._numShowContain=null;this._operateLayer=null;this._fillFullCallback=null}});gameclass.numSetSimpleCtr.prototype.resetNumber=function(){for(var a=0;a<this._maxLen;a++){this.updateNumChild(a,-1)}this._curFillIndex=0};gameclass.numSetControl=gameclass.numSetSimpleCtr.extend({_closeBtn:null,_okBtn:null,_okBtnCallback:null,ctor:function(c,b,a){this._super(c,b,a)},init:function(){this._super();this._okBtn=this._operateLayer.getChildByName("okBtn");this._closeBtn=this._operateLayer.getChildByName("backBtn")},initListen:function(){this._super();this._closeBtn.addTouchEventListener(this.clickCloseHandle,this);this._okBtn.addTouchEventListener(this.clickOkHandle,this)},clickCloseHandle:function(a,b){if(b!=ccui.Widget.TOUCH_ENDED){return}cc.eventManager.dispatchCustomEvent(this._EVENT_CLOSE,{})},clickOkHandle:function(a,b){if(b!=ccui.Widget.TOUCH_ENDED){return}if(this._okBtnCallback){this._okBtnCallback(this.getNumber())}else{cc.eventManager.dispatchCustomEvent(this._EVENT_OK,{number:this.getNumber()})}},});gameclass.numSetControl.defaultMaxLen=6;gameclass.NUMSET_CLOSE_DEFAULT="gameclass.NUMSET_CLOSE_DEFAULT";gameclass.NUMSET_OK_DEFAULT="gameclass.NUMSET_OK_DEFAULT";gameclass.NUMSET_FULL_DEFAULT="gameclass.NUMSET_FULL_DEFAULT";gameclass.rangeControl=cc.Class.extend({_delBtn:null,_addBtn:null,_rangeTxt:null,_min:0,_max:0,_curValue:0,_offset:0,_offsetArr:[],ctor:function(c,b,a,d){this._node=c;this._min=b;this._max=a;this._offset=d;cc.log(d instanceof Number);this.init();this.initView();this.initListen();this.initialize()},init:function(){this._offsetArr=[];this._curValue=this._min;if(this._offset.length==1){this._offset=this._offset[0];var a=this._min;while(a<=this._max){this._offsetArr.push(a);a+=this._offset}}else{this._offsetArr=this._offset}this._delBtn=this._node.getChildByName("delBtn");this._addBtn=this._node.getChildByName("addBtn");this._rangeTxt=this._node.getChildByName("rangeTxt")},initView:function(){},initListen:function(){this._delBtn.addTouchEventListener(this.clickDelHandle,this);this._addBtn.addTouchEventListener(this.clickAddHandle,this)},initialize:function(){this.updateValue()},clickDelHandle:function(b,c){if(c!=ccui.Widget.TOUCH_ENDED){return}var a=this._offsetArr.indexOf(this._curValue);if(a<0){return}if(a-1>=0){this._curValue=this._offsetArr[a-1];this.updateValue()}},clickAddHandle:function(b,c){if(c!=ccui.Widget.TOUCH_ENDED){return}var a=this._offsetArr.indexOf(this._curValue);if(a<0){return}if(a+1<=this._offsetArr.length-1){this._curValue=this._offsetArr[a+1];this.updateValue()}},updateValue:function(){this._rangeTxt.setString(this._curValue.toString())},destroy:function(){this._node=null}});gameclass.mod_ddzhu=gameclass.mod_base.extend({roominfo:null,mywebsocket:null,ongameready:null,ongameDDZbegin:null,ongameddzstep:null,ongameddzbye:null,ongameDDZend:null,ongamebets:null,ongameDouble:null,onupdateroominfo:null,serverchair:null,selfdata:null,ongameview:null,isover:null,endinfo:null,gamestate:null,score:null,ongamedealer:null,onDDZgamedealer:null,onUpdateDifen:null,onchat:null,chatlst:null,uid:null,nameArr:[],uidArr:[],maxStep:null,minStep:null,roomnum:null,CreateRoomType:null,GameType:null,isReconne:false,chaiwang:null,isdouble:null,bankerUid:0,isend:false,ctor:function(){this.isover=false;this.isend=false;this.gamestate=0;this.chatlst=[]},bindUI:function(a){this.view=a},});gameclass.mod_ddzhu.prototype.entergame=function(d,a){this.roominfo=d;this.mywebsocket=a;var b=d.param1;this.chaiwang=(parseInt(b/100%10)==0);this.isdouble=(parseInt(b/1000%10)==1);if(!this.chaiwang){b-=100}if(this.isdouble){b-=1000}if(b==0||b==1||b==2||b==10||b==11||b==12){this.CreateRoomType=b}else{this.CreateRoomType=0}this.GameType=d.type;this.updateroominfo(this.roominfo);var c=this;this.mywebsocket.setonmsgfunc(function(e,k){cc.log(k.msghead);switch(k.msghead){case"login":case"gameddzinfo":c.isend=false;if(c.roominfo.type==6){c.mainUI.laidipaikuang.setVisible(false)}if(k.msgdata.begin){c.ongameDDZbegin(k.msgdata)}else{if(k.msgdata.dzcard.length>0&&!k.msgdata.begin){for(var g=0;g<k.msgdata.info.length;g++){if(k.msgdata.info[g].ready){c.ready(k.msgdata.info[g].uid);if(k.msgdata.info[g].uid==c.uid){c.ongameready()}}}c.mainUI.RoomMin=c.minStep+1;if(c.mainUI.RoomMin>1){c.mainUI.invitebtn.setVisible(false)}c.mywebsocket.send("gameready",{})}}c.view.checkSafe(c.roominfo.person);if(k.msgdata.begin){c.view.safeLayer.btn_safe.setVisible(false);c.view.showProgress(k.msgdata.curstep)}break;case"gamedouble":c.ongameDouble(k.msgdata);break;case"joinroom":break;case"gameddzbegin":c.isend=false;c.gamestate=1;c.ongameDDZbegin(k.msgdata);if(c.roominfo.step==0){c.view.checkSafe(c.roominfo.person)}c.view.safeLayer.btn_safe.setVisible(false);break;case"gameddzstep":c.ongameddzstep(k.msgdata);c.view.showProgress(k.msgdata.curstep);break;case"gameddzbye":c.isover=true;c.mywebsocket.onclosefunc=null;c.endinfo=k.msgdata;if(c.endinfo){if(c.isend&&c.roominfo.step==c.roominfo.maxstep){}else{c.ongameddzbye(c.endinfo)}}c.isend=false;break;case"roominfo":c.updateroominfo(k.msgdata);c.onupdateroominfo(k.msgdata);c.view.checkSafe(k.msgdata.person);break;case"joinroomfail":c.isend=false;c.mywebsocket.onclosefunc=null;c.game.modmgr.mod_login.dissmissroom();c.game.uimgr.showui("gameclass.msgboxui");switch(k.msgdata.result){case 1:c.game.uimgr.uis["gameclass.msgboxui"].setString("该房间已解散");break;case 2:c.game.uimgr.uis["gameclass.msgboxui"].setString("该房间已满员");break;default:c.game.uimgr.uis["gameclass.msgboxui"].setString("房间错误");break}break;case"exitroom":c.game.uimgr.closeui("gameclass.exitroom");c.mywebsocket.onclosefunc=null;if(!c.isover){c.isover=false;c.game.modmgr.mod_login.dissmissroom()}break;case"tickroom":c.mywebsocket.onclosefunc=null;c.game.modmgr.mod_login.backlogin();c.game.uimgr.showui("gameclass.msgboxui");c.game.uimgr.uis["gameclass.msgboxui"].setString("您的账号已在其他地方登陆");break;case"gameready":c.ready(k.msgdata.uid);c.ongameready();break;case"gamebets":c.ongamebets(k.msgdata);break;case"gameddzend":c.isend=true;c.gamestate=2;c.ongameDDZend(k.msgdata,false);break;case"gameview":c.ongameview();break;case"dissmissroom":c.game.uimgr.closeui("gameclass.exitroom");c.game.uimgr.showui("gameclass.exitroom",false);c.game.uimgr.uis["gameclass.exitroom"].setData(c,k.msgdata);break;case"nodissmissroom":c.game.uimgr.closeui("gameclass.exitroom");c.game.uimgr.showui("gameclass.msgboxui");c.game.uimgr.uis["gameclass.msgboxui"].setString("有人不同意解散房间");break;case"gamedeal":c.rob(k.msgdata.uid,k.msgdata.ok);c.ongamedealer(false,k.msgdata.uid);break;case"gamedealer":c.onUpdateDifen(k.msgdata);c.onDDZgamedealer(k.msgdata.card,k.msgdata.uid,k.msgdata.razz);var h=c.view.getSexFromuid(k.msgdata.uid);if(h==0){mod_sound.playeffect(g_music["Woman_Rob_"+k.msgdata.bets],false)}else{mod_sound.playeffect(g_music["Man_Rob_"+k.msgdata.bets],false)}break;case"chatroom":c.chatlst[c.chatlst.length]=k.msgdata;if(c.game.uimgr.uis["gameclass.chatui"]){c.game.uimgr.uis["gameclass.chatui"].pushstr(k.msgdata)}if(c.onchat){c.onchat(k.msgdata)}break;case"lineperson":for(var g=0;g<c.roominfo.person.length;g++){if(c.roominfo.person[g].uid==k.msgdata.uid){c.roominfo.person[g].ip="";if(c.game.uimgr.uis["gameclass.ddzhutable"]!=null){c.game.uimgr.uis["gameclass.ddzhutable"].resetIcon(k.msgdata.uid)}else{c.game.uimgr.uis["gameclass.ddzhutable_wild"].resetIcon(k.msgdata.uid)}break}}break;case"gameline":var f=c.getPlayerIndexById(k.msgdata.uid);if(f||f===0){c.view.userLineOut(f,k.msgdata)}break}})};gameclass.mod_ddzhu.prototype.updateroominfo=function(b){this.uid=this.game.modmgr.mod_login.logindata.uid;this.roominfo=b;this.maxStep=this.roominfo.maxstep;this.minStep=this.roominfo.step;this.roomnum=this.roominfo.roomid;for(var a=0;a<this.roominfo.person.length;a++){this.nameArr[a]=this.roominfo.person[a].name;this.uidArr[a]=this.roominfo.person[a].uid;if(this.roominfo.person[a].uid==this.game.modmgr.mod_login.logindata.uid){this.serverchair=a;this.selfdata=this.roominfo.person[a]}if(a==0){this.bankerUid=this.roominfo.person[a].uid}}if(this.gameniuniuinfo!=null){this.updategameniuniuinfo(this.gameniuniuinfo)}};gameclass.mod_ddzhu.prototype.updategameniuniuinfo=function(a){this.gameniuniuinfo=a;if(this.gameniuniuinfo.ready!=null){for(var b=0;b<this.gameniuniuinfo.ready.length;b++){this.ready(this.gameniuniuinfo.ready[b])}for(var b=0;b<this.gameniuniuinfo.deal.length;b++){this.rob(this.gameniuniuinfo.deal[b].uid,this.gameniuniuinfo.deal[b].ok)}}else{for(var b=0;b<this.roominfo.person.length;b++){this.roominfo.person[b].ready=false;this.roominfo.person[b].rob=0}}};gameclass.mod_ddzhu.prototype.ready=function(b){for(var a=0;a<this.roominfo.person.length;a++){if(this.roominfo.person[a].uid==b){this.roominfo.person[a].ready=true}}};gameclass.mod_ddzhu.prototype.getPlayerIndexById=function(b){for(var a=0;a<this.roominfo.person.length;a++){if(this.roominfo.person[a]&&this.roominfo.person[a].uid==b){return a}}};gameclass.mod_ddzhu.prototype.rob=function(c,b){for(var a=0;a<this.roominfo.person.length;a++){if(this.roominfo.person[a].uid==c){if(b){this.roominfo.person[a].rob=1}else{this.roominfo.person[a].rob=2}}}};gameclass.mod_ddzhu.prototype.dissmissroom=function(){var a={};this.mywebsocket.send("dissmissroom",a)};gameclass.mod_ddzhu.prototype.gameready=function(a){var b={};this.mywebsocket.send("gameready",b)};gameclass.mod_ddzhu.prototype.gamesteps=function(b){var a={cards:b};this.mywebsocket.send("gamesteps",a)};gameclass.mod_ddzhu.prototype.gamesteps_wild=function(c,a){var b={cards:c,abscards:a};this.mywebsocket.send("gamesteps",b)};gameclass.mod_ddzhu.prototype.gameniuniubegin=function(){var a={};this.mywebsocket.send("gameniuniubegin",a)};gameclass.mod_ddzhu.prototype.gamebets=function(a){var b={bets:Number(a)};this.mywebsocket.send("gamebets",b)};gameclass.mod_ddzhu.prototype.gamedouble=function(a){var b={"double":a};this.mywebsocket.send("gamedouble",b)};gameclass.mod_ddzhu.prototype.gameview=function(){var a={};this.mywebsocket.send("gameview",a)};gameclass.mod_ddzhu.prototype.gameend=function(){var a={};this.mywebsocket.send("gameend",a)};gameclass.mod_ddzhu.prototype.nodissmissroom=function(){var a={};this.mywebsocket.send("nodissmissroom",a)};gameclass.mod_ddzhu.prototype.gamedeal=function(a){var c={ok:a};this.mywebsocket.send("gamedeal",c)};gameclass.mod_ddzhu.prototype.chat=function(a,c){var b={type:a,chat:c};this.mywebsocket.send("chatroom",b)};gameclass.mod_ddzhu.prototype.getserverchair=function(a){return(this.serverchair+a)%3};gameclass.mod_ddzhu.prototype.getplayerdata=function(a){var b=this.getserverchair(a);if(b>this.roominfo.person.length){return}return this.roominfo.person[b]};gameclass.mod_ddzhu.prototype.getplayerdatabyuid=function(b){for(var a=0;a<this.roominfo.person.length;a++){if(this.roominfo.person[a].uid==b){return this.roominfo.person[a]}}};gameclass.mod_ddzhu.prototype.getplayerotherdata=function(a){var b=this.getserverchair(a);if(this.gameniuniuinfo){if(b>this.gameniuniuinfo.info.length){return}return this.gameniuniuinfo.info[b]}return};gameclass.mod_ddzhu.prototype.ongameniuniucard=function(a){for(var b=0;b<this.gameniuniuinfo.info.length;b++){if(this.gameniuniuinfo.info[b].uid==this.game.modmgr.mod_login.logindata.uid){this.gameniuniuinfo.info[b].card[4]=a}}};gameclass.mod_ddzhu.prototype.getplayernum=function(){return this.gameniuniuinfo.info.length};gameclass.ddzhutable=gameclass.baseui.extend({sprite:null,node:null,mod_ddzhu:null,players:null,ongameview:null,curround:null,buqiang0:null,qiangzhuang0:null,btn_double:null,btn_noDouble:null,gamebets:null,btn_chupai:null,btn_tishi:null,btn_buchu:null,tool_cardType:null,invitebtn:null,ddzenddata:null,RoomMax:null,RoomMin:null,zhuangJia:null,savebefCard:null,difen:null,fsk_difen:null,isDDZend:null,scoreLimit:null,curStep:0,playerCardCounts:null,ctor:function(){this._super();this.players=[];this.playerCardCounts={}},show:function(){this.init();mod_sound.playbmg(woLongMusics.bmg_wl,true)},setmod:function(a){this.mod_ddzhu=a;var c=this;var b=this.game.mod_login;this.mod_ddzhu.bindUI(this);this.tool_cardType=new gameclass.tool_cardType();this.mod_ddzhu.mainUI=this;if(window.wx){c.share()}if(c.mod_ddzhu.roominfo.time!=0){c.game.uimgr.showui("gameclass.exitroom",false);c.game.uimgr.uis["gameclass.exitroom"].setData(c.mod_ddzhu,c.mod_ddzhu.roominfo)}this.initTimeView();this.setScorelimit(this.mod_ddzhu.CreateRoomType);this.mod_ddzhu.onupdateroominfo=this.onupdateroominfo.bind(this);this.mod_ddzhu.ongameready=this.ongameready.bind(this);this.mod_ddzhu.onchat=this.onchat.bind(this);this.mod_ddzhu.ongameDDZbegin=this.ongameDDZbegin.bind(this);this.mod_ddzhu.ongamebets=this.ongamebets.bind(this);this.mod_ddzhu.ongameddzstep=this.ongameddzstep.bind(this);this.mod_ddzhu.onDDZgamedealer=this.onDDZgamedealer.bind(this);this.mod_ddzhu.ongamedealer=this.ongamedealer.bind(this);this.mod_ddzhu.ongameDouble=this.ongamedouble.bind(this);this.ongameview=0;this.mod_ddzhu.ongameview=this.ongameviewf.bind(this);this.mod_ddzhu.ongameddzbye=this.ongameddzbye.bind(this);this.mod_ddzhu.ongameDDZend=this.ongameDDZend.bind(this);this.mod_ddzhu.onUpdateDifen=this.updateDifenView.bind(this);ccui.helper.seekWidgetByName(c.node,"roomnum").setString("房号:"+c.mod_ddzhu.roomnum.toString());this.curround=ccui.helper.seekWidgetByName(c.node,"curround");this.reset();this.refplayerinfo();this.node.scheduleOnce(function(){gameclass.mod_platform.getBattery(100)},1)},showProgress:function(a){for(var b=0;b<3;b++){if(this.players[b].data.uid==a){this.createProgress(this.players[b].head,b)}else{this.players[b].head.removeChildByTag(123321)}}},getSexFromuid:function(b){for(var a=0;a<3;a++){if(this.players[a].data.uid==b){var c=this.players[a].data.sex;if(c==1||c==2){return c-1}else{return 0}}}return 0},});gameclass.ddzhutable.prototype.initTimeView=function(){var d=this;var a=ccui.helper.seekWidgetByName(d.node,"time");var c=function(){var e=new Date();var f=e.Format("hh:mm");a.setString(f)};c();var b=cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(function(){c()})));a.runAction(b)};gameclass.ddzhutable.prototype.onupdateroominfo=function(a){var b=this;b.refplayerinfo()};gameclass.ddzhutable.prototype.ongameready=function(c){var d=this;for(var b=0;b<3;b++){for(var a=0;a<this.mod_ddzhu.roominfo.person.length;a++){if(this.players[b].data&&this.players[b].data.uid==this.mod_ddzhu.roominfo.person[a].uid&&this.mod_ddzhu.roominfo.person[a].ready){this.players[b].ok.setVisible(true)}}}};gameclass.ddzhutable.prototype.resetDDZNext=function(){this.btn_chupai.setVisible(false);this.btn_tishi.setVisible(false);this.btn_buchu.setVisible(false);if(this.mod_ddzhu.roominfo.person.length>2){this.invitebtn.setVisible(false)}this.savebefCard=[];this.zhuangJia=0;this.bets=0;this.difen=0;this.curBoom=0;this.fsk_difen.setString("底分："+this.difen);this.alarmUid=[true,true,true];this.dipaikuang.removeAllChildren();this.laidipaiKuang.removeAllChildren();for(var a=0;a<3;a++){this.players[a].alarm.setVisible(false);this.players[a].dizhu.setVisible(false);this.players[a].spr_double.setVisible(false);this.players[a].spr_double.setTexture(res.spr_double1);this.players[a].cards.removeAllChildren();this.players[a].outCards.removeAllChildren();ccui.helper.seekWidgetByName(this.node,"gamebets"+a).setBright(true);ccui.helper.seekWidgetByName(this.node,"gamebets"+a).setEnabled(true)}};gameclass.ddzhutable.prototype.onchat=function(w){var n=this;var h=this.getSexFromuid(w.uid);for(var q=0;q<g_chatstrDdz.length;q++){if(g_chatstrDdz[q]==w.chat){if(h==0){mod_sound.playeffect(g_music["tell"+q+"_W"],false)}else{mod_sound.playeffect(g_music["tell"+q+"_M"],false)}}}for(var q=0;q<3;q++){var m=n.mod_ddzhu.getplayerdata(q);var e=n.mod_ddzhu.getplayerotherdata(q);var r=n.players[q].head;if(m!=null&&m.uid==w.uid){var k=n.talkPos[q];var a=[res.chatbg_ld,res.chatbg_rd,res.chatbg_ld,];if(w.type<4){var c=new ccui.Layout();var u=null;if(w.type==1){u=new cc.Scale9Sprite(a[q]);u.setCapInsets(cc.rect(60,10,10,10));u.setAnchorPoint(cc.p(0,0));u.setPosition(cc.p(-18,-18));c.addChild(u);var t=new cc.LabelTTF(w.chat,"Arial",36);t.setAnchorPoint(cc.p(0,0));t.setColor(cc.color(33,111,75));c.addChild(t);u.setContentSize(t.getContentSize().width+30,t.getContentSize().height+30)}else{if(w.type==2){var d=Number(w.chat);var f=new cc.Sprite();f.initWithFile(g_face[d]);u=new ccui.Layout();u.setContentSize(f.width+30,f.height+20);u.setBackGroundImage(a[q]);u.setBackGroundImageScale9Enabled(true);f.setPosition(0.5*u.getContentSize().width,0.5*u.getContentSize().height+5);u.addChild(f);c.addChild(u)}else{if(w.type==3){gameclass.mod_platform.playurl(w.chat);var f=new cc.Sprite(res.soundopen2);f.setAnchorPoint(cc.p(0.5,0.5));c.addChild(f)}}}if(q==1){c.setPosition(k.x-u.width,k.y)}else{c.setPosition(k)}this.node.addChild(c);var l=cc.sequence(cc.delayTime(2),cc.callFunc(function(){c.removeFromParent(true)}));c.runAction(l)}else{if(w.type==4){var s=JSON.parse(w.chat);var p=new cc.Node();p.setScale(0.8);mod_sound.playeffect(g_music["magic"+s.type],false);s.type+=1;var v=sp.SkeletonAnimation.createWithJsonFile(g_magic_chat["magic_chat_"+s.type+"_1_json"],g_magic_chat["magic_chat_"+s.type+"_1_atlas"]);v.setAnimation(0,"animation",false);v.setAnchorPoint(0.5,0.5);p.addChild(v);var b=n.players[q].head.getPosition();p.setPosition(b);var g=null;for(var o=0;o<3;o++){var m=n.mod_ddzhu.getplayerdata(o);if(m&&m.uid==s.hitUid){g=this.players[o].head.getPosition();break}}this.node.addChild(p);p.runAction(cc.sequence(cc.delayTime(1),cc.spawn(cc.rotateTo(0.5,360),cc.moveTo(0.5,g)),cc.callFunc(function(y,x){x.removeFromParent(true);var z=sp.SkeletonAnimation.createWithJsonFile(g_magic_chat["magic_chat_"+s.type+"_2_json"],g_magic_chat["magic_chat_"+s.type+"_2_atlas"]);z.setAnimation(0,"animation",false);z.setAnchorPoint(0.5,0.5);y.addChild(z);y.scheduleOnce(function(){y.removeFromParent(true)},1)},p,v)))}}}}};gameclass.ddzhutable.prototype.clean_call_ui=function(){for(var a=0;a<3;a++){this.players[a].outCards.removeAllChildren()}this.gamebets.setVisible(false);this.qiangzhuang0.setVisible(false);this.buqiang0.setVisible(false)};gameclass.ddzhutable.prototype.updataTotal=function(c){for(var b=0;b<3;b++){for(var a=0;a<3;a++){if(c.info[b].uid==this.players[a].data.uid){this.players[a].userScore.setString(""+c.info[b].total)}}}};gameclass.ddzhutable.prototype.ongameDDZbegin=function(d){var e=this;e.invitebtn.setVisible(false);if(e.RoomMin!=1){e.resetDDZNext()}e.curStep=d.curstep;e.zhuangJia=d.befstep?d.befstep:d.curstep;e.initUserData(d);if(d.begin==true){if(d.bets<1){var c=Math.max(Math.max(d.info[0].bets,d.info[1].bets),d.info[2].bets);e.ongamebets({bets:c,curstep:e.curStep,},1)}else{e.updateDifenView({bets:d.bets,boom:d.boom});var b=0;for(var a=0;a<3;a++){e.playerCardCounts[d.info[a].uid]=d.info[a].card.length;if(d.info[a].dealer){b=d.info[a].uid}if(d.info[a].uid==d.befstep){e.playerCardCounts[d.befstep]+=d.lastcard.length}}e.onDDZgamedealer(d.dzcard,b,d.razz,1);if(e.mod_ddzhu.isdouble){for(var a=0;a<3;a++){e.ongamedouble({uid:d.info[a].uid,isdouble:d.info[a].isdouble},1)}}if(e.userDouble.length==3||!e.mod_ddzhu.isdouble){e.ongameddzstep({uid:d.befstep,cards:d.lastcard,abscards:d.lastabscard,curstep:d.curstep},1)}if(e.curStep==e.mod_ddzhu.uid){e.players[0].outCards.removeAllChildren()}}}e.updataTotal(d);e.updateStepText()};gameclass.ddzhutable.prototype.maxBoom=0;gameclass.ddzhutable.prototype.curBoom=0;gameclass.ddzhutable.prototype.setScorelimit=function(a){var b=a>9?a-10:a;b=b<0?0:b;var c=[3,4,5];this.maxBoom=c[b]};gameclass.ddzhutable.prototype.updateDifenView=function(a){var b=this;if(a.bets<1){return}if(a.boom){b.curBoom=a.boom}b.bets=a.bets;b.difen=b.countDifen(b.curBoom,b.bets);b.fsk_difen.setString("底分："+b.difen)};gameclass.ddzhutable.prototype.countDifen=function(c,b){var d=c-this.maxBoom;d=d<0?0:d;c=d>0?this.maxBoom:c;var a=(c<1?1:Math.pow(2,c))*b;a+=d*b;return a};gameclass.ddzhutable.prototype.ongamebets=function(e,c){var f=this;for(var a=0;a<3;a++){if(f.players[a].data.uid==e.uid){if(e.bets>f.bets){var b=cc.Sprite.create(res["ddzCall"+e.bets])}else{var b=cc.Sprite.create(res.ddzCall0)}b.setPosition(0,0);b.setScale(1.8);f.players[a].outCards.addChild(b)}}var d=this.getSexFromuid(e.uid);if(!c){if(e.bets>f.bets){if(d=0){mod_sound.playeffect(g_music["Woman_Rob_"+e.bets],false)}else{mod_sound.playeffect(g_music["Man_Rob_"+e.bets],false)}f.updateDifenView(e)}else{if(d=0){mod_sound.playeffect(g_music.Woman_NoOrder,false)}else{mod_sound.playeffect(g_music.Man_NoOrder,false)}}}else{f.bets=e.bets>f.bets?e.bets:f.bets}if(e.curstep==f.mod_ddzhu.uid){if(f.mod_ddzhu.CreateRoomType<=2){f.gamebets.setVisible(true);for(var a=0;a<f.bets;a++){ccui.helper.seekWidgetByName(f.node,"gamebets"+a).setBright(false);ccui.helper.seekWidgetByName(f.node,"gamebets"+a).setEnabled(false)}}else{f.qiangzhuang0.setVisible(true);f.buqiang0.setVisible(true)}}f.showCurBets(e.curstep);f.refplayerinfo()};gameclass.ddzhutable.prototype.showCurBets=function(b){if(b!=this.mod_ddzhu.uid){for(var a=0;a<3;a++){if(b==this.players[a].data.uid){}}}};gameclass.ddzhutable.prototype.playAnimdeal=function(a,d,k,e){var g=[];for(var h=1;h<d;h++){var l=a+h+".png";var c=cc.spriteFrameCache.getSpriteFrame(l);g.push(c)}var f=new cc.Animation(g,k);var b=cc.animate(f);e.runAction(cc.repeatForever(b));e.setVisible(true)};gameclass.ddzhutable.prototype.ongameddzstep=function(b,d){var g=this;g.curStep=b.curstep;if(b.uid==g.mod_ddzhu.uid){g.btn_chupai.setVisible(false);g.btn_tishi.setVisible(false);g.btn_buchu.setVisible(false);g.sendHandCardUI(b.cards)}if(g.mod_ddzhu.uid==g.curStep){g.btn_chupai.setVisible(true);g.btn_tishi.setVisible(true);g.btn_buchu.setVisible(true);g.btn_buchu.setBright(true);g.btn_buchu.setEnabled(true)}for(var c=0;c<3;c++){if(g.curStep==g.players[c].data.uid){g.players[c].outCards.removeAllChildren()}}var e=this.getSexFromuid(b.uid);if(b.cards.length>0){var a=g.transMinCard(b.cards);var f=g.tool_cardType.check(a);g.playRes(f.type,f.value,e);g.savebefCard=b.cards;g.zhuangJia=b.uid;g.updateHitOutcard(b.uid,b.cards);if(!d){if(f.type==14||f.type==4){g.curBoom++;g.difen=g.countDifen(g.curBoom,g.bets);g.fsk_difen.setString("底分："+g.difen)}}mod_sound.playeffect(woLongMusics.wl_chuPai,false)}else{if(!d){if(e=0){staticFunction.playUserTalk("Woman_buyao",e)}else{staticFunction.playUserTalk("Man_buyao",e)}g.updateHitOutcard(b.uid,b.cards)}}if(g.zhuangJia==g.mod_ddzhu.uid){g.btn_buchu.setBright(false);g.btn_buchu.setEnabled(false)}g.curCardCount(b.uid,b.cards.length)};gameclass.ddzhutable.prototype.alarmUid=[true,true,true];gameclass.ddzhutable.prototype.alarmRes=function(a,g,k){if(this.alarmUid[g]){if(k<=0){return}var e=[];for(var f=0;f<2;f++){var h="alarm"+f+".png";var c=cc.spriteFrameCache.getSpriteFrame(h);e.push(c)}var d=new cc.Animation(e,0.2);var b=cc.animate(d);this.players[g].alarm.setVisible(true);this.players[g].alarm.runAction(cc.sequence(b).repeatForever());this.scheduleOnce(function(){var l=this.getSexFromuid(this.players[g].data.uid);if(k==1){if(l==0){mod_sound.playeffect(g_music.Woman_one_card,false)}else{mod_sound.playeffect(g_music.Man_one_card,false)}}else{if(l==0){mod_sound.playeffect(g_music.Woman_two_card,false)}else{mod_sound.playeffect(g_music.Man_two_card,false)}}this.alarmUid[g]=false},1)}};gameclass.ddzhutable.prototype.curCardCount=function(b,d){this.playerCardCounts[b]-=d;for(var c=0;c<3;c++){var a=this.playerCardCounts[this.players[c].data.uid];if(a<=2){this.alarmRes(this.players[c].data.uid,c,a)}this.players[c].alarmcount.setString("手牌："+this.playerCardCounts[this.players[c].data.uid])}};gameclass.ddzhutable.prototype.onDDZgamedealer=function(a,f,d,c){var e=this;e.crateDZcard(e.transCardtoNum(a));e.clean_call_ui();if(!c){e.zhuangJia=f;e.curStep=f}if(e.mod_ddzhu.uid==f){if(!c){e.dzdeal(a)}}if(!c){e.playerCardCounts={}}for(var b=0;b<3;b++){if(f==e.players[b].data.uid){e.players[b].dizhu.setTexture(res.btn_dizhu);if(!c){e.playerCardCounts[e.players[b].data.uid]=20}}else{e.players[b].dizhu.setTexture(res.btn_nongmin);if(!c){e.playerCardCounts[e.players[b].data.uid]=17}}e.curCardCount(e.players[b].data.uid,0);e.players[b].dizhu.setVisible(true)}if(e.mod_ddzhu.isdouble){e.isdouble.setVisible(true);e.noDouble.setVisible(true)}else{if(!c){e.curStepUser()}}};gameclass.ddzhutable.prototype.curStepUser=function(){cc.log("func curStepUser");var a=this;if(a.mod_ddzhu.uid==a.curStep){a.btn_buchu.setVisible(true);a.btn_buchu.setBright(false);a.btn_buchu.setEnabled(false);a.btn_chupai.setVisible(true);a.btn_tishi.setVisible(true);a.showProgress(a.curStep)}};gameclass.ddzhutable.prototype.hideDouble=function(a){if(a==this.mod_ddzhu.uid){this.isdouble.setVisible(false);this.noDouble.setVisible(false)}};gameclass.ddzhutable.prototype.userDouble=[];gameclass.ddzhutable.prototype.ongamedouble=function(d,b){var c=this.getSexFromuid(d.uid);if(!b&&d.isdouble==1){if(c==0){}else{mod_sound.playeffect(g_music.Man_bujiabei,false)}}else{if(!b&&d.isdouble==2){if(c==0){}else{mod_sound.playeffect(g_music.Man_jiabei,false)}}}if(d.isdouble){this.hideDouble(d.uid);this.userDouble.push(d.isdouble);if(this.userDouble.length==3){this.curStepUser()}for(var a=0;a<3;a++){if(d.uid==this.players[a].data.uid){this.players[a].spr_double.setVisible(true);if(d.isdouble==2){this.players[a].spr_double.setTexture(res.spr_double2)}}}}};gameclass.ddzhutable.prototype.ongamedealer=function(o,e){var d=this;if(o){var a=d.mod_ddzhu.getplayerdata(0);if(a!=null){}var m=d.mod_ddzhu.getplayernum();var g=0;var k=[];var n=[];for(var b=0;b<3;b++){var l=d.mod_ddzhu.getplayerdata(b);var c=d.mod_ddzhu.getplayerotherdata(b);if(l!=null&&l.rob==1){k[k.length]=c;n[n.length]=d.players[b].zhuang}}if(k.length==0){for(var b=0;b<3;b++){var c=d.mod_ddzhu.getplayerotherdata(b);if(l!=null){k[b]=c;n[b]=d.players[b].zhuang}}}if(k.length>1){var h=(Math.floor(Math.random()*100)%3+k.length*2);var f=cc.repeatForever(cc.sequence(cc.delayTime(0.2),cc.callFunc(function(){var p=g%k.length;for(var r=0;r<3;r++){var q=k[r];if(q!=null){n[r].setVisible(p==r)}}if(g>h){var q=k[p];if(q!=null&&q.dealer){d.stopAllActions();d.refplayerinfo()}}g++})));d.runAction(f)}else{d.refplayerinfo()}}else{d.refplayerinfo()}};gameclass.ddzhutable.prototype.ongameddzbye=function(a){var b=this;b.ddzenddata=a;b.userDouble.length=0;if(!b.mod_ddzhu.isend){b.gameByeAll()}};gameclass.ddzhutable.prototype.gameByeAll=function(){var a=this;a.game.uimgr.showui("gameclass.ddzhuresultui");a.game.uimgr.uis["gameclass.ddzhuresultui"].setData(a.mod_ddzhu)},gameclass.ddzhutable.prototype.ongameDDZend=function(d,f){var e=this;e.ddzenddata=d;e.btn_chupai.setVisible(false);e.btn_tishi.setVisible(false);e.btn_buchu.setVisible(false);e.userDouble.length=0;if(d.ct){e.showCTspr()}for(var c=1;c<3;c++){e.players[c].cards.removeAllChildren()}for(var c=0;c<3;c++){e.mod_ddzhu.roominfo.person[c].ready=false;if(d.info[c].uid==e.mod_ddzhu.uid){continue}for(var b=1;b<3;b++){if(e.players[b].data.uid==d.info[c].uid){e.showEndCard(d.info[c].card,b)}}}if(d.bets<1){e.showToast("无人叫牌，进入下局")}e.mod_ddzhu.roominfo.step++;e.isDDZend=true;var a=cc.sequence(cc.delayTime(2),cc.callFunc(function(g){e.resultend()}));e.node.runAction(a)};gameclass.ddzhutable.prototype.resultend=function(){if(this.isDDZend){var c={difen:this.difen,RoomCount:this.RoomMax-this.RoomMin};var d=[];for(var a=0;a<this.ddzenddata.info.length;a++){d.push({name:this.mod_ddzhu.roominfo.person[a].name,uid:this.mod_ddzhu.roominfo.person[a].uid,icon:this.mod_ddzhu.roominfo.person[a].imgurl,dealer:this.ddzenddata.info[a].dealer,isdouble:this.ddzenddata.info[a].isdouble,score:this.ddzenddata.info[a].score,card:this.ddzenddata.info[a].card})}this.game.uimgr.showui("gameclass.ddzhuresultoneui").setniuniumod(c,this.mod_ddzhu,d);this.RoomMin++;this.updataTotal(this.ddzenddata);var e=0;var b;for(var a=0;a<this.ddzenddata.info.length;a++){if(this.ddzenddata.info[a].uid==this.game.modmgr.mod_login.logindata.uid){b=this.ddzenddata.info[a].score}if(this.ddzenddata.info[a].score>e){e=this.ddzenddata.info[a].score}}if(b>=e){mod_sound.playeffect(woLongMusics.wl_win)}else{mod_sound.playeffect(woLongMusics.wl_lost)}}};gameclass.ddzhutable.prototype.showCTspr=function(){this.curBoom++;this.difen=this.countDifen(this.curBoom,this.bets);this.fsk_difen.setString("底分："+this.difen);this.playRes(20)};gameclass.ddzhutable.prototype.ongameviewf=function(){var b=this;b.ongameview++;if(b.mod_ddzhu.getplayernum()==b.ongameview){b.stopAllActions();var a=cc.sequence(cc.delayTime(3),cc.callFunc(function(c){b.game.uimgr.showui("gameclass.resultoneui").setniuniumod(b.mod_ddzhu,b)}));b.runAction(a);b.refplayerinfo(true)}};gameclass.ddzhutable.prototype.showEndCard=function(e,a){if(e.length==0){return}var c=this.transCardtoNum(e);this.handSort(c);if(a==1){for(var b=c.length-1;b>=0;b--){var d=this.createCardUI(c[b].card,c[b].type);d.setRotation(-90);d.setPosition(0,100);d.runAction(cc.moveBy(0.8,0,-17*b+70));d.setScale(0.6);this.players[a].cards.addChild(d)}}else{for(var b=0;b<c.length;b++){var d=this.createCardUI(c[b].card,c[b].type);d.setRotation(90);d.setPosition(0,100);d.runAction(cc.moveBy(0.8,0,-17*b+70));d.setScale(0.6);this.players[a].cards.addChild(d)}}};gameclass.ddzhutable.prototype.initUserData=function(b){for(var a=0;a<b.info.length;a++){this.refplayerDDZinfo(b.info[a].card,a);this.players[a].ok.setVisible(false);this.players[a].alarmcount.setString("手牌:"+b.info[a].card.length)}};gameclass.ddzhutable.prototype.share=function(){var b=this.mod_ddzhu.GameType==gameclass.gamelzddz?"癞子玩法":"经典玩法";var f=this.maxBoom+"炸封顶";if(this.mod_ddzhu.GameType==gameclass.gamelzddz&&this.mod_ddzhu.CreateRoomType==1){f=this.maxBoom+"炸不封顶"}var a=this.mod_ddzhu.CreateRoomType<=2?"叫分模式":"不叫分模式";var d=this.mod_ddzhu.chaiwang?"双王可拆":"双王不可拆";var c=this.mod_ddzhu.isdouble?"可加倍":"不可加倍";var e="房号["+this.mod_ddzhu.roomnum+"],["+f+"],["+a+"],["+d+"],["+c+"],一共["+this.mod_ddzhu.maxStep+"]局。大家都等您，快来吧。";gameclass.mod_platform.invitefriend(e,this.mod_ddzhu.roomnum,"斗地主-"+b+"-"+this.mod_ddzhu.roomnum)};gameclass.ddzhutable.prototype.checkSafe=function(a){this.safeLayer.checkSafe(a)};gameclass.ddzhutable.prototype.isFirstTips=true;gameclass.ddzhutable.prototype.init=function(){this.node=this.game.uimgr.createnode(res.ddzhutable,true);this.node.setTag(9876);this.node.setPosition((cc.winSize.width-this.node.getContentSize().width)/2,0);this.addChild(this.node);var k=this;cc.spriteFrameCache.addSpriteFrames(res.cardsplist);cc.spriteFrameCache.addSpriteFrames(res.bombplist);cc.spriteFrameCache.addSpriteFrames(res.feijiplist);cc.spriteFrameCache.addSpriteFrames(res.shunzplist);cc.spriteFrameCache.addSpriteFrames(res.wangzhaplist);cc.spriteFrameCache.addSpriteFrames(res.spring0plist);cc.spriteFrameCache.addSpriteFrames(res.lianduilist);cc.spriteFrameCache.addSpriteFrames(res.alarmplist);cc.spriteFrameCache.addSpriteFrames(res.ani1list);var l=new gameclass.btn_setLayer(k.node,k.game);this.node.addChild(l);var d=ccui.helper.seekWidgetByName(k.node,"closeinfo");d.setLocalZOrder(1000);l.setLocalZOrder(999);this.safeLayer=new gameclass.checkSafeLayer(this.node,this.game,ccui.helper.seekWidgetByName(l,"btn_safe"));this.safeLayer.setName("safeLayer");this.node.addChild(this.safeLayer);this.laidipaikuang=ccui.helper.seekWidgetByName(this.node,"laidipaikuang");var a=ccui.helper.seekWidgetByName(this.node,"dianchi");a.setPercent(gameclass.battery);k.qiangzhuang0=ccui.helper.seekWidgetByName(k.node,"qiangzhuang_0");k.buqiang0=ccui.helper.seekWidgetByName(k.node,"buqiang_0");k.isdouble=ccui.helper.seekWidgetByName(k.node,"btn_double");k.noDouble=ccui.helper.seekWidgetByName(k.node,"btn_noDouble");k.isdouble.setVisible(false);k.noDouble.setVisible(false);k.gamebets=ccui.helper.seekWidgetByName(k.node,"gamebets");k.gamebets.setVisible(false);k.qiangzhuang0.setVisible(false);k.buqiang0.setVisible(false);k.invitebtn=ccui.helper.seekWidgetByName(k.node,"invitebtn");k.fsk_difen=ccui.helper.seekWidgetByName(k.node,"fsk_difen");k.fsk_difen.setString("底分："+0);k.talkPos=[cc.p(70,200),cc.p(1000,410),cc.p(150,410)];gameclass.createbtnpress(this.node,"qiangzhuang_0",function(){k.mod_ddzhu.gamebets(1);k.qiangzhuang0.setVisible(false);k.buqiang0.setVisible(false);k.refplayerinfo(null,null,true)});gameclass.createbtnpress(this.node,"buqiang_0",function(){k.mod_ddzhu.gamebets(0);k.qiangzhuang0.setVisible(false);k.buqiang0.setVisible(false);k.refplayerinfo(null,null,true)});gameclass.createbtnpress(this.node,"invitebtn",function(){k.share();if(window.wx){}});var c=function(){};var e=function(){};k.btn_chupai=ccui.helper.seekWidgetByName(k.node,"btn_chupai");k.btn_tishi=ccui.helper.seekWidgetByName(k.node,"btn_tishi");k.btn_buchu=ccui.helper.seekWidgetByName(k.node,"btn_buchu");k.btn_chupai.setVisible(false);k.btn_tishi.setVisible(false);k.btn_buchu.setVisible(false);gameclass.createbtnpress(this.node,"btn_chupai",(function(){k.btn_chupaifunc()}).bind(k));gameclass.createbtnpress(this.node,"btn_tishi",function(){k.btn_tishifunc()});gameclass.createbtnpress(this.node,"btn_buchu",function(){if(k.curStep!=k.mod_ddzhu.uid){return}k.passCard()});gameclass.createbtnpress(this.node,"gamebets0",function(){k.gamebets.setVisible(false);k.mod_ddzhu.gamebets(1);k.refplayerinfo(null,null,true)});gameclass.createbtnpress(this.node,"gamebets1",function(){k.gamebets.setVisible(false);k.mod_ddzhu.gamebets(2);k.refplayerinfo(null,null,true)});gameclass.createbtnpress(this.node,"gamebets2",function(){k.gamebets.setVisible(false);k.mod_ddzhu.gamebets(3);k.refplayerinfo(null,null,true)});gameclass.createbtnpress(this.node,"gamebets_0",function(){k.gamebets.setVisible(false);k.mod_ddzhu.gamebets(0);k.refplayerinfo(null,null,true)});gameclass.createbtnpress(this.node,"btn_noDouble",function(){k.mod_ddzhu.gamedouble(1)});gameclass.createbtnpress(this.node,"btn_double",function(){k.mod_ddzhu.gamedouble(2)});var h=function(m,n){};var b=ccui.helper.seekWidgetByName(this.node,"playerPanel").getChildren();for(var g=0;g<b.length;g++){var f={};f.head=b[g];f.dizhu=ccui.helper.seekWidgetByName(b[g],"isdizhu");f.spr_double=ccui.helper.seekWidgetByName(b[g],"spr_double");f.cards=ccui.helper.seekWidgetByName(this.node,"notifynode"+g);f.outCards=ccui.helper.seekWidgetByName(this.node,"hitoutCardView"+g);f.ok=ccui.helper.seekWidgetByName(b[g],"ok");f.icon=ccui.helper.seekWidgetByName(b[g],"icon");f.ip_id=ccui.helper.seekWidgetByName(b[g],"ip_id");f.playerid=ccui.helper.seekWidgetByName(b[g],"playerid");f.playerip=ccui.helper.seekWidgetByName(b[g],"playerip");f.address=ccui.helper.seekWidgetByName(b[g],"address");f.playername=ccui.helper.seekWidgetByName(b[g],"playername");f.userScore=ccui.helper.seekWidgetByName(b[g],"jifenText");f.alarm=ccui.helper.seekWidgetByName(b[g],"alarm");f.alarmcount=ccui.helper.seekWidgetByName(b[g],"alarmcount");f.off_line=ccui.helper.seekWidgetByName(b[g],"off_line");this.players[g]=f;this.players[g].head.setVisible(false);this.players[g].dizhu.setVisible(false);this.players[g].icon=f.icon;this.players[g].spr_double.setVisible(false);this.players[g].ok.setVisible(false);this.players[g].alarm.setVisible(false);this.players[g].ip_id.setVisible(false);this.players[g].off_line.setVisible(false);this.players[g].userScore.setString("0");this.players[g].head.index=g;this.players[g].head.addTouchEventListener(h)}k.dipaikuang=ccui.helper.seekWidgetByName(this.node,"dipaikuang");k.laidipaiKuang=ccui.helper.seekWidgetByName(this.node,"laidipaikuang")};gameclass.ddzhutable.prototype.btn_tishifunc=function(){var h=this;if(h.curStep!=h.mod_ddzhu.uid){return}var b=h.willSendCard.slice(0,h.willSendCard.length);h.willSendCard.length=0;cc.each(h.handCard,function(m,k){var l=h.players[0].cards.getChildByTag(m.id);if(l.isup){l.setPositionY(l.getPositionY()-20);l.isup=false}});var c=[];if(h.zhuangJia!=h.mod_ddzhu.uid){c=h.savebefCard.slice(0,h.savebefCard.length)}var e=[];for(var g=0;g<h.handCard.length;g++){e[g]=h.handCard[g].id}var f=e.slice(0,e.length);var a=[];if(h.isFirstTips){a=h.tool_cardType.tipsCard(e,c);if(!a||a.length==0){h.showToast("没有牌大过大家");return}else{h.isFirstTips=false}}else{a=h.tool_cardType.tipsCard(e,b);var d=false;if(!a||a.length==0){h.isFirstTips=true}}a.sort(function(l,k){return k-l});h.tipsSelectCards(a,f)};gameclass.ddzhutable.prototype.showToast=function(b){if(this.node.getChildByTag(123456)){return}var d=this;var a=new cc.Sprite(res.img_input);a.setPosition(this.node.getContentSize().width/2,45);a.setOpacity(160);a.setTag(123456);var c=new cc.LabelTTF(b,"Arial",30);c.setPosition(a.getContentSize().width/2,a.getContentSize().height/2);a.addChild(c);d.node.addChild(a);d.scheduleOnce(function(){d.node.removeChildByTag(123456)},2)};gameclass.ddzhutable.prototype.btn_chupaifunc=function(){var f=this;if(f.curStep!=f.mod_ddzhu.uid){return}f.isFirstTips=true;var a=this.transMinCard(this.willSendCard);var e=f.chaiWang(this.willSendCard);if(e){f.showToast("当前玩法不能拆王");return}if(f.zhuangJia==f.mod_ddzhu.uid){var d=this.tool_cardType.check(a);if(d!=0){f.mod_ddzhu.gamesteps(this.willSendCard)}else{f.showToast("牌型错误")}}else{var b=this.transMinCard(this.savebefCard);var c=this.tool_cardType.compare(a,b);if(c.value!=-1){f.mod_ddzhu.gamesteps(this.willSendCard)}else{f.showToast("牌型错误")}}};gameclass.ddzhutable.prototype.chaiWang=function(d){var c=false;if(d.length==1&&!this.mod_ddzhu.chaiwang){if(d[0]==1000||d[0]==2000){var b=0;for(var a=0;a<this.handCard.length;a++){if(this.handCard[a].id==1000||this.handCard[a].id==2000){b++}}if(b==2){return true}}}return c};gameclass.ddzhutable.prototype.tipsSelectCards=function(b,e){var f=0;var a=[];for(var d=0;d<b.length;d++){for(var c=f;c<e.length;c++){var g=0;if(e[c]==1000||e[c]==2000){g=e[c]}else{g=parseInt(e[c]/10);if(g==1){g=14}else{if(g==2){g=20}}}if(a.indexOf(c)<0&&b[d]==g){var h=this.players[0].cards.getChildByTag(e[c]);this.willSendCard.push(h.getTag());h.setPositionY(h.getPositionY()+20);h.isup=true;a.push(c);break}}}};gameclass.ddzhutable.prototype.passCard=function(){this.isFirstTips=true;var a=[];this.mod_ddzhu.gamesteps(a)};gameclass.ddzhutable.prototype.playAnim=function(a,c,f,k){var g=[];for(var h=c;h<f;h++){var l=a+h+".png";var d=cc.spriteFrameCache.getSpriteFrame(l);g.push(d)}var e=new cc.Animation(g,k);var b=cc.animate(e);var m=cc.Sprite.create("#"+a+c+".png");m.attr({x:cc.winSize.width/2,y:cc.winSize.height/2+100});this.addChild(m);m.runAction(cc.sequence(b,cc.callFunc(function(){m.removeFromParent(true)})))};gameclass.ddzhutable.prototype.playRes=function(a,c,b){switch(a){case this.tool_cardType.CARDTYPE.danzhang:if(b==0){mod_sound.playeffect(g_music["Woman_"+c],false)}else{mod_sound.playeffect(g_music["Man_"+c],false)}break;case this.tool_cardType.CARDTYPE.duizi:if(b==0){mod_sound.playeffect(g_music["Woman_dui"+c],false)}else{mod_sound.playeffect(g_music["Man_dui"+c],false)}break;case this.tool_cardType.CARDTYPE.sanzhang:if(b==0){mod_sound.playeffect(g_music["Woman_tuple"+c],false)}else{mod_sound.playeffect(g_music["Man_tuple"+c],false)}break;case this.tool_cardType.CARDTYPE.zhadan:if(b==0){mod_sound.playeffect(g_music.Woman_zhadan,false)}else{mod_sound.playeffect(g_music.Man_zhadan,false)}this.playAnim("anim_bomb_",1,10,0.1);break;case this.tool_cardType.CARDTYPE.sandaiyi:if(b==0){mod_sound.playeffect(g_music.Woman_sandaiyi,false)}else{mod_sound.playeffect(g_music.Man_sandaiyi,false)}break;case this.tool_cardType.CARDTYPE.sandaier:if(b==0){mod_sound.playeffect(g_music.Woman_sandaiyidui,false)}else{mod_sound.playeffect(g_music.Man_sandaiyidui,false)}break;case this.tool_cardType.CARDTYPE.liandui:if(b==0){mod_sound.playeffect(g_music.Woman_liandui,false)}else{mod_sound.playeffect(g_music.Man_liandui,false)}this.playAnim("anim_double_",1,2,2);this.playAnim("anim_double_",2,17,0.2);break;case this.tool_cardType.CARDTYPE.shunzi:if(b==0){mod_sound.playeffect(g_music.Woman_shunzi,false)}else{mod_sound.playeffect(g_music.Man_shunzi,false)}this.playAnim("anim_straight_",1,16,0.15);this.playAnim("anim_straight_",16,17,1.5);break;case this.tool_cardType.CARDTYPE.sidaierdan:if(b==0){mod_sound.playeffect(g_music.Woman_sidaier,false)}else{mod_sound.playeffect(g_music.Man_sidaier,false)}break;case this.tool_cardType.CARDTYPE.sidaierdui:if(b==0){mod_sound.playeffect(g_music.Woman_sidailiangdui,false)}else{mod_sound.playeffect(g_music.Man_sidailiangdui,false)}break;case this.tool_cardType.CARDTYPE.feiji:case this.tool_cardType.CARDTYPE.danfei:case this.tool_cardType.CARDTYPE.shuangfei:if(b==0){mod_sound.playeffect(g_music.Woman_feiji,false)}else{mod_sound.playeffect(g_music.Man_feiji,false)}this.playAnim("anim_plane_",1,2,1);this.playAnim("anim_plane_",2,16,0.2);break;case this.tool_cardType.CARDTYPE.huojian:if(b==0){mod_sound.playeffect(g_music.Woman_wangzha,false)}else{mod_sound.playeffect(g_music.Man_wangzha,false)}this.playAnim("anim_horce_",1,11,0.3);this.playAnim("anim_horce_",17,22,0.3);break;case 20:this.playAnim("chun",1,3,0.5);this.playAnim("spring/upflower/huaban_",1,13,0.15);default:break}};gameclass.ddzhutable.prototype.transMinCard=function(a){var c=[];for(var b=0;b<a.length;b++){c[b]=Math.floor(a[b]/10);if(c[b]<3){c[b]+=13}}return c};gameclass.ddzhutable.prototype.createCardUI=function(c,d){var a=c;if(a>13&&a<16){a-=13}var b=cc.Sprite.create();if(a==100){b.initWithSpriteFrameName("card_joker_gray.png")}else{if(a==200){b.initWithSpriteFrameName("card_joker.png")}else{b.initWithSpriteFrameName("card_"+a+d+".png")}}b.setAnchorPoint(cc.p(0.5,0.5));return b};gameclass.ddzhutable.prototype.updateHandCardUI=function(b){var g=this;g.willSendCard=[];var d=g.handCard;g.players[0].cards.removeAllChildren();var a=d.length>17?80:160;for(var c=0;c<d.length;c++){var e=d[c];var f=g.createCardUI(e.card,e.type);if(b){f.setPosition(0,0);f.runAction(cc.moveBy(0.8,-d.length*25+(50*c)+25,0))}else{f.setPosition(-d.length*25+(50*c)+25,0)}f.setTag(e.id);f.setScale(1.4);g.players[0].cards.addChild(f)}g.createMyEventListener()};gameclass.ddzhutable.prototype.getHandCardWithIndex=function(a){if(a<0){a=this.handCard.length+a}var b=this.players[0].cards.getChildByTag(this.handCard[a].id);return b};gameclass.ddzhutable.prototype.touchHandCard=function(b){var c=Math.min(this.selStartCard,this.selEndCard);var a=Math.max(this.selStartCard,this.selEndCard);cc.each(this.handCard,function(g,e){var f=this.players[0].cards.getChildByTag(g.id);var d=f.getChildren();if(e>=c&&e<=a){f.setColor(cc.color(200,200,200,200));if(d.length>0){d[0].setColor(cc.color(200,200,200,200))}if(b){f.isup=!f.isup;f.setPositionY(f.getPositionY()+(f.isup?1:-1)*20);if(f.isup){this.willSendCard.push(g.id)}else{this.willSendCard.remove(g.id)}}}else{f.setColor(cc.color(255,255,255,255));if(d.length>0){d[0].setColor(cc.color(255,255,255,255))}}},this)};gameclass.ddzhutable.prototype.getTouchCard=function(a){var b=null;cc.each(this.handCard,function(g,d){var f=this.players[0].cards.getChildByTag(g.id);var e=f.convertToNodeSpace(a);var c=(d==this.handCard.length-1)?f.getContentSize().width:40;if(e.x>0&&e.x<c){b=d;return false}},this);return b};gameclass.ddzhutable.prototype.selStartCard=null;gameclass.ddzhutable.prototype.selEndCard=null;gameclass.ddzhutable.prototype.handCard=null;gameclass.ddzhutable.prototype.willSendCard=null;gameclass.ddzhutable.prototype.handSort=function(a){a.sort(function(d,c){if(d.card<c.card){return 1}else{if(d.card==c.card){return d.type<c.type?1:-1}else{return -1}}})};gameclass.ddzhutable.prototype.deal=function(a){this.handCard=[];this.handCard=this.transCardtoNum(a);this.handSort(this.handCard);this.updateHandCardUI(true)};gameclass.ddzhutable.prototype.dzdeal=function(a){var c=this.transCardtoNum(a);for(var b=0;b<c.length;b++){this.handCard.push(c[b])}this.handSort(this.handCard);this.updateHandCardUI()};gameclass.ddzhutable.prototype.sendHandCardUI=function(c){for(var a=0;a<c.length;a++){for(var b=0;b<this.handCard.length;b++){if(c[a]==this.handCard[b].id){this.handCard.splice(b,1);break}}}this.handSort(this.handCard);this.updateHandCardUI()};gameclass.ddzhutable.prototype.updateHitOutcard=function(a,b){var g=b;b=this.transCardtoNum(g);this.handSort(b);var h=0;for(var c=0;c<3;c++){if(a==this.players[c].data.uid){h=c}}if(b.length<1){var e=cc.Sprite.create("res/niuniuRes/btn_no_bigger.png");e.setPosition(0,0);this.players[h].outCards.addChild(e);return}for(var c=0;c<b.length;c++){var d=b[c];var f=this.createCardUI(d.card,d.type);if(h==1){f.setPosition(-b.length*20+(25*c)+20,0)}else{if(h==2){f.setPosition(25*c,0)}else{f.setPosition(-b.length*20/2+(25*c),0)}}this.players[h].outCards.addChild(f)}};gameclass.ddzhutable.prototype.pokerReverse=function(){for(var c=1;c<3;c++){for(var b=0;b<17;b++){var a=cc.Sprite.create("res/niuniuRes/pokercard1.png");a.setRotation(90);a.setPosition(0,-8*b+6);a.setScale(0.6);this.players[c].cards.addChild(a)}}};gameclass.ddzhutable.prototype.setpokerCount=function(b,a){ccui.helper.seekWidgetByName(this.node,"curpoker_count"+b).setString(a)};gameclass.ddzhutable.prototype.reset=function(){this.ongameview=0;this.open=[false,false,false,false];this.mod_ddzhu.gamestate=0;for(var a=0;a<3;a++){this.players[a].cards.removeAllChildren()}this.bets=0;this.difen=0;this.maxTime=4;this.RoomMin=this.mod_ddzhu.minStep||1;this.RoomMax=this.mod_ddzhu.maxStep;this.updateStepText()};gameclass.ddzhutable.prototype.updateStepText=function(){this.curround.setString("局数:"+this.RoomMin+"/"+this.RoomMax)};gameclass.ddzhutable.prototype.crateniuniuani=function(f,c){var b=cc.Sprite.create();var a=[];for(var e=0;e<5;e++){a[e]=false}var d=mod_compare.gettype(f,a);if(d>mod_compare.TYPE_YOUNIU){d-=mod_compare.TYPE_YOUNIU}else{d=0}b.initWithSpriteFrameName("wenziniu"+d+".png");b.setAnchorPoint(cc.p(0.5,0.5));if(c){mod_sound.playeffect(g_music["niu_"+d+"_w"],false)}return b};gameclass.ddzhutable.prototype.cratecard=function(d,b){var f=["a","d","b","c"];var a=Math.floor(d/10);var e=d%10;var c=cc.Sprite.create();if(d<=0){c.initWithSpriteFrameName("pukebeimian.png")}else{c.initWithSpriteFrameName("card_"+a+f[e-1]+".png")}c.setAnchorPoint(cc.p(0.5,0.5));if(b){c.setPositionY(20)}return c};gameclass.ddzhutable.prototype.crateDZcard=function(c){for(var b=0;b<3;b++){var a=cc.Sprite.create();a=this.createCardUI(c[b].card,c[b].type);a.setPosition(this.dipaikuang.getContentSize().width/2+(28*b)-28,this.dipaikuang.getContentSize().height/2);a.setScale(0.45);this.dipaikuang.addChild(a)}};gameclass.ddzhutable.prototype.refplayerDDZinfo=function(d,c){var b=[];for(var a=0;a<d.length;a++){var e=d[a];if(e==0){return}b.push(e)}this.deal(b)};gameclass.ddzhutable.prototype.transCardtoNum=function(d){var f=["a","d","b","c"];var c=[];for(var b=0;b<d.length;b++){var a=Math.floor(d[b]/10);var e=d[b]%10;if(a<3){a+=13}e=f[e-1];c.push({card:a,type:e,id:d[b],})}return c};gameclass.ddzhutable.prototype.removeTagSpr=function(a){this.dipaikuang.removeChildByTag(a)};gameclass.ddzhutable.prototype.createMyEventListener=function(){var a=this;cc.eventManager.addListener(cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:true,onTouchBegan:function(e,c){var d=c.getCurrentTarget();var b=d.convertToNodeSpace(e.getLocation());if(b.y>180){return true}a.selStartCard=a.getTouchCard(b);return true},onTouchMoved:function(g,d){var f=d.getCurrentTarget();var c=f.convertToNodeSpace(g.getLocation());if(c.y>180){return true}if(a.selStartCard===null){return true}a.selEndCard=a.getTouchCard(c);if(a.selEndCard===null){var b=a.getHandCardWithIndex(0);var e=a.getHandCardWithIndex(-1);if(0>b.convertToNodeSpace(c).x){a.selEndCard=0}if(e.convertToNodeSpace(c).x>e.getContentSize().width){a.selEndCard=a.handCard.length-1}if(a.selEndCard===null){return true}}a.touchHandCard();return true},onTouchEnded:function(c,b){if(a.selStartCard!==null&&a.selEndCard===null){a.selEndCard=a.getTouchCard(c.getLocation())}if(a.selStartCard!==null&&a.selEndCard!==null){a.touchHandCard(true)}a.selStartCard=null;a.selEndCard=null;cc.each(a.handCard,function(g,e){var f=a.players[0].cards.getChildByTag(g.id);var d=f.getChildren();f.setColor(cc.color(255,255,255,255));if(d.length>0){d[0].setColor(cc.color(255,255,255,255))}});return true}}),this)};Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a}}return -1};Array.prototype.remove=function(b){var a=this.indexOf(b);if(a>-1){this.splice(a,1)}};gameclass.ddzhutable.prototype.resetIcon=function(c){for(var b=0;b<3;b++){var a=this.mod_ddzhu.getplayerdata(b);if(a==null){continue}if(a.uid!=c){continue}gameclass.mod_base.showtximg(this.players[b].icon,a.imgurl,0,0,"im_headbg2",a.ip=="");break}};gameclass.ddzhutable.prototype.createProgress=function(c,a){if(c.getChildByTag(123321)){c.getChildByTag(123321).removeFromParent(true)}var b=cc.progressFromTo(15,100,0);var d=new cc.ProgressTimer(new cc.Sprite(res.progressBar));d.setAnchorPoint(0.5,0.5);d.type=cc.ProgressTimer.TYPE_RADIAL;d.setReverseDirection(true);d.setTag(123321);c.addChild(d);d.setPosition(c.getChildByName("icon").getPosition());d.runAction(b.repeatForever())};gameclass.ddzhutable.prototype.userLineOut=function(a,b){var a=a-this.mod_ddzhu.serverchair;if(a<0){a=a+3}if(b.line){this.players[a].off_line.setVisible(false)}else{this.players[a].off_line.setVisible(true)}this.players[a].off_line.setLocalZOrder(this.players[a].icon.getChildren().length-1)};gameclass.ddzhutable.prototype.refplayerinfo=function(r,v,t){cc.log("refplayerinfo");var C=this.mod_ddzhu.gameniuniuinfo!=null&&this.mod_ddzhu.gameniuniuinfo.begin;for(var B=0;B<3;B++){var b=this.mod_ddzhu.getplayerdata(B);var e=b!=null;if(e){var y=b;this.players[B].data=y;this.players[B].playername.setString(b.name);this.players[B].head.setVisible(true);this.players[B].off_line.setVisible(!b.line);gameclass.mod_base.showtximg(this.players[B].icon,b.imgurl,0,0,"im_headbg2",b.ip=="")}else{this.players[B].head.setVisible(false)}}var o=false;var n=false;var A=false;var c=false;var p=[false,false,false,false];if(C){var u=false;for(var B=0;B<3;B++){var l=this.mod_ddzhu.getplayerotherdata(B);if(l!=null){if(l.bets!=0){var f=Math.floor(Math.abs(l.bets));if(f>0&&f<6){}}else{}if(v!=null){}this.players[B].zhuang.setVisible(l.dealer);if(l.dealer){u=true}var g=l.card;this.players[B].cards.removeAllChildren();if(B==0){o=l.dealer;n=g[3]>0;A=l.score!=0}var s=90;var D=-90*5/2+45;if(B!=0){s=25}D+=150;var q=[];for(var x=0;x<5;x++){q[x]=false}var k=mod_compare.gettype(g,q);for(var z=0;z<5;z++){var a=g[z];if(B!=0&&r==null){a=0}var h=this.cratecard(a,q[z]&&n&&a>0);h.setPositionX(D+z*s);this.players[B].cards.addChild(h);if(z==3&&n&&a>0){if(!this.open[B]&&(this.mod_ddzhu.gamestate==1||this.mod_ddzhu.gamestate==2)){p[B]=true;this.open[B]=true}var d=this.crateniuniuani(g,p[B]);h.addChild(d)}}}}if(!u){c=true}}};gameclass.ddzhutable_wild=gameclass.ddzhutable.extend({wildCard:null,selLayer:null,selBtn_OK:null,selBtn_Cancel:null,selCardScroll:null,virtualbefCard:null,fiveBoom:null,tipsCard:null,absCards:null,lastCards:null,useRazz:0,setmod:function(a){this._super(a);this.tipsCard=new gameclass.tool_wildcardType();this.selLayer=ccui.helper.seekWidgetByName(this.node,"selLayer");this.selCardScroll=ccui.helper.seekWidgetByName(this.selLayer,"selcardscroll");cc.log(this.selCardScroll);this.selBtn_Cancel=ccui.helper.seekWidgetByName(this.selLayer,"selcardcancel");this.selBtn_OK=ccui.helper.seekWidgetByName(this.selLayer,"selcardok");this.bindEvent()},bindEvent:function(){var a=this;this.selBtn_OK.addTouchEventListener(function(b,c){if(c==ccui.Widget.TOUCH_ENDED){a.onSelOk()}});this.selBtn_Cancel.addTouchEventListener(function(b,c){if(c==ccui.Widget.TOUCH_ENDED){a.onSelCancel()}})},onSelCancel:function(){this.selCardScroll.removeAllChildren();this.selLayer.setVisible(false)},onSelOk:function(){if(!this.preAbsCard){return true}var a=[];cc.each(this.preAbsCard,function(c,b){a[b]=c.id});this.mod_ddzhu.gamesteps_wild(this.willSendCard,a);this.onSelCancel()},onDDZgamedealer:function(b,d,a,c){this._super(b,d,a,c);this.wildCard=a;this.createWildAction(this.wildCard)},createWildAction:function(g){var f=this;var d=new cc.Sprite(res.img_laizi_bg);d.setPosition(cc.winSize.width/2,cc.winSize.height/2+100);d.setTag(11110);f.addChild(d);var e=new cc.Sprite(res.pokerBei);e.setPosition(d.getContentSize().width/2,d.getContentSize().height/2-50);e.setScale(0);d.addChild(e);var h=cc.callFunc(function(){var m=[];m[0]=parseInt(g+"1");var n=f.transCardtoNum(m);var l=f.createCardUI(n[0].card,n[0].type);l.setPosition(e.getContentSize().width/2,e.getContentSize().height/2);e.addChild(l)});var b=cc.callFunc(function(){f.removeChildByTag(11110)});var a=cc.callFunc(function(){var n=[];n[0]=parseInt(g+"1");var o=f.transCardtoNum(n);var l=f.createCardUI(o[0].card,o[0].type);l.setScale(0.45);l.setPosition(f.laidipaiKuang.getContentSize().width/2,f.laidipaiKuang.getContentSize().height/2);f.laidipaiKuang.addChild(l);var m=new cc.Sprite(res.rogue);m.setPosition(20,65);m.setScale(0.8);l.addChild(m);f.updateHandCardUI()});var k=cc.scaleTo(1,1);var c=cc.rotateTo(1,0);e.runAction(cc.sequence(k,h,c,b,a))},sortWildCard:function(a){var f=0;var c=[];for(var b=0;b<a.length;b++){var g=parseInt(a[b].id/10);if(g==this.wildCard){a[b].wild=true;c[c.length]=a[b];a[b]=null}else{a[b].wild=false}}var e=c.concat(a);var d=[];for(var b=0;b<e.length;b++){if(e[b]){d[f]=e[b];f++}}return d},getSexFromuid:function(b){for(var a=0;a<3;a++){if(this.players[a].data.uid==b){var c=this.players[a].data.sex;if(c==1||c==2){return c-1}else{return 0}}}return 0},updateHandCardUI:function(a){var g=this;g.willSendCard=[];var c=g.sortWildCard(g.handCard);cc.log(c);g.handCard=c;g.players[0].cards.removeAllChildren();for(var b=0;b<c.length;b++){var d=c[b];var e=g.createCardUI(d.card,d.type);if(a){e.setPosition(0,0);e.runAction(cc.moveBy(0.8,-c.length*25+(50*b)+25,0))}else{e.setPosition(-c.length*25+(50*b)+25,0)}e.setTag(d.id);e.setScale(1.4);g.players[0].cards.addChild(e);if(d.wild){var f=new cc.Sprite(res.rogue);f.setPosition(20,65);f.setScale(0.8);e.addChild(f)}}g.createMyEventListener();this.isFirstTips=true},setScorelimit:function(a){this.fiveBoom=a==0?0:1;this.fiveBoom=this.fiveBoom<0?0:this.fiveBoom;var b=[5,5];this.maxBoom=b[this.fiveBoom]},countDifen:function(c,b){var d=c-this.maxBoom;d=d<0?0:d;c=d>0?this.maxBoom:c;var a=(c<1?1:Math.pow(2,c))*b;if(this.fiveBoom){a+=d*b}return a},hasWildCard:function(b){var a=false;cc.each(b,function(d,c){if(d==14){d=1}else{if(d==15){d=2}}if(d==this.wildCard){a=true;return false}},this);return a},isPass:function(b){var a=true;cc.each(b,function(d,c){if(parseInt(d/10)==this.wildCard){a=false;return false}},this);return a},passCard:function(){this.isFirstTips=true;var a=[];this.mod_ddzhu.gamesteps_wild(a,a)},getBefWild:function(){var a=0;cc.each(this.virtualbefCard,function(c,b){if(parseInt(c/10)==this.wildCard){a=1}},this);cc.log(a);return a},getWildCount:function(){var a=0;cc.each(this.virtualbefCard,function(c,b){if(parseInt(c/10)==this.wildCard){a++}},this);cc.log(a);return a},btn_tishifunc:function(){var e=this;cc.log("---------tishi--------");if(e.curStep!=e.mod_ddzhu.uid){return}e.willSendCard.length=0;cc.each(e.handCard,function(h,f){var g=e.players[0].cards.getChildByTag(h.id);if(g.isup){g.setPositionY(g.getPositionY()-20);g.isup=false}});var c=[];for(var d=0;d<e.handCard.length;d++){c[d]=e.handCard[d].id}if(e.isFirstTips){var b=[];if(e.zhuangJia!=e.mod_ddzhu.uid){for(var d=0;d<e.savebefCard.length;d++){b[d]=e.savebefCard[d]}}e.absCards=[];e.lastCards=e.tipsCard.tipsCard(c,b,e.getBefWild(),e.wildCard,e.absCards);cc.log("_this.lastCards");cc.log(e.lastCards);if(e.lastCards.length==0||!e.lastCards){e.showToast("没有牌大过大家");return}else{e.isFirstTips=false}this.useRazz=(e.lastCards.toString()==e.absCards.toString()?0:1)}else{var b=[];for(var d=0;d<e.absCards.length;d++){if(e.absCards[d]<1000){b[d]=e.absCards[d]*10}else{b[d]=e.absCards[d]}}e.absCards=[];var a=e.tipsCard.tipsCard(c,b,this.useRazz,e.wildCard,e.absCards);cc.log("_this.tipscard");cc.log(a);if(a.toString()==e.lastCards.toString()){e.lastCards=[]}else{e.lastCards=a;this.useRazz=(e.lastCards.toString()==e.absCards.toString()?0:1)}}if(e.lastCards.length==0){e.isFirstTips=true;return}e.tipsSelectCards(e.lastCards)},ongamebets:function(b,a){this._super(b,a);ccui.helper.seekWidgetByName(this.gamebets,"gamebets2").setVisible(false);this.gamebets.setPositionX(cc.winSize.width/2+75)},tipsSelectCards:function(a){for(var c=0;c<a.length;c++){for(var b=0;b<this.handCard.length;b++){if(a[c]==14){a[c]=1}else{if(a[c]==20){a[c]=2}else{if(a[c]>=1000){a[c]/=10}}}if(a[c]!=parseInt(this.handCard[b].id/10)){continue}var d=this.players[0].cards.getChildByTag(this.handCard[b].id);if(d.isup){continue}this.willSendCard.push(d.getTag());d.setPositionY(d.getPositionY()+20);d.isup=true;break}}},isObjectValueEqual:function(d,c){if(d.type!=c.type){return false}var b=this.tipsCard.transformToCardArr(d);var a=this.tipsCard.transformToCardArr(c);if(b.sort().toString()==a.sort().toString()){return true}cc.log(b);cc.log(a)},findMaxAndMin:function(b){var a=[];if(!cc.isArray(b)){cc.log("xxxxxxxxxx");a.push(b);return a}var c=b[0].type;switch(c){case 7:case 8:case 11:case 12:case 13:b=b.sort(function(g,f){return g.value.max-f.value.max});break;default:b=b.sort(function(g,f){return g.value-f.value});break}cc.log(b);var e=b[0];var d=b[b.length-1];a.push(d);if((e.value||e.value===0)&&(d.value||d.value===0)){if(!cc.isObject(d.value)&&!cc.isObject(e.value)&&e.value!==d.value){a.push(e)}else{if(e.value.max&&d.value.max&&e.value.max!==d.value.max){a.push(e)}}}return a},removeSame:function(b){var d=[];for(var c=0;c<b.length;c++){cc.log(b[c]);var a=this.findMaxAndMin(b[c]);d=d.concat(a)}return d},btn_chupaifunc:function(){var g=this;cc.log("curStep=="+g.curStep);cc.log("_this.mod_ddzhu.uid=="+g.mod_ddzhu.uid);cc.log("zhuangJia=="+g.zhuangJia);if(g.curStep!=g.mod_ddzhu.uid){return}cc.log("willSendCard"+this.willSendCard);g.isFirstTips=true;var k=this.transMinCard(this.willSendCard);var e=g.chaiWang(this.willSendCard);if(e){g.showToast("当前玩法不能拆王");return}var b=this.isPass(this.willSendCard);if(g.zhuangJia==this.mod_ddzhu.uid){var c=g.tipsCard.checkW(k,this.wildCard);cc.log("111111111111111");cc.log(c);cc.log(c.length);if(c!=0){c=g.removeSame(c);cc.log(c);if(b){g.mod_ddzhu.gamesteps_wild(this.willSendCard,this.willSendCard);return}if(c.length>1){g.showSelCard(c);return}var h=g.tipsCard.transformToCardArr(c[0]);var m=this.convertAbscards(h,this.willSendCard);g.mod_ddzhu.gamesteps_wild(this.willSendCard,m)}else{g.showToast("牌型错误")}}else{var n=this.hasWildCard(k);cc.log(n);var d=this.transMinCard(this.virtualbefCard);cc.log(d);var f=this.hasWildCard(d);cc.log(f);var l=this.transMinCard(this.savebefCard);var a=g.tipsCard.compareW(k,l,this.wildCard,n,f);cc.log("perssCard");cc.log(a);if(a!=0){if(b){g.mod_ddzhu.gamesteps_wild(this.willSendCard,this.willSendCard);return}a=g.removeSame(a);cc.log(a);if(a.length>1){g.showSelCard(a);return}var h=g.tipsCard.transformToCardArr(a[0]);var m=this.convertAbscards(h,this.willSendCard);g.mod_ddzhu.gamesteps_wild(this.willSendCard,m)}else{g.showToast("牌型错误")}}},ongameddzstep:function(b,d){var g=this;cc.log("abscards="+b.abscards);cc.log("cards="+b.cards);cc.log("stepData.uid="+b.uid);g.curStep=b.curstep;if(b.uid==g.mod_ddzhu.uid){g.btn_chupai.setVisible(false);g.btn_tishi.setVisible(false);g.btn_buchu.setVisible(false);g.sendHandCardUI(b.cards)}if(g.mod_ddzhu.uid==g.curStep){g.btn_chupai.setVisible(true);g.btn_tishi.setVisible(true);g.btn_buchu.setVisible(true);g.btn_buchu.setBright(true);g.btn_buchu.setEnabled(true)}for(var c=0;c<3;c++){if(g.curStep==g.players[c].data.uid){g.players[c].outCards.removeAllChildren()}}var e=this.getSexFromuid(b.uid);if(cc.isArray(b.abscards)){if(b.abscards.length>0){var a=g.transMinCard(b.abscards);var f=g.tool_cardType.check(a);g.playRes(f.type,f.value);g.savebefCard=b.abscards;g.virtualbefCard=b.cards;g.zhuangJia=b.uid;g.updateHitOutcard(b.uid,b.abscards);if(!d){if(f.type==14||f.type==4){g.curBoom++;g.difen=g.countDifen(g.curBoom,g.bets);g.fsk_difen.setString("底分："+g.difen)}}}else{if(!d){if(e=0){staticFunction.playUserTalk("Woman_buyao",e)}else{staticFunction.playUserTalk("Man_buyao",e)}g.updateHitOutcard(b.uid,b.abscards)}}}if(g.zhuangJia==g.mod_ddzhu.uid){g.btn_buchu.setBright(false);g.btn_buchu.setEnabled(false)}g.curCardCount(b.uid,b.cards.length)},updateHitOutcard:function(a,b){var g=b;b=this.transCardtoAbs(g);this.handSort(b);var h=0;for(var c=0;c<3;c++){if(a==this.players[c].data.uid){h=c}}if(b.length<1){var e=cc.Sprite.create("res/niuniuRes/btn_no_bigger.png");e.setPosition(0,0);this.players[h].outCards.addChild(e);return}for(var c=0;c<b.length;c++){var d=b[c];var f=this.createVirtualCardUI(d.card,d.type);if(h==1){f.setPosition(-b.length*20+(25*c)+20,0)}else{if(h==2){f.setPosition(25*c,0)}else{f.setPosition(-b.length*20/2+(25*c),0)}}f.setScale(0.8);this.players[h].outCards.addChild(f)}},transCardtoAbs:function(d){var f=["a","d","b","c","e"];var c=[];for(var b=0;b<d.length;b++){var a=Math.floor(d[b]/10);var e=d[b]%10;if(a<3){a+=13}e=f[e-1];c.push({card:a,type:e,id:d[b],})}return c},createVirtualCardUI:function(b,c){if(c=="e"){var a=this.createCardUI(b,"b");var d=new cc.Sprite(res.rogue);d.setPosition(20,65);d.setScale(0.8);a.addChild(d);return a}else{return this.createCardUI(b,c)}},onSelCardTouch:function(a,b){if(b!==ccui.Widget.TOUCH_ENDED){return}cc.each(this.selCardScroll.getChildren(),function(d,c){d.removeBackGroundImage()});a.setBackGroundImage("res/niuniuRes/selcell_bg.png");this.preAbsCard=a.wildCard},showSelCard:function(d){this.preAbsCard=null;var r=[];var s=0;for(var g=0;g<d.length;g++){if(g%2==0){s++}}cc.log(this.selCardScroll);var a=this.selCardScroll.getContentSize();this.selCardScroll.setInnerContainerSize(cc.size(a.width,s*100));a=this.selCardScroll.getInnerContainerSize();s=0;var c=0,k=0;for(var g=0;g<d.length;g++){var o=this.tipsCard.getCardTypeString(d[g].type);var n=new ccui.Layout();n.setBackGroundImageScale9Enabled(true);if(g%2==0){s++}var q=this.tipsCard.transformToCardArr(d[g]);r=this.convertAbscards(q,this.willSendCard);var m=this.transCardtoAbs(r);for(var f=0;f<m.length;f++){var b=this.createVirtualCardUI(m[f].card,m[f].type);if(k==0){k=b.getContentSize().height*0.6;c=b.getContentSize().width*0.6}b.setAnchorPoint(0,0);b.setPosition(16*f+10,10);b.setScale(0.6);n.addChild(b)}var p=q.length-1;var l=16*p+c+20;n.wildCard=m;n.setContentSize(l,k+20);n.setPosition(g%2==0?50:(a.width+100)/2,a.height-(k+20)*s);n.setTouchEnabled(true);n.addTouchEventListener(this.onSelCardTouch.bind(this));var h=new cc.Sprite(res.img_jiaobiao);h.setPosition(h.getContentSize().width/2+10,h.getContentSize().height/2+10);n.addChild(h);var e=new cc.LabelTTF(o,"Arial",20);e.x=h.getContentSize().width/2;e.y=h.getContentSize().height/2;h.addChild(e);this.selCardScroll.addChild(n)}this.selLayer.setVisible(true)},convertAbscards:function(c,e){var f=[];for(var d=0;d<c.length;d++){if(c[d]==11){f[d]=15}else{if(c[d]==12){f[d]=25}else{if(c[d]==13){f[d]=1000}else{if(c[d]==14){f[d]=2000}else{f[d]=((c[d]+3)*10+5)}}}}}var a=[];for(var d=0;d<f.length;d++){for(var b=0;b<e.length;b++){if(a.indexOf(b)<0&&parseInt(f[d]/10)==parseInt(e[b]/10)&&parseInt(e[b]/10)!=this.wildCard){f[d]=e[b];a.push(b);break}}}return f},resetDDZNext:function(){this._super();this.removeChildByTag(11111);this.wildCard=0},});gameclass.ddzrecord=gameclass.baseui.extend({node:null,players:null,steps:null,roomid_text:null,time_text:null,curRecord_text:null,headNodes:null,stepIndex:0,razzCard:0,pauseBtn:null,isPause:false,speed:1.5,ctor:function(){this._super();cc.spriteFrameCache.addSpriteFrames(res.cardsplist)},show:function(){this.node=this.game.uimgr.createnode(res.ddzRecordjson,true);this.addChild(this.node);var c=this;c.roomid_text=ccui.helper.seekWidgetByName(this.node,"roomnum");c.roomid_text.setString("");c.time_text=ccui.helper.seekWidgetByName(this.node,"time");c.time_text.setString("");c.curRecord_text=ccui.helper.seekWidgetByName(this.node,"curRecord");gameclass.createbtnpress(this.node,"btn_colse",function(){c.unscheduleAllCallbacks();c.game.uimgr.showui("gameclass.hallui");c.game.uimgr.closeui("gameclass.ddzrecor")});gameclass.createbtnpress(this.node,"btn_pause",function(d){c.isPause=!c.isPause;cc.log(c.isPause);d.loadTextureNormal(c.isPause?res.btn_bofang:res.btn_zanting)});gameclass.createbtnpress(this.node,"btn_shangJu",function(){c.playerNextRecord(-1)});gameclass.createbtnpress(this.node,"btn_houTui",function(){c.playerNextRecord(0)});gameclass.createbtnpress(this.node,"btn_qianJin",function(){c.unscheduleAllCallbacks();c.speed=c.speed<1?1.5:0.8;c.startReplay(c.speed)});gameclass.createbtnpress(this.node,"btn_xiaJu",function(){c.playerNextRecord(1)});gameclass.createbtnpress(this.node,"btn_share",function(){gameclass.mod_platform.savescreen(function(d){if(window.wx){d=JSON.parse(d);if(d.error==0){c.share(d.url)}}})});c.headNodes=[];for(var a=0;a<3;a++){var b=ccui.helper.seekWidgetByName(this.node,"head"+a);c.headNodes[a]={root:b,headImg:ccui.helper.seekWidgetByName(b,"headbg"),nameText:ccui.helper.seekWidgetByName(b,"playername"),jifenText:ccui.helper.seekWidgetByName(b,"jifenText"),isDizhu:ccui.helper.seekWidgetByName(b,"isdizhu"),userCardNode:ccui.helper.seekWidgetByName(this.node,"notifynode"+a),hitoutCardNode:ccui.helper.seekWidgetByName(this.node,"hitoutCardView"+a),}}c.headNodes[1].isDizhu.setPositionX(20)},share:function(a){gameclass.mod_platform.wxsharelink("斗地主结算","战绩",a)},setMod:function(a){this.mod_record=a;var b=this;this.mod_record.getRecordBureau(function(c){cc.log(c);if(!c){return}b.players=c.person;b.players=b.offsetPlayer(c.person,b.mod_record.curUserid);b.razzCard=c.razz;b.steps=c.step;b.roomid_text.setString("房号:"+parseInt(c.roomid/100));b.time_text.setString(b.getDate(c.time).toString());var e=c.roomid+"";var d=parseInt(e.substring(e.length-2,e.length));b.curRecord_text.setString("第 "+d+" 局");b.initPlayer();b.startReplay(b.speed)})},playerNextRecord:function(b){this.stepIndex=0;if(this.steps){this.steps.length=0}this.unscheduleAllCallbacks();for(var a=0;a<3;a++){if(a==0){this.headNodes[0].userCardNode.setPositionX(340)}else{if(a==1){this.headNodes[1].userCardNode.setPositionY(160)}else{if(a==2){this.headNodes[2].userCardNode.setPositionY(480)}}}this.headNodes[a].userCardNode.removeAllChildren();this.headNodes[a].hitoutCardNode.removeAllChildren()}this.mod_record.setCurBureauid(this.mod_record.curBureauid+b);this.setMod(this.mod_record)},getDate:function(a){var b=new Date(a*1000);var a=(b.getFullYear())+"-"+(b.getMonth()+1)+"-"+(b.getDate())+" "+(b.getHours())+":"+(b.getMinutes())+":"+(b.getSeconds());return a},offsetPlayer:function(b,e){var d=[];var c=0;for(var a=0;a<b.length;a++){if(b[a].uid==e){c=a;break}}for(var a=0;a<b.length;a++){d[(3+a-c)%3]=b[a]}return d},initPlayer:function(){var f=this;for(var d=0;d<3;d++){var c=this.players[d];gameclass.mod_base.showtximg(this.headNodes[d].headImg,c.head,0,0,"im_headbg2");this.headNodes[d].nameText.setString(c.name);this.headNodes[d].jifenText.setString(c.score);this.headNodes[d].isDizhu.setTexture(c.card.length>17?res.btn_dizhu:res.btn_nongmin);c.card=this.transCardtoNum(c.card);var e=this.sortWildCard(c.card);var b=this.initPlayerCard(e,d);var a=b[0].getContentSize();f.headNodes[d].userCardNode.setContentSize(b.length*25+a.width,a.height);cc.each(b,function(g){f.headNodes[d].userCardNode.addChild(g)})}},sortWildCard:function(a){var f=0;var c=[];for(var b=0;b<a.length;b++){if(parseInt(a[b].id/10)==this.razzCard){a[b].wild=true;c[c.length]=a[b];a[b]=null}else{a[b].wild=false}}var e=c.concat(a);var d=[];for(var b=0;b<e.length;b++){if(e[b]){d[f]=e[b];f++}}cc.log(d);return d},startReplay:function(a){var b=this;this.schedule(function(){if(b.isPause){return}b.updateData(b.steps[b.stepIndex]);b.stepIndex++;if(b.stepIndex>=b.steps.length||b.stepIndex<=0){b.unscheduleAllCallbacks()}},a)},initPlayerCard:function(c,b){var e=[];for(var a=0;a<c.length;a++){var d=c[a];var f=this.createCardUI(d.card,d.type);switch(b){case 0:f.setPosition(25*a,0);break;case 1:f.setRotation(-90);f.setPosition(0,20*a);break;case 2:f.setRotation(90);f.setPosition(0,-20*a);break}f.setScale(0.8);f.setTag(d.id);if(d.wild){var g=new cc.Sprite(res.rogue);g.setPosition(20,65);g.setScale(0.8);f.addChild(g)}e.push(f)}return e},removeHandcard:function(b,a){var e=this;cc.each(b,function(g,f){e.headNodes[a].userCardNode.removeChildByTag(g)});var d=this.headNodes[a].userCardNode.getChildren();var c=this.headNodes[a].userCardNode.getChildrenCount();cc.each(d,function(g,f){switch(a){case 0:g.setPosition(25*f,0);break;case 1:g.setPosition(0,20*f);g.setRotation(-90);break;case 2:g.setRotation(90);g.setPosition(0,-f*20);break}});switch(a){case 0:this.headNodes[a].userCardNode.setPositionX(this.headNodes[a].userCardNode.getPositionX()+b.length*25/2);break;case 1:this.headNodes[a].userCardNode.setPositionY(this.headNodes[a].userCardNode.getPositionY()+b.length*20/2);break;case 2:this.headNodes[a].userCardNode.setPositionY(this.headNodes[a].userCardNode.getPositionY()-b.length*20/2);break}},initPlayerAbscard:function(c,b){var e=[];for(var a=0;a<c.length;a++){var d=c[a];var f=this.createVirtualCardUI(d.card,d.type);switch(b){case 0:f.setPosition(-c.length*20/2+a*20,0);break;case 1:f.setRotation(0);f.setPosition(-c.length*20+a*20,0);break;case 2:f.setRotation(0);f.setPosition(20*a,0);break}f.setScale(0.7);f.setTag(d.id);e.push(f)}return e},createVirtualCardUI:function(b,c){if(c=="e"){var a=this.createCardUI(b,"b");var d=new cc.Sprite(res.rogue);d.setPosition(20,65);d.setScale(0.8);a.addChild(d);return a}else{return this.createCardUI(b,c)}},createCardUI:function(c,d){var a=c;if(a>13&&a<16){a-=13}var b=cc.Sprite.create();if(a==100){b.initWithSpriteFrameName("card_joker_gray.png")}else{if(a==200){b.initWithSpriteFrameName("card_joker.png")}else{b.initWithSpriteFrameName("card_"+a+d+".png")}}b.setAnchorPoint(cc.p(0.5,0.5));return b},transCardtoNum:function(d){var f=["a","d","b","c","e"];var c=[];for(var b=0;b<d.length;b++){var a=Math.floor(d[b]/10);var e=d[b]%10;if(a<3){a+=13}e=f[e-1];c.push({card:a,type:e,id:d[b],})}c.sort(function(h,g){return h.card>g.card?-1:1});return c},updateData:function(a){cc.log(a);if(!a){return}var f=this;var e=-1;for(var d=0;d<this.players.length;d++){if(a.uid==this.players[d].uid){e=d;break}}f.headNodes[e].hitoutCardNode.removeAllChildren();var b=this.transCardtoNum(a.abscard);var c=this.initPlayerAbscard(b,e);if(c.length<1){f.headNodes[e].hitoutCardNode.runAction(cc.sequence(cc.delayTime(0.2),cc.callFunc(function(){var h=new cc.Sprite("res/niuniuRes/btn_no_bigger.png");var g=e==1?-20:0;h.setPosition(g,0);f.headNodes[e].hitoutCardNode.addChild(h)})))}f.removeHandcard(a.card,e);cc.each(c,function(g){f.headNodes[e].hitoutCardNode.addChild(g)});cc.log(a.card)},});gameclass.ddzhuresultoneui=gameclass.baseui.extend({sprite:null,node:null,mod_ddzhu:null,ddzhutable:null,jifen:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.ddzhuresultoneui,true);this.addChild(this.node)},setniuniumod:function(l,m,f){this.mod_ddzhu=m;var h=this;var c=function(){h.game.uimgr.closeui("gameclass.ddzhuresultoneui");if(h.mod_ddzhu.isover){h.game.uimgr.closeui("gameclass.ddzhutable_wild");h.game.uimgr.closeui("gameclass.ddzhutable");h.game.uimgr.showui("gameclass.ddzhuresultui");h.game.uimgr.uis["gameclass.ddzhuresultui"].setData(h.mod_ddzhu);return}h.mod_ddzhu.gameready()};gameclass.createbtnpress(this.node,"jiesuan_btn_Ready",function(){c()});gameclass.createbtnpress(this.node,"backBtn",function(){c()});h.bg=ccui.helper.seekWidgetByName(this.node,"bg_0");ccui.helper.seekWidgetByName(this.node,"jiesuan_text_difen").setString("本局底分："+l.difen);ccui.helper.seekWidgetByName(this.node,"jiesuan_text_jushu").setString("剩余局数："+l.RoomCount);ccui.helper.seekWidgetByName(this.node,"jiesuan_text_roomnum").setString("房间号："+h.mod_ddzhu.roomnum);var g=new Date();var k=g.Format("MM/dd hh:mm");ccui.helper.seekWidgetByName(this.node,"jiesuan_text_date").setString(k.toString());var d=false;var a=false;for(var e=0;e<f.length;e++){if(f[e].dealer){d=f[e].card.length==0;a=f[e].uid==h.mod_ddzhu.uid}}if((a&&d)||(!a&&!d)){}else{h.bg.loadTexture(res.ddzLostBg,ccui.Widget.LOCAL_TEXTURE)}var b=ccui.helper.seekWidgetByName(this.node,"playerPanel").getChildren();for(var e=0;e<f.length;e++){ccui.helper.seekWidgetByName(b[e],"jiesuan_text_name").setString(f[e].name);ccui.helper.seekWidgetByName(b[e],"jiesuan_text_id").setString(f[e].uid);ccui.helper.seekWidgetByName(b[e],"jiesuan_text_score").setString(f[e].score);gameclass.mod_base.showtximg(ccui.helper.seekWidgetByName(b[e],"jiesuan_image_head"),f[e].icon,0,0,"im_headbg2");if(f[e].dealer){ccui.helper.seekWidgetByName(b[e],"jiesuan_image_dz").setTexture(res.btn_dizhu)}if(f[e].isdouble==2){ccui.helper.seekWidgetByName(b[e],"jiesuan_image_double").setTexture(res.spr_double2)}}}});gameclass.ddzhuresultui=gameclass.baseui.extend({sprite:null,node:null,round:null,roomnum:null,curtime:null,ctor:function(){this._super();this.shareing=false},show:function(){this.node=this.game.uimgr.createnode(res.ddzhuresultui,true);var c=this;this.round=ccui.helper.seekWidgetByName(this.node,"round");this.roomnum=ccui.helper.seekWidgetByName(this.node,"roomnum");this.roomId=ccui.helper.seekWidgetByName(this.node,"roomId");this.curtime=ccui.helper.seekWidgetByName(this.node,"curtime");var a=new Date();var b=a.Format("MM/dd hh:mm");this.curtime.setString("当前时间:"+b);this.addChild(this.node);var c=this;gameclass.createbtnpress(this.node,"cancelbtn",function(){c.game.uimgr.showui("gameclass.hallui");c.game.uimgr.closeui("gameclass.ddzhuresultui")});gameclass.createbtnpress(this.node,"backBtn",function(){c.game.uimgr.showui("gameclass.hallui");c.game.uimgr.closeui("gameclass.ddzhuresultui")});gameclass.createbtnpress(this.node,"okbtn",function(){gameclass.mod_platform.savescreen(function(d){if(window.wx){d=JSON.parse(d);if(d.error==0){c.share(d.url)}}})})},setData:function(l){var d=[];var a=l.endinfo.info;for(var e=0;e<l.roominfo.person.length;e++){for(var c=0;c<l.endinfo.info.length;c++){if(a[c]&&a[c].uid==l.roominfo.person[e].uid){d.push({icon:l.roominfo.person[e].imgurl,uid:l.roominfo.person[e].uid,name:l.roominfo.person[e].name,high:a[c].high,boom:a[c].boom,win:a[c].win,deal:a[c].deal,score:a[c].score});break}}}var h=[];var b=l.roominfo.step;if(b>l.roominfo.maxstep){b=l.roominfo.maxstep}this.round.setString("局数:"+b+"/"+l.roominfo.maxstep);this.roomnum.setString("房号ID:"+l.roominfo.roomid);this.roomId.setString("房主ID:"+l.bankerUid);var g=0,k=-1;for(var e=0;e<d.length;e++){if(d[e].score>g&&d[e].score>0){g=d[e].score;k=e}}for(var e=0;e<d.length;e++){var f=ccui.helper.seekWidgetByName(this.node,"player"+e);ccui.helper.seekWidgetByName(f,"name").setString(d[e].name);ccui.helper.seekWidgetByName(f,"id").setString("ID："+d[e].uid);ccui.helper.seekWidgetByName(f,"high").setString("单局最高："+d[e].high);ccui.helper.seekWidgetByName(f,"boom").setString("炸弹次数："+d[e].boom);ccui.helper.seekWidgetByName(f,"win").setString("胜利局数："+d[e].win);ccui.helper.seekWidgetByName(f,"deal").setString("地主次数："+d[e].deal);ccui.helper.seekWidgetByName(f,"score").setString(d[e].score);ccui.helper.seekWidgetByName(f,"wintag").setVisible(e==k);gameclass.mod_base.showtximg(f.getChildByName("icon"),d[e].icon||"",0,0,"im_headbg2")}}});gameclass.ddzhuresultui.prototype.share=function(a){gameclass.mod_platform.wxsharelink("斗地主结算","战绩",a)};gameclass.chatuisl=gameclass.baseui.extend({sprite:null,node:null,chat_cy:[],chat_bq:[],tb_cyy:null,tb_qb:null,mod_game:null,ctor:function(){this._super()},close:function(){var b=this;var a=ccui.helper.seekWidgetByName(b.node,"Image_1");a.stopAllActions();a.runAction(cc.sequence(cc.moveTo(0.5,-a.getContentSize().width,0),cc.callFunc(function(){b.game.uimgr.closeui("gameclass.chatuisl")})))},show:function(){var h=this;this.node=this.game.uimgr.createnode(res.chatsl,true);var a=ccui.helper.seekWidgetByName(this.node,"Image_1");a.stopAllActions();a.setAnchorPoint(0,0);a.setPosition(-a.getContentSize().width,0);a.runAction(cc.moveTo(0.5,0,0));this.chat_cy[0]=ccui.helper.seekWidgetByName(this.node,"chat_cy1");this.chat_cy[1]=ccui.helper.seekWidgetByName(this.node,"chat_cy2");this.chat_bq[0]=ccui.helper.seekWidgetByName(this.node,"chat_bq1");this.chat_bq[1]=ccui.helper.seekWidgetByName(this.node,"chat_bq2");this.tb_cyy=ccui.helper.seekWidgetByName(this.node,"cyy");this.tb_qb=ccui.helper.seekWidgetByName(this.node,"qb");this.addChild(this.node);this.showCYY();gameclass.createbtnpress(this.node,"bg",function(){h.close()});gameclass.createbtnpress(this.node,"Button_4",function(){var k=ccui.helper.seekWidgetByName(h.node,"input").getString();if(k==""){return}h.mod_game.chat(1,k);h.close()});var f=function(k,l){switch(l){case ccui.Widget.TOUCH_BEGAN:h.showCYY();break}};this.chat_cy[1].addTouchEventListener(f);var e=function(k,l){switch(l){case ccui.Widget.TOUCH_BEGAN:h.showBQ();break}};this.chat_bq[1].addTouchEventListener(e);var g=function(k,l){switch(l){case ccui.Widget.TOUCH_ENDED:h.mod_game.chat(1,g_chatstr_sl[k.getTag()-1]);h.close();break}};for(var c=1;c<=9;c++){var b=ccui.helper.seekWidgetByName(this.tb_cyy,"chat_"+c.toString());b.setTag(c);b.addTouchEventListener(g)}var e=function(k,l){switch(l){case ccui.Widget.TOUCH_ENDED:h.mod_game.chat(2,(k.getTag()-1).toString());h.close();break}};for(var c=1;c<=20;c++){var d=ccui.helper.seekWidgetByName(this.tb_qb,"b_"+c.toString());d.setTag(c);d.addTouchEventListener(e)}},setmod:function(b){var a=this;this.mod_game=b},showCYY:function(){this.chat_cy[0].setVisible(true);this.chat_cy[1].setVisible(false);this.chat_bq[0].setVisible(false);this.chat_bq[1].setVisible(true);this.tb_cyy.setVisible(true);this.tb_qb.setVisible(false)},showBQ:function(){this.chat_cy[0].setVisible(false);this.chat_cy[1].setVisible(true);this.chat_bq[0].setVisible(true);this.chat_bq[1].setVisible(false);this.tb_cyy.setVisible(false);this.tb_qb.setVisible(true)},});gameclass.btn_setLayer=gameclass.baseui.extend({uiParent:null,game:null,goldtype:0,ctor:function(b,a){this._super();this.uiParent=b;this.game=a;this.goldtype=0;this.show()},setgoldtype:function(a){this.goldtype=a;var e=ccui.helper.seekWidgetByName(this.node,"btn_jiesan");if(this.goldtype>=10000){var c=ccui.helper.seekWidgetByName(e,"sp");c.loadTexture(res.btn_quitExit);ccui.helper.seekWidgetByName(this.node,"btn_shop").setVisible(true);ccui.helper.seekWidgetByName(this.node,"btn_xiaoxi").setPositionY(205);if(this.uiParent.getTag()==1025){ccui.helper.seekWidgetByName(this.node,"btn_xiaoxi").setPositionY(250)}var d=this;cc.log(this.goldtype);if(this.goldtype>=20000&&this.goldtype<30000){var b=ccui.helper.seekWidgetByName(this.node,"btn_huanfu");gameclass.createbtnpress(this.node,"btn_huanfu",function(){d.game.uimgr.showui("gameclass.bank").setEnterance(1)});b.getChildByName("sp").loadTexture(res.btn_quqian)}}},_setModeGame:function(){},show:function(){this.node=this.game.uimgr.createnode(res.btn_layerJson,true);this.addChild(this.node);var c=ccui.helper.seekWidgetByName(this.node,"btn_exitCaidan");c.setVisible(false);var a=ccui.helper.seekWidgetByName(this.node,"btn_shop");a.setVisible(false);var b=ccui.helper.seekWidgetByName(this.uiParent,"closeinfo");this.zhankai=false;var d=this;if(this.uiParent.getTag()==1025){ccui.helper.seekWidgetByName(this.node,"mic").setPositionY(180)}gameclass.createbtnpress(this.node,"btn_bangzhu",function(){if(d.uiParent.getTag()==9876){return}if(b){b.setVisible(true)}d.btn_exitCaidan()});if(b){b.addTouchEventListener(function(e,f){if(f==ccui.Widget.TOUCH_ENDED){b.setVisible(false)}})}gameclass.createbtnpress(this.node,"btn_caidan",function(){if(d.zhankai){return}d.zhankai=true;ccui.helper.seekWidgetByName(d.node,"spIconMusic").setVisible(!mod_sound.getMusicVolume());ccui.helper.seekWidgetByName(d.node,"spIconEffect").setVisible(!mod_sound.getEffectsVolume());ccui.helper.seekWidgetByName(d.node,"btn_list").runAction(cc.sequence(cc.moveTo(0.3,cc.p(140,320)),cc.callFunc(function(){c.setVisible(true)})))});gameclass.createbtnpress(this.node,"btn_exitCaidan",function(){d.btn_exitCaidan()});gameclass.createbtnpress(d.node,"btn_yinyue",function(g){var f=mod_sound.getMusicVolume();var e=0;if(!f){e=0.5}else{e=0}ccui.helper.seekWidgetByName(d.node,"spIconMusic").setVisible(f);mod_sound.setMusicVolume(e)});gameclass.createbtnpress(d.node,"btn_yinxiao",function(g){var f=mod_sound.getEffectsVolume();var e=0;if(!f){e=0.5}else{e=0}ccui.helper.seekWidgetByName(d.node,"spIconEffect").setVisible(f);mod_sound.setEffectsVolume(e)});gameclass.createbtnpress(this.node,"btn_xiaoxi",function(){d.mod_game=gameclass.mod_platform.game.modmgr.mod_login.getfirstgame();if(!d.mod_game){return}if(d.uiParent.getTag()==30000){d.game.uimgr.showui("gameclass.chatuinys");d.game.uimgr.uis["gameclass.chatuinys"].setmod(d.mod_game);return}d.game.uimgr.showui("gameclass.chatui");d.game.uimgr.uis["gameclass.chatui"].setmod(d.mod_game)});gameclass.createbtnpress(this.node,"btn_jiesan",function(){d.mod_game=gameclass.mod_platform.game.modmgr.mod_login.getfirstgame();if(!d.mod_game){return}d.game.uimgr.showui("gameclass.msgboxui");var e="是否想要解散房间？";if(d.goldtype>=gameclass.gamegoldkwx){e="是否想要退出房间？"}d.game.uimgr.uis["gameclass.msgboxui"].setString(e,function(){d.mod_game.dissmissroom()})});gameclass.createbtnpress(this.node,"btn_safe",function(){d.mod_game=gameclass.mod_platform.game.modmgr.mod_login.getfirstgame();if(!d.mod_game){return}var f=d.mod_game.roominfo.person;var g=[];for(var e=0;e<f.length;e++){if(f[e].line){g.push(f[e])}}d.uiParent.getChildByName("safeLayer").safeBtncallFunc(g)});gameclass.createbtnpress(this.node,"btn_shop",function(){d.game.uimgr.showui("gameclass.goldShop")});this.initMicView()},btn_exitCaidan:function(){if(!this.zhankai){return}var a=this;ccui.helper.seekWidgetByName(this.node,"btn_list").runAction(cc.sequence(cc.moveTo(0.3,cc.p(-130,320)),cc.callFunc(function(){a.zhankai=false;ccui.helper.seekWidgetByName(a.node,"btn_exitCaidan").setVisible(false)})))},initMicView:function(){var f=this;var b=ccui.helper.seekWidgetByName(f.node,"mic");var e=ccui.helper.seekWidgetByName(f.node,"micLayer");e.setVisible(false);var d=sp.SkeletonAnimation.createWithJsonFile(res.voiceJson,res.voiceAtlas);d.setPosition(64,64);d.setScale(0.7);e.addChild(d);d.setAnimation(0,"animation",true);var c=mod_sound.getEffectsVolume();var a=mod_sound.getMusicVolume();b.addTouchEventListener(function(g,h){switch(h){case ccui.Widget.TOUCH_BEGAN:c=mod_sound.getEffectsVolume();a=mod_sound.getMusicVolume();mod_sound.setEffectsVolume(0);mod_sound.setMusicVolume(0);e.setVisible(true);gameclass.mod_platform.begmic();break;case ccui.Widget.TOUCH_ENDED:e.setVisible(false);gameclass.mod_platform.endmic();mod_sound.setEffectsVolume(Number(c));mod_sound.setMusicVolume(Number(a));break;case ccui.Widget.TOUCH_CANCELED:e.setVisible(false);gameclass.mod_platform.cancelmic();mod_sound.setEffectsVolume(Number(c));mod_sound.setMusicVolume(Number(a));break}})}});gameclass.checkSafeLayer=gameclass.baseui.extend({game:null,node:null,uiParent:null,EARTH_RADIUS:6378.137,WARN_DIS:100,SAFE_COLORL:null,DANGER_COLOR:null,S_UNKNOWN:null,savePeopleNum:0,ctor:function(c,a,b){this._super();this.uiParent=c;this.game=a;this.btn_safe=b;this.SAFE_COLORL=cc.color(255,255,255);this.DANGER_COLOR=cc.color(165,42,42);this.S_UNKNOWN="未知";this.show()},show:function(){this.node=this.game.uimgr.createnode(res.safeLayerJson,true);this.addChild(this.node);this.node.setVisible(false);ccui.helper.seekWidgetByName(this.node,"normal").setVisible(false);ccui.helper.seekWidgetByName(this.node,"nonormal").setVisible(false);var a=this;gameclass.createbtnpress(a.node,"btn_exitSafe",function(){a.node.setVisible(false)})},getDisOnEarth:function(f,d,e,c){var h=this.rad(d);var g=this.rad(c);var l=h-g;var k=this.rad(f)-this.rad(e);var m=2*Math.asin(Math.sqrt(Math.pow(Math.sin(l/2),2)+Math.cos(h)*Math.cos(g)*Math.pow(Math.sin(k/2),2)));m=m*this.EARTH_RADIUS;m=Math.round(m*10000)/10000;return m},rad:function(a){return a*Math.PI/180},getPeople:function(c,d){var b=[];for(var a=0;a<c.length;a++){if(c[a]!=0){if(c[a].uid==d){b.unshift(c[a])}else{b.push(c[a])}}}return b},safeCount:function(m,g){var m=this.getPeople(m,g);var h=m.length;for(var f=0;f<h;f++){var l=m[f].ip;var a=m[f].longitude;var b=m[f].latitude;m[f].disArr=new Array();m[f].ipWarn=false;m[f].disWarn=false;for(var d=0;d<h;d++){var c=m[d].ip;if(l==c&&f!=d){m[f].ipWarn=true;m[d].ipWarn=true}var e=m[d].longitude;var k=m[d].latitude;if(a&&e){if(f!=d){m[f].disArr[d]=this.getDisOnEarth(a,b,e,k);if(m[f].disArr[d]*1000<this.WARN_DIS){m[f].disWarn=true}}}}}return m},checkSafe:function(b){if(!b){return}this.mod_game=gameclass.mod_platform.game.modmgr.mod_login.getfirstgame();cc.log(this.mod_game);b=this.safeCount(b,this.game.modmgr.mod_login.logindata.uid);var a=this.baseCheckSafe(b);if(this.btn_safe){if(a){if(!this.mod_game.begin&&!this.mod_game.gamestate){this.btn_safe.setVisible(true)}else{this.btn_safe.setVisible(false)}this.btn_safe.loadTextureNormal(res.redSafe,ccui.Widget.LOCAL_TEXTURE);if(this.goldtype<10000){this.safeBtncallFunc(b)}}else{this.btn_safe.loadTextureNormal(res.blueSafe,ccui.Widget.LOCAL_TEXTURE)}}return a},baseCheckSafe:function(c){var a=c.length;if(a<=1){return false}for(var b=0;b<a;b++){if(c[b].ipWarn){return true}if(c[b].disWarn){return true}}return false},safeBtncallFunc:function(a){a=this.safeCount(a,this.game.modmgr.mod_login.logindata.uid);this.showSafeWindow(a)},showSafeWindow:function(f){this.node.setVisible(true);if(f.length>0){var b=f[0];var g=ccui.helper.seekWidgetByName(this.node,"normal");g.setVisible(true);for(var d=0;d<6;d++){var c=g.getChildByName("name"+d);var h=g.getChildByName("ip"+d);var e=g.getChildByName("disInfo"+d);var a=g.getChildByName("dis"+d);c.setVisible(d<f.length);h.setVisible(d<f.length);e.setVisible(d<f.length);a.setVisible(d<f.length);if(d>=f.length){continue}if(f[d].uid==this.game.modmgr.mod_login.logindata.uid){e.setVisible(false);a.setVisible(false)}c.setString("");h.setString("");if(f[d].ipWarn){h.setTextColor(this.DANGER_COLOR);a.setTextColor(this.DANGER_COLOR)}else{h.setTextColor(this.SAFE_COLORL);a.setTextColor(this.SAFE_COLORL)}c.setString(f[d].name);h.setString(f[d].ip);if(b.disArr.length>=d){if(b.disArr[d]>10){a.setString(b.disArr[d]+"km")}else{a.setString(b.disArr[d]*1000+"m")}}else{a.setString(this.S_UNKNOWN)}}}else{ccui.helper.seekWidgetByName(this.node,"nonormal").setVisible(true)}},});gameclass.rechargeWindow=gameclass.baseui.extend({_numSetLayer:null,_numSetCtr:null,_prevBtn:null,_nextBtn:null,_backBtn:null,_okBtn:null,_curPage:0,_pageContain:null,game:null,_receiveUid:0,_receiveNickName:"",_sendUid:0,_sendCardNum:0,_idTxt:null,_nameTxt:null,_cardNumTxt:null,ctor:function(){this._super();this._curPage=0},setGame:function(a){this.game=a;this._sendUid=this.game.modmgr.mod_login.logindata.uid},show:function(){this.node=this.game.uimgr.createnode(res.rechargeJson,true);this.addChild(this.node);this._numSetLayer=ccui.helper.seekWidgetByName(this.node,"numSetLayer");this._numSetCtr=new gameclass.numSetSimpleCtr(this._numSetLayer,false,6);this._numSetCtr.setFont(50,new cc.color(165,42,42));this._pageContain=ccui.helper.seekWidgetByName(this.node,"pageContain");this._prevBtn=ccui.helper.seekWidgetByName(this.node,"prevBtn");this._nextBtn=ccui.helper.seekWidgetByName(this.node,"nextBtn");this._backBtn=ccui.helper.seekWidgetByName(this.node,"backBtn");this._okBtn=ccui.helper.seekWidgetByName(this.node,"okBtn");this._idTxt=ccui.helper.seekWidgetByName(this.node,"idTxt");this._nameTxt=ccui.helper.seekWidgetByName(this.node,"nameTxt");this._cardNumTxt=ccui.helper.seekWidgetByName(this.node,"cardNumTxt");var a=this;gameclass.createbtnpress(this.node,"backBtn",function(){a.game.uimgr.closeui("gameclass.rechargeWindow")});gameclass.createbtnpress(this.node,"closeBtn",function(){a.game.uimgr.closeui("gameclass.rechargeWindow")});gameclass.createbtnpress(this.node,"okBtn",function(){a.okHandle()});gameclass.createbtnpress(this.node,"prevBtn",function(){a.prevHandle()});gameclass.createbtnpress(this.node,"nextBtn",function(){a.nextHandle()});this.updatePage()},updatePage:function(){var a=this._pageContain.getChildrenCount();if(this._curPage==0){this._prevBtn.setBright(false);this._prevBtn.setTouchEnabled(false);this._nextBtn.setBright(true);this._nextBtn.setTouchEnabled(true)}else{if(this._curPage==a-1){this._prevBtn.setBright(true);this._prevBtn.setTouchEnabled(true);this._nextBtn.setBright(false);this._nextBtn.setTouchEnabled(false)}else{this._prevBtn.setBright(true);this._prevBtn.setTouchEnabled(true);this._nextBtn.setBright(true);this._nextBtn.setTouchEnabled(true)}}for(var b=0;b<a;b++){var c=this._pageContain.getChildren()[b];if(b==this._curPage){c.setVisible(true)}else{c.setVisible(false)}}if(this._curPage==a-1){this._prevBtn.setVisible(false);this._nextBtn.setVisible(false);this._numSetLayer.setVisible(false)}else{this._numSetLayer.setVisible(true)}this._numSetCtr.resetNumber()},prevHandle:function(){var a=this;if(this._curPage==0){a._idTxt.setString(a._receiveUid.toString())}else{if(this._curPage==1){a._cardNumTxt.setString(this._sendCardNum.toString())}}this.prevPage()},prevPage:function(){this._curPage--;if(this._curPage<0){return}this.updatePage()},okHandle:function(){var b=this;var a={send_id:this._sendUid,rec_id:this._receiveUid,num:this._sendCardNum};this.game.modmgr.mod_login.agentPostRequest(gameclass.phpAddressPrev+gameclass.agentPostAdd,"sendCard",a,function(c){if(c&&c.code&&c.code==1){cc.log("sendcardOk:rec_id="+this._receiveUid+",recNickName="+this._receiveNickName+",cardNum="+this._sendCardNum);b.game.uimgr.showui("gameclass.msgboxui").setString("发送成功！")}else{if(c.msg!=""){b.game.uimgr.showui("gameclass.msgboxui").setString(c.msg)}else{b.game.uimgr.showui("gameclass.msgboxui").setString("发送失败，请重启游戏后重试！")}}b.game.uimgr.closeui("gameclass.rechargeWindow")})},nextHandle:function(){var b=this;if(this._curPage==0){b._receiveUid=this._numSetCtr.getNumber();b._idTxt.setString(b._receiveUid.toString());if(b._receiveUid==0){b.game.uimgr.showui("gameclass.msgboxui").setString("需要输入用户ID!");return}var a={uid:b._receiveUid};this.game.modmgr.mod_login.agentPostRequest(gameclass.phpAddressPrev+gameclass.agentPostAdd,"getNickName",a,function(c){if(c&&c.nickname&&c.nickname!=""){cc.log("uid="+a.uid+",getNickName="+c.nickname);b._receiveNickName=c.nickname;b._nameTxt.setString(b._receiveNickName.toString());b.nextPage()}else{b.game.uimgr.showui("gameclass.msgboxui").setString("找不到该用户!");return}})}else{if(this._curPage==1){var a={uid:this._sendUid};b._sendCardNum=this._numSetCtr.getNumber();b._cardNumTxt.setString(this._sendCardNum.toString());if(b._sendCardNum==0){b.game.uimgr.showui("gameclass.msgboxui").setString("需要输入房卡数量!");return}this.game.modmgr.mod_login.agentPostRequest(gameclass.phpAddressPrev+gameclass.agentPostAdd,"getCard",a,function(c){if(c){cc.log("uid="+a.uid+",totalCardNum="+c.card);if(c.card<b._sendCardNum){b.game.uimgr.showui("gameclass.msgboxui").setString("房卡不足!")}else{b.nextPage()}cc.log("uid="+a.uid+",getCard="+c.card)}})}}},nextPage:function(){var a=this._pageContain.getChildrenCount();this._curPage++;if(this._curPage>=a){return}this.updatePage()},});gameclass.rechargeHistory=gameclass.baseui.extend({_listView:null,_itemStyle:null,_sendUid:0,ctor:function(){this._super();this._curPage=0},setGame:function(b){this.game=b;this._sendUid=this.game.modmgr.mod_login.logindata.uid;var c=this;var a={uid:c._sendUid};this.game.modmgr.mod_login.agentPostRequest(gameclass.phpAddressPrev+gameclass.agentPostAdd,"getSendCardLog",a,function(d){if(d){c.updateList(d)}else{return}})},show:function(){this.node=this.game.uimgr.createnode(res.rechargeHisJson,true);this.addChild(this.node);this._listView=ccui.helper.seekWidgetByName(this.node,"listView");this._itemStyle=this._listView.getChildren()[0];var a=this;gameclass.createbtnpress(this.node,"backBtn",function(){a.game.uimgr.closeui("gameclass.rechargeHistory")});gameclass.createbtnpress(this.node,"closeBtn",function(){a.game.uimgr.closeui("gameclass.rechargeHistory")});this._listView.removeAllChildren()},updateList:function(b){if(b==null){return}this._listView.removeAllChildren();var a=b.length;for(var d=0;d<a;d++){var f=new ccui.Layout();var c=this.game.uimgr.createnode(res.rechargeHisItemJson);f.addChild(c);f.setContentSize(c.getContentSize());var g=b[d];ccui.helper.seekWidgetByName(c,"timeTxt").setString(g.time);ccui.helper.seekWidgetByName(c,"idTxt").setString(g.uid);ccui.helper.seekWidgetByName(c,"nameTxt").setString(g.nickname);ccui.helper.seekWidgetByName(c,"cardNumTxt").setString(g.card);var e=ccui.helper.seekWidgetByName(c,"stateTxt");if(g.status==2){e.setString("成功")}else{if(g.status==-1){e.setString("失败")}else{if(g.status==-2){e.setString("未到账")}else{e.setString(g.code.toString())}}}this._listView.addChild(f)}},});gameclass.hlgc=gameclass.hlgc||{};gameclass.hlgc.cheatPrevPlay=gameclass.baseui.extend({_allContain:null,_selectContain:null,_selectCardArr:[],mod_hlgc:null,_selectMaxNum:-1,ctor:function(){this._super();this._selectCardArr=[];this._selectMaxNum=13},setmod:function(a){this.mod_hlgc=a},show:function(){this.node=this.game.uimgr.createnode(res.hlgcCheatJson,true);this.addChild(this.node);this._allContain=ccui.helper.seekWidgetByName(this.node,"allContain");this._selectContain=ccui.helper.seekWidgetByName(this.node,"selectContain");var a=this;gameclass.createbtnpress(this.node,"okBtn",function(){a.okHandle()});this.createAllCard()},createAllCard:function(){var b=[];for(var d=1;d<=37;d++){if(d!=10&&d!=20&&d!=30){b.push(d)}}for(var d=0;d<b.length;d++){var c=b[d];var a=this.createCard(this._allContain,c,0.7,9,0,20);a.addTouchEventListener(this.selectCard,this)}},createCard:function(h,c,e,b,l,k){var f=h.getChildrenCount();var g=new ccui.Layout();var a=gameclass.hlgc.Table.CreateCard(c,2,2,0);a.setScale(e);var d=a.getContentSize().width*a.getScale();var m=a.getContentSize().height*a.getScale();g.addChild(a);a.setAnchorPoint(0,0);g.setPositionX((f%b)*(d+l));g.setPositionY(parseInt(f/b)*(m+k));g.setContentSize(cc.size(d,m));g.card=c;g.setTouchEnabled(true);h.addChild(g);return g},selectCard:function(c,d){if(d!=ccui.Widget.TOUCH_ENDED){return}if(this._selectCardArr.length>=this._selectMaxNum){return}var b=staticFunction.numCheck(this._selectCardArr,c.card);if(b>=4){return}var a=this.createCard(this._selectContain,c.card,0.75,9,0,0);a.addTouchEventListener(this.delCard,this);this.resortSelect();this._selectCardArr.push(c.card)},delCard:function(b,c){if(c!=ccui.Widget.TOUCH_ENDED){return}var a=this._selectCardArr.indexOf(b.card);if(a<0){return}this._selectCardArr.splice(a,1);b.removeFromParent();this.resortSelect()},resortSelect:function(){for(var a=0;a<this._selectContain.getChildrenCount();a++){var b=this._selectContain.getChildren()[a];b.setPositionX(a*(b.getContentSize().width+0));this._selectContain.setContentSize(cc.size(b.getPositionX()+b.getContentSize().width,b.getContentSize().height))}},okHandle:function(){if(this._selectCardArr.length!=this._selectMaxNum){this.closeSelf()}else{this.sendCheat();this.closeSelf()}},sendCheat:function(){this.mod_hlgc.sendCheat(this._selectCardArr)},closeSelf:function(){this.game.uimgr.closeui("gameclass.hlgc.cheatPrevPlay")},});gameclass.hlgc.cheatPlayMo=gameclass.hlgc.cheatPrevPlay.extend({ctor:function(){this._super();this._selectMaxNum=1},setmod:function(a){this._super(a);this.mod_hlgc.onSendmygod()},updateAllCard:function(g){var b=[];for(var f=1;f<=37;f++){if(f!=10&&f!=20&&f!=30){b.push(f)}}var c=staticFunction.getArrayNumObj(g);for(var f=0;f<b.length;f++){var d=b[f];var a=staticFunction.getCardNumFromObj(c,d);if(a==0){c[d]=0}}for(var l in c){var d=l;var h=this.createCard(this._allContain,d,0.7,9,0,20);var k=h.getChildren()[0];var e=k.getContentSize().width*k.getScale();h.addTouchEventListener(this.selectCard,this)}},createAllCard:function(){},selectCard:function(b,c){if(c!=ccui.Widget.TOUCH_ENDED){return}if(this._selectCardArr.length==1&&this._selectCardArr[0]==b.card){return}this._selectContain.removeAllChildren();var a=this.createCard(this._selectContain,b.card,0.75,9,0,0);a.addTouchEventListener(this.delCard,this);this._selectCardArr=[];this._selectCardArr.push(b.card)},sendCheat:function(){if(this._selectCardArr.length!=1){return}this.mod_hlgc.onSendgetmygod(this._selectCardArr[0])},closeSelf:function(){this.game.uimgr.closeui("gameclass.hlgc.cheatPlayMo")},});gameclass.advertiseView=gameclass.baseui.extend({ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.advertiseJson,true);this.addChild(this.node);this.picContain=ccui.helper.seekWidgetByName(this.node,"picContain");var a=this;gameclass.createbtnpress(this.node,"closeBtn",function(){a.game.uimgr.closeui("gameclass.advertiseView")})},updateView:function(a){this.picContain.removeAllChildren();staticFunction.loadNetIcon(this.picContain,gameclass.phpAddressPrev+a.img_url)},});gameclass.piaofen=cc.Node.extend({ctor:function(b){this._super();var a=null;var c=null;if(b>0){a=ccs.load(res.yishuLabel);c=new cc.Sprite(res.jiaLogo)}else{b=-b;a=ccs.load(res.lostGold);c=new cc.Sprite(res.jianLogo)}this.node=a.node;this.addChild(this.node);var d=this.node.getChildByName("text");d.setString(b);d.ignoreContentAdaptWithSize(true);d.runAction(cc.fadeTo(1,200));c.setPositionX(-(d.getContentSize().width/2+c.getContentSize().width/2));this.addChild(c)},});gameclass.shopView=gameclass.baseui.extend({sprite:null,node:null,_horNum:4,_horDis:20,_verDis:0,_itemW:206,_itemH:277,_indexNum:8,_isRun:false,_targetRotation:0,tableArr:[{name:"充值",normalImg:"res/ui/qhqp/15-recharge/qh_txt_cz2@2x.png",selectImg:"res/ui/qhqp/15-recharge/qh_txt_cz1@2x.png",datas:[{name:"6钻石",btnTxt:"¥6.00",icon:""},{name:"18钻石",btnTxt:"¥18.00",icon:""},{name:"30钻石",btnTxt:"¥30.00",icon:""},{name:"68钻石",btnTxt:"¥68.00",icon:""},{name:"128钻石",btnTxt:"¥128.00",icon:""},{name:"328钻石",btnTxt:"¥328.00",icon:""},]},{name:"转盘抽奖",normalImg:"res/ui/qhqp/15-recharge/qh_txt_zpcj2@2x.png",selectImg:"res/ui/qhqp/15-recharge/qh_txt_zpcj1@2x.png",},{name:"实物兑换",normalImg:"res/ui/qhqp/15-recharge/qh_txt_swdh2@2x.png",selectImg:"res/ui/qhqp/15-recharge/qh_txt_swdh1@2x.png",datas:[{name:"xx话费",btnTxt:"xx积分",icon:"res/ui/qhqp/17-exchange/icon_huafei@2x.png"},{name:"移动电源",btnTxt:"xx积分",icon:"res/ui/qhqp/17-exchange/icon_dianyuan@2x.png"},{name:"大米",btnTxt:"xx积分",icon:"res/ui/qhqp/17-exchange/icon_dami@2x.png"},{name:"油",btnTxt:"xx积分",icon:"res/ui/qhqp/17-exchange/icon_you@2x.png"},{name:"抽奖1次",btnTxt:"xx积分",icon:"res/ui/qhqp/17-exchange/icon_choujiang@2x.png"},]},],ctor:function(){this._super();this._address=gameclass.mod_platform.getAddress();this._singleRotate=360/this._indexNum},show:function(){this.node=this.game.uimgr.createnode(res.shopLayerJson,true);this.addChild(this.node);this._male=ccui.helper.seekWidgetByName(this.node,"male");this._famale=ccui.helper.seekWidgetByName(this.node,"famale");this._rightContain=ccui.helper.seekWidgetByName(this.node,"rightContain");this.listView=ccui.helper.seekWidgetByName(this.node,"listView");this.btnStyle=this.listView.getChildByName("btnStyle");this.circle=ccui.helper.seekWidgetByName(this.node,"circle");this._male.setVisible(false);var g=this;gameclass.createbtnpress(this.node,"buyroomcard",function(){g.game.uimgr.showui("gameclass.buycardui")});var k=ccui.helper.seekWidgetByName(this.node,"headback");k.setTouchEnabled(true);gameclass.mod_base.showtximg(k,this.game.modmgr.mod_login.logindata.imgurl,0,0,"im_headbg2");var a=ccui.helper.seekWidgetByName(this.node,"name");var b=ccui.helper.seekWidgetByName(this.node,"id");var d=ccui.helper.seekWidgetByName(this.node,"money");a.setString(this.game.modmgr.mod_login.logindata.name);b.setString(this.game.modmgr.mod_login.logindata.uid.toString());d.setString(this.game.modmgr.mod_login.logindata.card.toString());if(this.game.modmgr.mod_login.logindata.sex==0){this._male.setVisible(false);this._famale.setVisible(true)}else{this._male.setVisible(true);this._famale.setVisible(false)}gameclass.createbtnpress(this.node,"headback",function(){var l=g.game.uimgr.showui("gameclass.UserInfoView");l.updateView(g.game.modmgr.mod_login.logindata.imgurl,g.game.modmgr.mod_login.logindata.name,"ID："+g.game.modmgr.mod_login.logindata.uid,"IP："+g.game.modmgr.mod_login.logindata.ip,"地址："+g._address)});gameclass.createbtnpress(this.node,"closeBtn",function(){g.game.uimgr.closeui("gameclass.shopView")});gameclass.createbtnpress(this.node,"drawBtn",function(){g.drawHandle()});this.btnGroupCtr=new gameclass.buttonGroupControl(this.tabClickHandle.bind(this));this.listView.removeAllChildren();var h=[];for(var f=0;f<this.tableArr.length;f++){var c=this.btnStyle.clone();var e=staticFunction.addTabBtn(c,this.tableArr[f].normalImg,this.tableArr[f].selectImg);this.listView.addChild(c);h.push(new gameclass.baseButtonControl(c,["normal"],["select"]))}this.btnGroupCtr.initData(h);this.btnGroupCtr.setSelectIndex(0);this.tabClickHandle();this.updateRight();this.scheduleUpdate()},updateRight:function(){for(var b=0;b<this.tableArr.length;b++){var a=this.tableArr[b].datas;var d=this._rightContain.getChildren()[b];if(b==0||b==2){var c=ccui.helper.seekWidgetByName(d,"list");this.updateContent(c,a)}}},tabClickHandle:function(){for(var a=0;a<this._rightContain.getChildrenCount();a++){var b=this._rightContain.getChildren()[a];if(a==this.btnGroupCtr._selectIndex){b.setVisible(true)}else{b.setVisible(false)}}},updateContent:function(c,b){c.removeAllChildren();var a=b.length;var g;for(var d=0;d<a;d++){if(d%this._horNum==0){g=new ccui.Layout();g.setContentSize(cc.size(this._itemW,this._itemH))}var f=this.game.uimgr.createnode(res.shopLayerItemJson,true);this.setItem(f,b[d]);var e=new ccui.Layout();e.setContentSize(cc.size(this._itemW,this._itemH));e.addChild(f);e.setTouchEnabled(true);e.addTouchEventListener(this.itemClickHandle,this);g.addChild(e);if(g.getChildrenCount()>1){e.setPositionX((g.getChildrenCount()-1)*(this._itemW+this._horDis))}if(g.getChildrenCount()==this._horNum){c.addChild(g)}else{if(d==a-1){c.addChild(g)}}}c.refreshView()},setItem:function(c,d){ccui.helper.seekWidgetByName(c,"nameTxt").setString(d.name);var a=ccui.helper.seekWidgetByName(c,"btn");a.setTitleText(d.btnTxt);if(d.icon){var b=ccui.helper.seekWidgetByName(c,"icon");b.setTexture(d.icon)}},itemClickHandle:function(a,b){if(b!=ccui.Widget.TOUCH_ENDED){return}cc.log(1)},drawHandle:function(){if(this._isRun){return}this._isRun=true;var a=parseInt(Math.random()*this._indexNum);this._targetRotation=this._singleRotate*a;cc.log("randomIndex="+a+",targetRotation="+this._targetRotation);this._targetRotation=this._targetRotation+360*15;var b=this;var c=cc.rotateTo(6,this._targetRotation,this._targetRotation).easing(cc.easeInOut(2));this.circle.runAction(cc.sequence(c,cc.callFunc(function(){b._isRun=false;b.setRotation(this._targetRotation%360)})))},update:function(a){}});gameclass.couponLayer=gameclass.baseui.extend({sprite:null,node:null,isInvite:false,inviteInfo:null,ctor:function(){this._super()},show:function(){this.node=this.game.uimgr.createnode(res.couponLayer,true,1);this.addChild(this.node);var c=this;gameclass.createbtnpress(this.node,"backBtn",function(){c.game.uimgr.closeui("gameclass.couponLayer")});var b=ccui.helper.seekWidgetByName(this.node,"Button_ok");this.isInvite=this.game.modmgr.mod_login.inviteData.isinvite;this.inviteInfo=this.game.modmgr.mod_login.inviteData.invite;if(this.isInvite){var a=ccui.helper.seekWidgetByName(this.node,"TextField_1");a.setString("你已经使用过邀请码");a.setTouchEnabled(false);b.setEnabled(false);b.setBright(false);c.game.uimgr.showui("gameclass.msgboxui");c.game.uimgr.uis["gameclass.msgboxui"].setString("您的账号已在其他地方登陆")}gameclass.createbtnpress(this.node,"Button_ok",function(){var f=this;if(this.isInvite){f.game.uimgr.showui("gameclass.msgboxui");f.game.uimgr.uis["gameclass.msgboxui"].setString("您的账号已在其他地方登陆");return}var d=ccui.helper.seekWidgetByName(f.node,"TextField_1");var e=d.getString();f.game.modmgr.mod_center.sendInviteCode(e)})},});